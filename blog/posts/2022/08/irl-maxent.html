<!DOCTYPE html><!--lQeDQUt8Hspk_e6naCYvs--><html lang="en" class="scroll-pt-[4rem] lg:scroll-pt-[5rem]"><head><meta charSet="utf-8"/><link rel="preconnect" href="/" crossorigin=""/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/assets/blog/20220825-irl-maxent/maxent-principle.png"/><link rel="stylesheet" href="/_next/static/chunks/c6b416b01c5580dd.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/chunks/237a07649595a9a2.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/c8f256f3ce8bcb9b.js"/><script src="/_next/static/chunks/f091501564eb2ea3.js" async=""></script><script src="/_next/static/chunks/ad4cf95c856c591c.js" async=""></script><script src="/_next/static/chunks/85f13d511fdacc27.js" async=""></script><script src="/_next/static/chunks/turbopack-10d2fda211379073.js" async=""></script><script src="/_next/static/chunks/dc82041b01df271f.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/d2be314c3ece3fbe.js" async=""></script><script src="/_next/static/chunks/3b33f78cf07ae5fc.js" async=""></script><link rel="preload" href="/_next/static/chunks/95e292524e62acff.js" as="script" fetchPriority="low"/><link rel="preload" href="/_next/static/chunks/385e5676cca23f9e.js" as="script" fetchPriority="low"/><link rel="preload" href="/_next/static/chunks/56d74432e137d314.js" as="script" fetchPriority="low"/><title>Maximilian Luz | Maximum Entropy Inverse Reinforcement Learning</title><meta name="description" content="Maximum Entropy Inverse Reinforcement Learning - A blog post by Maximilian Luz"/><link rel="shortcut icon" href="/assets/icons/dark/favicon.png"/><link rel="shortcut icon" href="/assets/icons/dark/favicon.png" media="(prefers-color-scheme: light)"/><link rel="shortcut icon" href="/assets/icons/light/favicon.png" media="(prefers-color-scheme: dark)"/><link rel="icon" href="/assets/icons/dark/favicon.svg"/><link rel="icon" href="/assets/icons/dark/favicon.svg" media="(prefers-color-scheme: light)"/><link rel="icon" href="/assets/icons/light/favicon.svg" media="(prefers-color-scheme: dark)"/><link rel="apple-touch-icon" href="/assets/icons/dark/apple-touch-icon.png"/><link rel="apple-touch-icon" href="/assets/icons/dark/apple-touch-icon.png" media="(prefers-color-scheme: light)"/><link rel="apple-touch-icon" href="/assets/icons/light/apple-touch-icon.png" media="(prefers-color-scheme: dark)"/><link rel="mask-icon" href="/assets/icons/black/favicon.png" color="#06060b"/><link rel="mask-icon" href="/assets/icons/black/favicon.png" media="(prefers-color-scheme: light)" color="#06060b"/><link rel="mask-icon" href="/assets/icons/black/favicon.png" media="(prefers-color-scheme: dark)" color="#ffffff"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class=" relative min-h-dvh bg-slate-100 dark:bg-slate-900 text-slate-800 dark:text-slate-300 "><div hidden=""><!--$--><!--/$--></div><div class="
        fixed inset-0 w-full h-full
        sm:hidden
        hidden
        backdrop-blur-[0.5px]
        before:content-[&#x27;&#x27;]
        before:absolute before:top-0 before:left-0 before:inset-0
        before:sm:hidden
        before:opacity-25 before:bg-black dark:before:bg-black
        before:z-[-1]
      "></div><div class="
        fixed inset-0 h-full top-12 lg:top-14
        left-auto z-30
        -right-52
        transition-all
        duration-300
      "><div class=" w-52 h-full border-l border-slate-200 dark:border-slate-800 backdrop-blur-lg before:content-[&#x27;&#x27;] before:absolute before:top-0 before:left-0 before:inset-0 before:opacity-75 before:bg-slate-100 dark:before:bg-slate-900 before:z-[-1] "><div class="h-full overflow-y-auto  py-8 px-4"><nav><ul class="flex flex-col gap-2 m-0 p-0"><li class="m-0 p-0 list-none"><a class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-800 hover:text-slate-900 dark:text-slate-200 dark:hover:text-slate-100 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-250" href="/"><svg viewBox="0 -960 960 960" fill="currentColor" class="w-4 h-4"><path d="M240-200h120v-200q0-17 11.5-28.5T400-440h160q17 0 28.5 11.5T600-400v200h120v-360L480-740 240-560v360Zm-80 0v-360q0-19 8.5-36t23.5-28l240-180q21-16 48-16t48 16l240 180q15 11 23.5 28t8.5 36v360q0 33-23.5 56.5T720-120H560q-17 0-28.5-11.5T520-160v-200h-80v200q0 17-11.5 28.5T400-120H240q-33 0-56.5-23.5T160-200Zm320-270Z"></path></svg>Home</a></li><li class="m-0 p-0 list-none"><a class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-800 hover:text-slate-900 dark:text-slate-200 dark:hover:text-slate-100 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-250" href="/blog"><svg viewBox="0 -960 960 960" fill="currentColor" class="w-4 h-4"><path d="M560-120v-66q0-8 3-15.5t9-13.5l209-208q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q8 9 12.5 20t4.5 22q0 11-4 22.5T903-300L695-92q-6 6-13.5 9T666-80h-66q-17 0-28.5-11.5T560-120Zm300-223-37-37 37 37ZM620-140h38l121-122-18-19-19-18-122 121v38ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h287q16 0 30.5 6t25.5 17l194 194q11 11 17 25.5t6 30.5v87h-80v-80H560q-17 0-28.5-11.5T520-640v-160H240v640h240v80H240Zm0-80v-640 640Zm521-121-19-18 37 37-18-19Z"></path></svg>Blog</a></li><li class="m-0 p-0 list-none"><a class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-800 hover:text-slate-900 dark:text-slate-200 dark:hover:text-slate-100 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-250" href="/publications"><svg viewBox="0 -960 960 960" fill="currentColor" class="w-4 h-4"><path d="M440-400h80q17 0 28.5-11.5T560-440q0-17-11.5-28.5T520-480h-80q-17 0-28.5 11.5T400-440q0 17 11.5 28.5T440-400Zm0-120h240q17 0 28.5-11.5T720-560q0-17-11.5-28.5T680-600H440q-17 0-28.5 11.5T400-560q0 17 11.5 28.5T440-520Zm0-120h240q17 0 28.5-11.5T720-680q0-17-11.5-28.5T680-720H440q-17 0-28.5 11.5T400-680q0 17 11.5 28.5T440-640ZM320-240q-33 0-56.5-23.5T240-320v-480q0-33 23.5-56.5T320-880h480q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H320Zm0-80h480v-480H320v480ZM160-80q-33 0-56.5-23.5T80-160v-520q0-17 11.5-28.5T120-720q17 0 28.5 11.5T160-680v520h520q17 0 28.5 11.5T720-120q0 17-11.5 28.5T680-80H160Zm160-720v480-480Z"></path></svg>Publications</a></li></ul><hr class="my-4 border-t border-slate-200 dark:border-slate-800"/><ul class="flex flex-col gap-2 m-0 p-0"><li class="m-0 p-0 list-none"><a class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-200 " href="https://github.com/qzed"><svg viewBox="-0.5 -0.5 17 17" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" d="M8 0C3.58 0 0 3.582 0 8c0 3.535 2.292 6.533 5.47 7.59.4.075.547-.172.547-.385 0-.19-.007-.693-.01-1.36-2.226.483-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.725-.496.056-.486.056-.486.803.056 1.225.824 1.225.824.714 1.223 1.873.87 2.33.665.072-.517.278-.87.507-1.07-1.777-.2-3.644-.888-3.644-3.953 0-.873.31-1.587.823-2.147-.09-.202-.36-1.015.07-2.117 0 0 .67-.215 2.2.82.64-.178 1.32-.266 2-.27.68.004 1.36.092 2 .27 1.52-1.035 2.19-.82 2.19-.82.43 1.102.16 1.915.08 2.117.51.56.82 1.274.82 2.147 0 3.073-1.87 3.75-3.65 3.947.28.24.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.14.46.55.38C13.71 14.53 16 11.53 16 8c0-4.418-3.582-8-8-8"></path></svg>GitHub</a></li><li class="m-0 p-0 list-none"><a class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-200 " href="https://scholar.google.com/citations?user=6AO18q8AAAAJ"><svg viewBox="72 80 368 376" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" d="M213 111l-107 94h69c5 45 41 64 78 67-7 18-4 27 7 39-43 1-103 26-103 67 4 45 63 54 92 54 38 1 81-19 90-54 4-35-10-54-31-71-23-18-28-28-21-40 15-17 35-27 39-51 2-17-2-28-6-43l45-38-1 16c-3 2-5 6-5 9v103c2 13 22 11 23 0V160c0-3-2-7-5-8v-25l16-16zm58 141c-61 10-87-87-38-99 56-11 83 86 38 99zm-5 73c60 13 61 63 10 78-44 9-82-4-81-30 0-25 35-48 71-48z"></path></svg>Scholar</a></li><li class="m-0 p-0 list-none"><a class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-200 " href="https://twitter.com/mxnluz"><svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" clip-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>Twitter</a></li><li class="m-0 p-0 list-none"><a class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-200 " href="https://www.linkedin.com/in/mxnluz"><svg viewBox="-1.5 -1.5 19 19" fill="currentColor" class="w-4 h-4"><path fill-rule="nonzero" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51v1.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z"></path></svg>LinkedIn</a></li><li class="m-0 p-0 list-none"><a class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-200 " href="https://rl.uni-freiburg.de/people/luz"><svg viewBox="0 -960 960 960" fill="currentColor" class="w-4 h-4"><path d="M480-120 200-272v-240L40-600l440-240 440 240v320h-80v-276l-80 44v240L480-120Zm0-332 274-148-274-148-274 148 274 148Zm0 241 200-108v-151L480-360 280-470v151l200 108Zm0-241Zm0 90Zm0 0Z"></path></svg>Lab Website</a></li><li class="m-0 p-0 list-none"><a href="" id="_R_dmbb_" class=" w-full px-3 py-1 gap-3 rounded-full inline-flex items-center text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300 border border-transparent hover:border-slate-300 dark:hover:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-800 hover:drop-shadow-sm transition-colors duration-200 "><svg viewBox="0 -960 960 960" fill="currentColor" class="w-4 h-4"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm640-480L501-453q-5 3-10.5 4.5T480-447q-5 0-10.5-1.5T459-453L160-640v400h640v-400ZM480-520l320-200H160l320 200ZM160-640v10-59 1-32 32-.5 58.5-10 400-400Z"></path></svg>E-Mail</a></li></ul></nav><div class="h-8"></div></div></div></div><header class=" fixed top-0 w-full h-12 lg:h-14 z-40 flex-none border-b border-slate-200 dark:border-slate-800 "><div class=" absolute top-0 left-0 inset-0 backdrop-blur-lg  before:content-[&quot;&quot;] before:absolute before:top-0 before:left-0 before:inset-0 before:opacity-75 before:bg-slate-100 dark:before:bg-slate-900 before:z-[-1] "><div class=" flex items-center px-8 max-w-screen-xl mx-auto h-full text-slate-900 dark:text-slate-100 "><a class="mr-auto" href="/"><div class=" flex items-center gap-2 lg:gap-3 select-none whitespace-nowrap text-sky-800 dark:text-sky-100 "><svg viewBox="0 16 128 96" fill="currentColor" class="h-5 lg:h-6"><path d="M46.3683 21.0665L56.2987 42.3623L25.8608 107.636H6L46.3683 21.0665Z"></path><path d="M78.7081 107.636H122.866L114.472 89.6365H87.1016L78.7081 107.636Z"></path><path d="M92.2987 42.3623L82.3683 21.0665L42 107.636H61.8608L92.2987 42.3623Z"></path></svg><span class="text-xl lg:text-2xl font-medium">Maximilian Luz</span></div></a><nav class="h-full font-medium text-base lg:text-[1.025rem] hidden sm:inline-block"><ul class="flex items-center gap-5 h-full"><li class="h-full"><a class=" relative h-full flex items-center hover:text-sky-700 hover:dark:text-sky-500 before:content-[&quot;&quot;] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-transparent hover:before:border-slate-200 dark:hover:before:border-slate-800 transition-color before:transition-color duration-250 before:duration-250" href="/">Home</a></li><li class="h-full"><a class=" relative h-full flex items-center hover:text-sky-700 hover:dark:text-sky-500 before:content-[&quot;&quot;] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-transparent hover:before:border-slate-200 dark:hover:before:border-slate-800 transition-color before:transition-color duration-250 before:duration-250" href="/blog">Blog</a></li><li class="h-full"><a class=" relative h-full flex items-center hover:text-sky-700 hover:dark:text-sky-500 before:content-[&quot;&quot;] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-transparent hover:before:border-slate-200 dark:hover:before:border-slate-800 transition-color before:transition-color duration-250 before:duration-250" href="/publications">Publications</a></li></ul></nav><div class="absolute right-8 sm:hidden flex items-center"><button><svg viewBox="0 -960 960 960" fill="currentColor" class="h-6 hover:text-sky-700 dark:hover:text-sky-500"><path d="M160-240q-17 0-28.5-11.5T120-280q0-17 11.5-28.5T160-320h640q17 0 28.5 11.5T840-280q0 17-11.5 28.5T800-240H160Zm0-200q-17 0-28.5-11.5T120-480q0-17 11.5-28.5T160-520h640q17 0 28.5 11.5T840-480q0 17-11.5 28.5T800-440H160Zm0-200q-17 0-28.5-11.5T120-680q0-17 11.5-28.5T160-720h640q17 0 28.5 11.5T840-680q0 17-11.5 28.5T800-640H160Z"></path></svg></button></div></div></div></header><div class="pt-12 lg:pt-14 pb-14 min-h-dvh"><main><div class="py-8 sm:py-12 lg:py-16 px-8"><article class="mx-auto max-w-prose"><div class="mb-10"><p class="text-gray-500 dark:text-gray-500">August 25, 2022</p><div class="mt-2 sm:mt-3 mb-5 sm:mb-6"><h1 class="text-4xl sm:text-5xl font-bold">Maximum Entropy Inverse Reinforcement Learning</h1></div><div class="flex flex-wrap items-center gap-1"><p class=" px-1 py-0.5 rounded text-sm font-light whitespace-nowrap bg-slate-300 text-slate-900 dark:bg-slate-800 dark:text-slate-100 ">#<!-- -->machine-learning</p><p class=" px-1 py-0.5 rounded text-sm font-light whitespace-nowrap bg-slate-300 text-slate-900 dark:bg-slate-800 dark:text-slate-100 ">#<!-- -->reinforcement-learning</p><p class=" px-1 py-0.5 rounded text-sm font-light whitespace-nowrap bg-slate-300 text-slate-900 dark:bg-slate-800 dark:text-slate-100 ">#<!-- -->inverse-reinforcement-learning</p></div></div><div class=" mdprose max-w-none prose-slate dark:prose-invert prose-sm sm:prose-base  text-pretty text-optimize-legibility break-words hyphens-auto subpixel-antialiased  prose-img:rounded prose-img:border prose-img:border-slate-200 dark:prose-img:border-slate-800  prose-table:rounded prose-table:bg-slate-200 dark:prose-table:bg-slate-800  prose-th:px-3 prose-td:px-3 prose-th:py-2 prose-td:py-2  prose-thead:border-b prose-thead:border-slate-400 dark:prose-thead:border-slate-500 prose-td:border-b prose-td:border-slate-300 dark:prose-td:border-slate-700 [&amp;&gt;*]:last:prose-tr:border-none  first:prose-th:pl-5 first:prose-td:pl-5 last:prose-th:pr-5 last:prose-td:pr-5  prose-code:font-normal "><div class="
        p-4 my-4
        rounded border-l-4 border-amber-500 dark:border-amber-500
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Disclaimer:</strong> This post is an adapted version of the theoretical part of a Jupyter Notebook that I wrote in 2019 for a seminar on Imitation Learning.
You can find it, an accompanying presentation, and a small framework at <a href="https://github.com/qzed/irl-maxent">github.com/qzed/irl-maxent</a>.</p><p>I highly encourage you to have a look at that notebook in case you&#x27;re interested in the code behind this theory.</p></div>
<h2 id="context-and-motivation"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#context-and-motivation">Context and Motivation</a></h2>
<p>Let us start with some context and a brief overview of the problem we&#x27;re trying to solve:
<em>Reinforcement learning (RL)</em> aims to provide a framework for finding the optimal behavior (i.e., an optimal policy) of intelligent agents regarding some environment they interact with by directing them via a reward signal, measuring their performance.
In <em>inverse reinforcement learning (IRL)</em>, somewhat conversely, we try to recover the reward function (and therefore policy) of an agent given a set of demonstrations performed by that agent.
At first, this may seem to stand somewhat opposed to the larger goal of creating intelligent agents, however, we can use the demonstration of experts ― often humans ― to improve our agents by guiding them to a better solution.</p>
<p>An important aspect of IRL is the recovery of the expert&#x27;s reward function, which in many classical reinforcement-learning scenarios is often hand-designed.
This also sets it apart from <em>behavioral cloning (BC)</em>, another category of methods under the larger <em>imitation learning (IL)</em> umbrella <span class="csl-ref" id="citation--osaalgorithmicperspectiveimitation2018--1">[<a href="#bib-osaalgorithmicperspectiveimitation2018">see Osa et al. 2018</a>]</span>, which focuses on retrieving the expert&#x27;s policy instead of the reward.
The general idea is that by analyzing the actions taken by an expert, we can infer a better reward function than we could manually design.</p>
<p>Maximum entropy (MaxEnt) inverse reinforcement learning <span class="csl-ref" id="citation--ziebartmaximumentropyinverse2008--2">[<a href="#bib-ziebartmaximumentropyinverse2008">Ziebart et al. 2008</a>]</span> is a powerful and clever, yet fairly simple way to achieve this.
Having discussed the “why”, let us now get to the “how”:</p>
<h2 id="a-more-mathematical-introduction"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#a-more-mathematical-introduction">A More Mathematical Introduction</a></h2>
<p>While I assume some familiarity with the basics of reinforcement and inverse reinforcement learning, here&#x27;s a short overview:
In both settings, we describe our world using a Markov decision process (MDP).
An MDP is a 5-tuple <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>R</mi><mo separator="true">,</mo><mi>γ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, A, T, R, \gamma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mclose">)</span></span></span></span> with states <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span>, actions <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span>, transition model <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(s_t, a_t, s_{t+1}) = p(s_{t+1} \mid s_t, a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, reward function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>∈</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">R(s_t, a_t, s_{t+1}) \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord mathbb">R</span></span></span></span>, and reward discount factor <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\gamma \in [0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>, decreasing the reward over time (where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">a_t \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∈</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">s_t, s_{t+1} \in S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7474em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span>).
In the inverse reinforcement learning setting, we will only use per-state rewards <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>∈</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">R(s) \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord mathbb">R</span></span></span></span>.
The key part of an MDP is that any action relies solely on the current state, meaning complete independence of all preceding history.</p>
<p>The goal of reinforcement learning then is to find an optimal sequence of actions, i.e., a policy describing the optimal action per state, for an autonomous agent given a reward signal <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span>.
The reward signal provides feedback to the agent, affirming its behavior on actions that help further the goal of the task at hand, and punishing it on actions that are counter-productive to this goal.
Policies come in two flavors: deterministic and stochastic.
Deterministic policies are defined as function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>:</mo><mi>S</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\pi: S \to A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span>, whereas stochastic policies are defined as probability distributions over actions, i.e., <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(a \mid s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span>.
While in the usual RL setting the (or at least one) optimal policy is guaranteed to be deterministic, in inverse reinforcement learning (and not only there), it makes more sense to talk about stochastic policies.</p>
<p>Inverse reinforcement learning, as discussed above and the name suggests, does the inverse of RL.
Given a set of demonstrations <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>τ</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{D} = \{\tau_i\}_{i=1}^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0087em;vertical-align:-0.2587em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span> of an expert (agent), consisting of trajectories <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mrow><mo fence="true">(</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>s</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tau = \left( (s_1, a_1), (s_2, a_2), \ldots, (s_{n-1}, a_{n-1}), s_n \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span> through the state-action space, IRL aims to recover the underlying reward function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span>, which explains the behavior of the expert.</p>
<p>To allow for computation with states, we use so-called features.
Features are, in this case, defined as a function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>:</mo><mi>S</mi><mo>→</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">\phi: S \to \mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal">ϕ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span>, mapping states to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span>-dimensional vectors, and can be arbitrarily chosen.
In general, we assume that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">∣</mi><mi>τ</mi><mi mathvariant="normal">∣</mi></mrow></msubsup><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(\tau) = \sum_{t = 1}^{|\tau|} \phi(s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3276em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0279em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>τ</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\tau|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mord">∣</span></span></span></span> denotes the length of the trajectories (visited states), i.e., that the features of a trajectory <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span> are the sum of the features of the states visited by this trajectory, counting repetitions.</p>
<h2 id="the-principle-of-maximum-entropy"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#the-principle-of-maximum-entropy">The Principle of Maximum Entropy</a></h2>
<p>The general idea of Maximum Entropy Inverse Reinforcement Learning is based on feature-expectation matching <span class="csl-ref" id="citation--abbeelapprenticeshiplearninginverse2004--3">[<a href="#bib-abbeelapprenticeshiplearninginverse2004">Abbeel and Ng 2004</a>]</span>:
The expected visitation-frequency of features in the demonstrations provided by the expert should equal the expected visitation-frequency of features visited by the agent following the recovered reward function.
In other words: The features describing the states of our world should be, in expectation, visited equally often by the agent following our recovered reward function and by the expert demonstrating (nearly) optimal behavior.
In equations, we can express this as the expectation of features <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal">ϕ</span></span></span></span> over trajectories <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span> derived from the reward we want to recover, and</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">    \mathbb{E}_{\pi^L}[\phi(\tau)] = \mathbb{E}_{\pi^E}[\phi(\tau)],</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span><span class="mpunct">,</span></span></span></span></span>
<p>where the learner follows a policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mi>L</mi></msup></mrow><annotation encoding="application/x-tex">\pi^L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span> directly implied by the reward.
The expert follows an implicit policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mi>E</mi></msup></mrow><annotation encoding="application/x-tex">\pi^E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span> that encodes its notion of reward and optimality.</p>
<p>Note that we can also express the expected feature visitation frequency as sum over trajectories</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><munder><mo>∑</mo><mi>τ</mi></munder><msub><mi>p</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    \mathbb{E}_{\pi^L}[\phi(\tau)] = \sum_{\tau} p_{\pi^L}(\tau) \phi(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.3em;vertical-align:-1.25em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span></span>
<p>with the probability distribution <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{\pi^L}(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span> of trajectories of the learner. Finding such a match, however, is not a well-posed problem in accordance to the definition by Hadamard: There is not the single one, but many possible solutions.
Multiple reward functions can achieve the same expected feature-visitation frequency <span class="csl-ref" id="citation--ngpolicyinvariancereward1999--abbeelapprenticeshiplearninginverse2004--ziebartmodelingpurposefuladaptive2010--4">[<a href="#bib-ngpolicyinvariancereward1999">Ng et al. 1999</a>; <a href="#bib-abbeelapprenticeshiplearninginverse2004">Abbeel and Ng 2004</a>; <a href="#bib-ziebartmodelingpurposefuladaptive2010">Ziebart 2010</a>]</span>.
To resolve this ambiguity, Ziebart et al. <span class="csl-ref" id="citation--ziebartmaximumentropyinverse2008--5">[<a href="#bib-ziebartmaximumentropyinverse2008">Ziebart et al. 2008</a>]</span> propose to choose the solution (i.e., the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><msup><mi>π</mi><mi>L</mi></msup></msub></mrow><annotation encoding="application/x-tex">p_{\pi^L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6276em;vertical-align:-0.1971em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span></span></span></span>) maximizing the entropy.</p>
<p>But why should we maximize the entropy?
To answer this, we have to understand what entropy represents.
Firstly, the entropy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> of some event probability distribution <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span> is defined as</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant="script">X</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant="script">X</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>1</mn><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    H(p)
    &amp;= -\sum_{x \in \mathcal{X}} p(x) \log_2 p(x), \\
    &amp;= \sum_{x \in \mathcal{X}} p(x) \cdot \log_2 \frac{1}{p(x)},
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.6149em;vertical-align:-2.5574em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0574em"><span style="top:-5.3289em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span><span style="top:-2.3857em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.5574em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0574em"><span style="top:-5.3289em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.14643em">X</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.3857em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.14643em">X</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.5574em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span> is the set containing all events <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> the probability of event <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span> occurring.</p>
<p>Let us now assume that we want to communicate the occurrence of all events <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span> with some other party efficiently.
To accomplish this, we wish to minimize the expected message length, so messages that will be sent frequently should be short, and messages that will seldom be sent are allowed to be long.
Following this trail of thought leads to the term <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x) = \log_2(1/p(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1/</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span>, which is the optimal number of bits that we should spend on the message representing event <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span>.
With lower probability <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>, the term <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log_2(1/p(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1/</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span> increases.
In fact, it increases logarithmically, as with more bits available, we can encode exponentially more events.
Using this observation for the entropy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span> then yields nothing more than the entropy being the lower limit of the expected message length over all messages, i.e.:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">[</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">    H(p)
    = \mathbb{E}_{p(x)}\left[h(x)\right].</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">]</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">.</span></span></span></span></span>
<p>Summarizing all of this in a single sentence: Entropy is a measure of uncertainty.</p>
<div class="
        p-4 my-4
        rounded border-l-4 border-sky-600 dark:border-sky-700
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Note:</strong> This is, in fact, the underlying principle of Huffman coding, which, due to this relation, is guaranteed to be optimal.</p></div>
<p>As is done generally, we will now use the normal logarithm instead of the base-two one.
Since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log_2(x) = \log(x)/\log(2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">/</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span> holds, we are only dropping a constant factor of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span> which does not impact extrema or our reasoning below, and simplifies further computations.</p>
<p>With that in mind, let us ask again:
Why should we maximize the entropy?
Now we can give a simple reasoning <span class="csl-ref" id="citation--jaynesinformationtheorystatistical1957--6">[<a href="#bib-jaynesinformationtheorystatistical1957">Jaynes 1957</a>]</span>:
Let us assume that we have two distributions, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span>, with entropy values <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>H</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(p) &gt; H(q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mclose">)</span></span></span></span>.
From our previous observations, we now know that to encode messages from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span> we, in expectancy, need more bits than to encode messages from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span>.
This is the key point because this in turn also means that we have less information about <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span> than about <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span>.
If we know more about a distribution, we require fewer bits to encode events from it.
If we know everything, we do not need to send/encode anything, and if we know nothing, we need to send everything.</p>
<p>But isn&#x27;t it good if we know more? “The less entropy, the better, right?” you may ask.
No.
Not for many optimization problems, or in general, when working with incomplete information:
Consider a problem, like feature-expectation matching, which has multiple solutions fulfilling our constraints.
The only information which we give our solver for this problem is the feature-expectations we want to replicate.
All solutions provided by our solver contain this information.
Yet, they most certainly have different entropy values.
This must mean that (at least) some solutions have additional information that we did not provide, i.e., they have a bias.
This is illustrated in the figure below for our two distributions <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span>:</p>
<p><img src="/assets/blog/20220825-irl-maxent/maxent-principle.png" alt="Illustration of the Maximum Entropy Principle"/></p>
<p>By choosing the solution with maximum entropy, we choose the solution with minimal information.
Note that all solutions already satisfy our constraints; thus we actually pick the solution that best fits our information with a minimal bias.</p>
<h2 id="deriving-the-maximum-entropy-inverse-reinforcement-learning-algorithm"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#deriving-the-maximum-entropy-inverse-reinforcement-learning-algorithm">Deriving the Maximum Entropy Inverse Reinforcement Learning Algorithm</a></h2>
<p>Applying our findings from the previous section to feature-expectation matching directly results in a constrained optimization problem:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mrow><mi mathvariant="normal">arg max</mi><mo>⁡</mo></mrow><mi>p</mi></munder><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>subject to</mtext><mspace width="1em"></mspace><mrow></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo>∑</mo><mi>τ</mi></munder><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="1em"></mspace><mi mathvariant="normal">∀</mi><mi>τ</mi><mo>:</mo><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{alignat*}{2}
    \argmax_p\quad
        &amp;&amp; H(p) \\
    \text{subject to}\quad
        \label{eq:feature-constraints}
        &amp;&amp; \mathbb{E}_{\pi^L}[\phi(\tau)] &amp;= \mathbb{E}_{\pi^E}[\phi(\tau)],
            \tag{1a} \\
        \label{eq:probability-constraints}
        &amp;&amp; \sum_{\tau} p(\tau) = 1, &amp;\quad \forall \tau : p(\tau) &gt; 0,
            \tag{1b}
\end{alignat*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.2706em;vertical-align:-2.8853em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3853em"><span style="top:-5.5953em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.2056em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">arg</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathrm">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0305em"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span></span></span><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord text"><span class="mord">subject to</span></span><span class="mspace" style="margin-right:1em"></span><span class="enclosing" id="eq:feature-constraints"></span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="enclosing" id="eq:probability-constraints"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3853em"><span style="top:-5.5953em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3853em"><span style="top:-5.5953em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2147em"><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span><span class="mpunct">,</span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:1em"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3853em"><span style="top:-5.5953em"><span class="pstrut" style="height:3.05em"></span><span></span></span><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1a</span></span><span class="mord">)</span></span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1b</span></span><span class="mord">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span></span></span></span>
<p>where <a href="#eq:feature-constraints" class="no-underline hover:underline">Equation (1a)</a> represents the feature-matching constraint and <a href="#eq:probability-constraints" class="no-underline hover:underline">Equation (1b)</a> the probability constraints.</p>
<p>This problem expresses that we want to find a probability distribution <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span> over trajectories <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span> with maximum entropy, under which the expected feature visitation frequencies of learner <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}_{\pi^L}[\phi(\tau)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span></span></span></span> and expert <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}_{\pi^E}[\phi(\tau)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span></span></span></span> match (that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span> represents the features visited by trajectory <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span>).
Note that the policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mi>L</mi></msup></mrow><annotation encoding="application/x-tex">\pi^L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span> of the learner depends on the probability distribution <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span> with</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow></mrow><msup><mi>π</mi><mi>L</mi></msup><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy="false">)</mo><mo>∝</mo><munder><mo>∑</mo><mrow><mi>τ</mi><mo>:</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>∈</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    \label{eq:policy}
    \pi^L(a \mid s) \propto \sum_{\tau :\ (s, a) \in \tau_{t=0}} p(\tau),
    \tag{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em"></span><span class="enclosing" id="eq:policy"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.809em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mrel mtight">:</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.1132em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mpunct">,</span></span><span class="tag"><span class="strut" style="height:2.566em;vertical-align:-1.516em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span>
<p>i.e., the policy of the learner is proportional to the sum of the probabilities of all trajectories performing action <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">a</span></span></span></span> in the starting state <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">s</span></span></span></span>.</p>
<p>Now we have the probability distribution over trajectories, but how does this help us to recover the reward function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>:</mo><mi>S</mi><mo>→</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">R: S \to \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord mathbb">R</span></span></span></span>?
Following the school of basic reinforcement learning provides us with the answer: The reward dictates the policy, which in turn dictates the trajectory distribution <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span>.
A key assumption of Maximum Entropy IRL is that we know the behavior of our MDP, i.e., we have a perfect model representing the transition probabilities <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(s_{t+1} \mid s_t, a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, so the only thing we actually need to learn is the reward.
Everything else either is derived from it or assumed known.
To be able to learn the reward, we must parameterize it.
For this, we assume linearity regarding features, i.e.,</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">    R(\tau) = \omega^\top \phi(\tau),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span>
<p>with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">\omega \in \mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span> being the reward parameter vector.
To make the dependency on the reward parameters explicit, we write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau \mid \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(a \mid s, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span>.</p>
<div class="
        p-4 my-4
        rounded border-l-4 border-sky-600 dark:border-sky-700
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Note:</strong> The choice of a linear parametrization is not by chance, but a direct result of the feature expectation matching constraint:
Given an expert solving an MDP with unknown reward function linear in a set of known features, performing feature expectation matching with those features is guaranteed to yield a policy performing comparable to or better than the expert with respect to that reward <span class="csl-ref" id="citation--abbeelapprenticeshiplearninginverse2004--7">[<a href="#bib-abbeelapprenticeshiplearninginverse2004">Abbeel and Ng 2004</a>]</span>.</p></div>
<h3 id="solution-and-partition-function"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#solution-and-partition-function">Solution and Partition Function</a></h3>
<p>Solving the above mathematical program for MDPs with deterministic transition dynamics (i.e., MDPs where all actions have predetermined deterministic outcomes) using the method of Lagrange multipliers leads to the observation that</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>p</mi><mi>d</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mi>τ</mi></munder><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    p_d(\tau \mid \omega) &amp;= \frac{1}{Z(\omega)} \exp \left( \omega^\top \phi(\tau) \right), \\
    Z(\omega) &amp;= \sum_{\tau} \exp \left( \omega^\top \phi(\tau) \right)
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.1575em;vertical-align:-2.3287em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8287em"><span style="top:-4.8287em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-2.5427em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3287em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8287em"><span style="top:-4.8287em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span></span></span><span style="top:-2.5427em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3287em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p>with the so-called partition function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span> simply normalizing the values to fulfill the probability distribution constraint <span class="csl-ref" id="citation--ziebartmaximumentropyinverse2008--osaalgorithmicperspectiveimitation2018--8">[<a href="#bib-ziebartmaximumentropyinverse2008">Ziebart et al. 2008</a>; <a href="#bib-osaalgorithmicperspectiveimitation2018">Osa et al. 2018</a>]</span>.
By choosing the reward to linearly depend on the features, we have also ensured that the Lagrange multipliers are precisely the reward parameters <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span></span></span></span> <span class="csl-ref" id="citation--osaalgorithmicperspectiveimitation2018--9">[<a href="#bib-osaalgorithmicperspectiveimitation2018">Osa et al. 2018</a>]</span>.
For MDPs with stochastic transitions, Ziebart et al. <span class="csl-ref" id="citation--ziebartmaximumentropyinverse2008--10">[<a href="#bib-ziebartmaximumentropyinverse2008">Ziebart et al. 2008</a>]</span> propose to modify the deterministic solution, yielding the approximation</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow></mrow><msub><mi>p</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>≈</mo><mfrac><mn>1</mn><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><munder><mo>∏</mo><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>t</mi></msub><mo>∈</mo><mi>τ</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    \label{eq:approx-probability}
    p_s(\tau \mid \omega)
    \approx
        \frac{1}{Z(\omega)} \exp\left( \omega^\top \phi(\tau) \right)
        \prod_{s_{t+1}, a_t, s_t \in \tau} p(s_{t+1} \mid s_t, a_t).
    \tag{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="enclosing" id="eq:approx-probability"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.7132em;vertical-align:-1.3918em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span><span class="tag"><span class="strut" style="height:2.7132em;vertical-align:-1.3918em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span>
<div class="
        p-4 my-4
        rounded border-l-4 border-sky-600 dark:border-sky-700
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Note:</strong> We are simply multiplying the deterministic solution with combined transition probability of the trajectory.
As a result of said modification, however, we introduce a bias to the reward function <span class="csl-ref" id="citation--osaalgorithmicperspectiveimitation2018--11">[<a href="#bib-osaalgorithmicperspectiveimitation2018">Osa et al. 2018</a>]</span>.
To avoid this, Ziebart <span class="csl-ref" id="citation--ziebartmodelingpurposefuladaptive2010--12">[<a href="#bib-ziebartmodelingpurposefuladaptive2010">Ziebart 2010</a>]</span> proposes the Maximum Causal Entropy IRL method in his thesis <span class="csl-ref" id="citation--ziebartprinciplemaximumcausal2013--13">[<a href="#bib-ziebartprinciplemaximumcausal2013">see also Ziebart et al. 2013</a>]</span>.
In the scope of this post, we&#x27;ll stick to the normal (non-causal) entropy.</p></div>
<h3 id="optimization"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#optimization">Optimization</a></h3>
<p>We now know the parameterized form of the distribution, so how can we optimize the parameters?
The answer is fairly straightforward: We can maximize the log-likelihood over all demonstrated trajectories <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>τ</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{D} = \{\tau_i\}_{i=1}^{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span>, i.e.,</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow></mrow><msup><mi>ω</mi><mo>∗</mo></msup><mo>=</mo><munder><mrow><mi mathvariant="normal">arg max</mi><mo>⁡</mo></mrow><mi>ω</mi></munder><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow><mi mathvariant="normal">arg max</mi><mo>⁡</mo></mrow><mi>ω</mi></munder><munder><mo>∑</mo><mrow><mi>τ</mi><mo>∈</mo><mi mathvariant="script">D</mi></mrow></munder><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    \label{eq:loglikelihood}
    \omega^* = \argmax_{\omega} \mathcal{L}(\omega)
    = \argmax_{\omega} \sum_{\tau \in \mathcal{D}} \log p(\tau \mid \omega),
    \tag{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7387em"></span><span class="enclosing" id="eq:loglikelihood"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.6444em;vertical-align:-0.8944em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.2056em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ω</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">arg</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathrm">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.3717em;vertical-align:-1.3217em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.2056em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ω</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">arg</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathrm">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.02778em">D</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mpunct">,</span></span><span class="tag"><span class="strut" style="height:2.3717em;vertical-align:-1.3217em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span>
<p>using gradient ascent (or any other gradient-based optimization technique) as this function is convex <span class="csl-ref" id="citation--ziebartmaximumentropyinverse2008--osaalgorithmicperspectiveimitation2018--14">[<a href="#bib-ziebartmaximumentropyinverse2008">Ziebart et al. 2008</a>; <a href="#bib-osaalgorithmicperspectiveimitation2018">Osa et al. 2018</a>]</span>.</p>
<div class="
        p-4 my-4
        rounded border-l-4 border-sky-600 dark:border-sky-700
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Note:</strong> Maximizing the log-likelihood is equivalent to minimizing the Kullback-Leibler divergence <span class="csl-ref" id="citation--bishoppatternrecognitionmachine2006--15">[<a href="#bib-bishoppatternrecognitionmachine2006">Bishop 2006</a>]</span></p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msup><mi>p</mi><mi>E</mi></msup><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mtext> </mtext><mi mathvariant="normal">∥</mi><mtext> </mtext><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">D_{KL}\big(p^E(\tau) \,\|\, p(\tau \mid \omega)\big).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2413em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∥</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mord">.</span></span></span></span></span></div><p>It can therefore also be interpreted as the M-projection onto the manifold of the maximum entropy distribution <span class="csl-ref" id="citation--osaalgorithmicperspectiveimitation2018--16">[<a href="#bib-osaalgorithmicperspectiveimitation2018">see e.g., Osa et al. 2018</a>]</span>.</p></div>
<p>The (averaged) gradient is then simply the difference between expected empirical feature counts <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mrow><mo fence="true">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}_{\pi^E} \left[ \phi(\tau) \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">]</span></span></span></span></span> and the learner&#x27;s expected feature counts (derived from the trajectory probabilities <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau \mid \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span>), shown in <a href="#eq:grad-a" class="no-underline hover:underline">Equation (5a)</a>, i.e.:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi mathvariant="normal">∇</mi><mi>ω</mi></msub><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mrow><mo fence="true">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mo>−</mo><munder><mo>∑</mo><mi>τ</mi></munder><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mrow><mo fence="true">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mo>−</mo><munder><mo>∑</mo><msub><mi>s</mi><mi>i</mi></msub></munder><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \label{eq:grad-a}
    \nabla_\omega \mathcal{L}(\omega)
    &amp;= \mathbb{E}_{\pi^E} \left[ \phi(\tau) \right] - \sum_{\tau} p(\tau \mid \omega)\ \phi(\tau),
        \tag{5a}\\
    \label{eq:grad-b}
    &amp;= \mathbb{E}_{\pi^E} \left[ \phi(\tau) \right] - \sum_{s_i} D_{s_i} \phi(s_i),
        \tag{5b}\\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.3001em;vertical-align:-2.4001em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9001em"><span style="top:-4.9001em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="enclosing" id="eq:grad-a"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-2.3em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="enclosing" id="eq:grad-b"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4001em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9001em"><span style="top:-4.9001em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">]</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace"> </span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.3em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">]</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3501em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4001em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9001em"><span style="top:-4.9001em"><span class="pstrut" style="height:3.05em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5a</span></span><span class="mord">)</span></span></span></span><span style="top:-2.3em"><span class="pstrut" style="height:3.05em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5b</span></span><span class="mord">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4001em"><span></span></span></span></span></span></span></span></span>
<p>which we can express in terms of the state-visitation frequency <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span> with <a href="#eq:grad-b" class="no-underline hover:underline">Equation (5b)</a>, assuming <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi mathvariant="normal">∣</mi><mi>τ</mi><mi mathvariant="normal">∣</mi></mrow></msubsup><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(\tau) = \sum_{t = 0}^{|\tau|} \phi(s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3276em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0279em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> <span class="csl-ref" id="citation--ziebartmaximumentropyinverse2008--17">[<a href="#bib-ziebartmaximumentropyinverse2008">Ziebart et al. 2008</a>]</span>.</p>
<div class="
        p-4 my-4
        rounded border-l-4 border-sky-600 dark:border-sky-700
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Note:</strong> The realization that we can transform <a href="#eq:grad-a" class="no-underline hover:underline">Equation (5a)</a> to <a href="#eq:grad-b" class="no-underline hover:underline">Equation (5b)</a>, i.e., represent the expected feature count of the learner via the state-visitation frequency <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span>, is actually one of the most important steps!</p><p><a href="#eq:grad-a" class="no-underline hover:underline">Equation (5a)</a> is generally infeasible (or at the very least quite costly) to compute, as enumerating all trajectories is usually subject to combinatorial explosion (think, for example, of trajectories in a “simple” grid world).
Computing the state visitation frequencies, as we will see below, however, is quite feasible (within some restrictions).</p></div>
<div class="
        p-4 my-4
        rounded border-l-4 border-sky-600 dark:border-sky-700
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Note:</strong> Due to the log-likelihood, this gradient holds for both deterministic and stochastic transition dynamics.</p></div>
<h3 id="computing-the-state-visitation-frequency"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#computing-the-state-visitation-frequency">Computing the State-Visitation Frequency</a></h3>
<p>Now, we have only one remaining question:
How do we compute the state-visitation frequency <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span>?
Following good computer-science fashion, we divide and conquer:
First, we compute a (stochastic) policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}}(a \mid s, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span>, referred to as the local action probability, with a backward pass.
Thereafter, we compute the state-visitation frequency under this policy with a simple forward pass.</p>
<h4 id="backward-pass-computing-the-local-action-policy"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#backward-pass-computing-the-local-action-policy">Backward Pass: Computing the Local Action Policy</a></h4>
<p>The basic idea of the first pass is to remember our earlier observation about the learner policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mi>L</mi></msup><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi^L(a \mid s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> made in <a href="#eq:policy" class="no-underline hover:underline">Equation (2)</a>, i.e.,</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>∝</mo><munder><mo>∑</mo><mrow><mi>τ</mi><mo>:</mo><mtext> </mtext><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>∈</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">    \pi_{\text{ME}}(a_j \mid s_i, \omega) \propto \sum_{\tau :\ (s_i, a_j) \in \tau_{t=0}} p(\tau \mid \omega),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.5883em;vertical-align:-1.5383em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.809em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mrel mtight">:</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.1132em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5383em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span>
<p>and then recursively expand this using the solution we derived for our trajectory distribution <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau \mid \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span> presented in <a href="#eq:approx-probability" class="no-underline hover:underline">Equation (3)</a> until we are not reasoning about full or partial trajectories any longer, but the individual state transitions.
This then yields the set of equations <span class="csl-ref" id="citation--ziebartmaximumentropyinverse2008--18">[<a href="#bib-ziebartmaximumentropyinverse2008">Ziebart et al. 2008</a>]</span>:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub></mrow></msub><msub><mi>Z</mi><msub><mi>s</mi><mi>j</mi></msub></msub></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mi>k</mi></munder><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>k</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mtext> </mtext><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mtext> </mtext><msub><mi>Z</mi><msub><mi>s</mi><mi>k</mi></msub></msub><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>Z</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><msub><mi>a</mi><mi>j</mi></msub></munder><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub></mrow></msub><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \label{eq:bwpass}
    \pi_{\text{ME}}(a_j \mid s_i, \omega) &amp;= \frac{Z_{s_i, a_j}}{Z_{s_j}},
        \tag{6a} \\
    Z_{s_i, a_j} &amp;= \sum_{k} p(s_k \mid s_i, a_j)\, \exp \left(\omega^\top \phi(s_i)\right)\, Z_{s_k},
        \tag{6b} \\
    Z_{s_i} &amp;= \sum_{a_j} Z_{s_i, a_j}.
        \tag{6c}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:8.2034em;vertical-align:-3.8517em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.3517em"><span style="top:-6.3517em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="enclosing" id="eq:bwpass"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-3.9684em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span></span></span><span style="top:-1.3163em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.8517em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.3517em"><span style="top:-6.3517em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4207em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.7373em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0333em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span style="top:-3.9684em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8479em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2559em"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-1.3163em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4473em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.8517em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.3517em"><span style="top:-6.3517em"><span class="pstrut" style="height:3.4207em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6a</span></span><span class="mord">)</span></span></span></span><span style="top:-3.9684em"><span class="pstrut" style="height:3.4207em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6b</span></span><span class="mord">)</span></span></span></span><span style="top:-1.3163em"><span class="pstrut" style="height:3.4207em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6c</span></span><span class="mord">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.8517em"><span></span></span></span></span></span></span></span></span>
<p>Here, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">Z_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span> represents the state-partition-function, again normalizing the probabilities, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{s_i, a_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> is referred to as the state-action partition function.
Setting the state-partition function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><msub><mi>s</mi><mi>i</mi></msub></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Z_{s_i} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> for terminal states and then recursively backing up, using the equations for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">Z_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{s_i, a_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0307em;vertical-align:-0.3473em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span></span></span></span>, from those states yields a set of values that we can then use to compute the local action probabilities following the above equation.</p>
<div class="
        p-4 my-4
        rounded border-l-4 border-sky-600 dark:border-sky-700
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Note:</strong> This backup-pass somewhat resembles a value-iteration scheme to solve an MDP.
It also turns out that this backup part of the algorithm is the only thing that differs between Maximum Entropy and Maximum Causal Entropy IRL.</p><p>In fact, for the Maximum Causal Entropy approach, one can show that the partition functions are an analogy of the Bellman equation — the so-called soft Bellman equation — which allows for a straightforward extension of the value-iteration algorithm to this problem <span class="csl-ref" id="citation--ziebartmodelingpurposefuladaptive2010--ziebartprinciplemaximumcausal2013--19">[<a href="#bib-ziebartmodelingpurposefuladaptive2010">Ziebart 2010</a>; <a href="#bib-ziebartprinciplemaximumcausal2013">Ziebart et al. 2013</a>]</span>.</p></div>
<h4 id="forward-pass-inferring-state-visitation-frequency-from-pi_textme"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#forward-pass-inferring-state-visitation-frequency-from-pi_textme">Forward Pass: Inferring State-Visitation Frequency from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></a></h4>
<p>As we now know the policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}}(a_j \mid s_i, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span>, inferring the state-visitation frequency <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span> becomes fairly easy:
Remember that the policy is a probability distribution that tells us, given a state <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, with which probability the agent should take a certain action <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">a_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span>, which then leads to a new state <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> according to our MDP transition model.
Given an initial state-visitation frequency, we can therefore use the policy to forward-propagate the individual visitation counts, obtaining an updated state-visitation frequency map.</p>
<p>To this end, we initialize <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">D_{s_i, 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> to the starting-state probabilities <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_0(s_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> at timestep <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, i.e.,</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow></mrow><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>p</mi><mn>0</mn></msub><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>:</mo><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></msub><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(7a)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    \label{eq:fwpass}
    D_{s_i, 0} = p_0(s_i) = p(\tau : s_i \in \tau_{t=0}).
    \tag{7a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="enclosing" id="eq:fwpass"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span><span class="tag"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7a</span></span><span class="mord">)</span></span></span></span></span></span>
<p>We then compute updates as mentioned above via</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>k</mi></msub><mo separator="true">,</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><munder><mo>∑</mo><msub><mi>s</mi><mi>i</mi></msub></munder><munder><mo>∑</mo><msub><mi>a</mi><mi>j</mi></msub></munder><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>⋅</mo><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>k</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(7b)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    D_{s_k, t+1} = \sum_{s_i} \sum_{a_j} D_{s_i, t}
        \cdot \pi_{\text{ME}} (a_j \mid s_i, \omega)
        \cdot p(s_k \mid s_i, a_j),
    \tag{7b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.4973em;vertical-align:-1.4473em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3501em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4473em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span><span class="tag"><span class="strut" style="height:2.4973em;vertical-align:-1.4473em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7b</span></span><span class="mord">)</span></span></span></span></span></span>
<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>k</mi></msub><mo>∣</mo><msub><mi>a</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(s_k \mid a_j, s_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> represents the transition probabilities of our (stochastic) MDP.
Note, that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{s_i, t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> only gives us the state-visitation frequency for time-step <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span>, meaning we have to sum them up to obtain the time-step independent state-visitation</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub><mo>=</mo><munder><mo>∑</mo><mi>t</mi></munder><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(7c)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    D_{s_i} = \sum_{t} D_{s_i, t}.
    \tag{7c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.3em;vertical-align:-1.25em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord">.</span></span><span class="tag"><span class="strut" style="height:2.3em;vertical-align:-1.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7c</span></span><span class="mord">)</span></span></span></span></span></span>
<h2 id="the-algorithm"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#the-algorithm">The Algorithm</a></h2>
<p>With a plan for computation of the state-visitation frequency, we now have everything we need to state the full algorithm.
To derive that, however, let us first recap our findings:</p>
<ul>
<li>
<p>Our problem is a constrained optimization problem for finding the optimal reward parameters <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span></span></span></span>.
We can solve this problem by maximizing the log-likelihood over all demonstrated trajectories <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span></span></span></span> (see <a href="#eq:loglikelihood" class="no-underline hover:underline">Equation (4)</a>).
This, in turn, is itself an optimization problem, for which we need the gradient <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \mathcal{L}(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∇</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span> of this log-likelihood.</p>
</li>
<li>
<p>To compute the gradient <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \mathcal{L}(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∇</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span>, we require the state-visitation frequency (see <a href="#eq:grad-b" class="no-underline hover:underline">Equation (5b)</a>).</p>
</li>
<li>
<p>To compute the state-visitation frequency, we require the policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}} (a_j \mid s_i, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span> (see <a href="#eq:fwpass" class="no-underline hover:underline">Equation (7b)</a>).</p>
</li>
</ul>
<p>Putting this all together yields the following iteration scheme:</p>
<ol>
<li>
<p>Compute policy <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}} (a_j \mid s_i, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span> the using current estimate of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span></span></span></span> via the backward pass, i.e., <a href="#eq:bwpass" class="no-underline hover:underline">Equations (6a–c)</a>.</p>
</li>
<li>
<p>Compute the state-visitation frequency <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span> via the forward pass, i.e., <a href="#eq:fwpass" class="no-underline hover:underline">Equations (7a–c)</a>.</p>
</li>
<li>
<p>Compute the gradient <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \mathcal{L}(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∇</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span> via <a href="#eq:grad-b" class="no-underline hover:underline">Equation (5b)</a>.</p>
</li>
<li>
<p>Perform one gradient-based optimization step, e.g.,</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ω</mi><mo>←</mo><mi>ω</mi><mo>+</mo><mi>η</mi><mi mathvariant="normal">∇</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\omega \gets \omega + \eta \nabla \mathcal{L}(\omega).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mord">∇</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span>
</li>
</ol>
<p>We then iterate these four steps until convergence.</p>
<div class="
        p-4 my-4
        rounded border-l-4 border-sky-600 dark:border-sky-700
        bg-slate-200 dark:bg-slate-800
        [&amp;&gt;*:first-child]:mt-0 [&amp;&gt;*:last-child]:mb-0
    "><p><strong>Note:</strong> You can find a Jupyter Notebook discussing a simple implementation of this algorithm (applied to a grid-world example) at <a href="https://github.com/qzed/irl-maxent">github.com/qzed/irl-maxent</a>.</p></div>
<h2 id="some-last-words"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#some-last-words">Some Last Words…</a></h2>
<p>Maximum entropy IRL is a clever and ― all in all ― fairly simple solution to the general inverse reinforcement learning problem.
However, it does have some drawbacks and limitations:</p>
<p>First and foremost, the algorithm as explained in this post requires us “solving” the MDP once per iteration.
As a result, it is fairly limited in the size of the discrete state-action-spaces that it can (reasonably) be applied to.
Extensions to continuous state spaces, for example via Monte-Carlo sampling or via path integrals, have been proposed <span class="csl-ref" id="citation--aghasadeghimaximumentropyinverse2011--kalakrishnanlearningobjectivefunctions2013--20">[see e.g., <a href="#bib-aghasadeghimaximumentropyinverse2011">Aghasadeghi and Bretl 2011</a>; <a href="#bib-kalakrishnanlearningobjectivefunctions2013">Kalakrishnan et al. 2013</a>]</span>.
However, the assumption that the transition dynamics of the environment, i.e., the probability distribution <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(s_{t+1} \mid s_t, a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, are known, further limits its applicability.</p>
<p>It also assumes a linear parametrization of the reward <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>ω</mi><mo>⊺</mo></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(s) = \omega^\intercal \phi(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin amsrm mtight">⊺</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span>.
This can be somewhat mitigated by our choice of features <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span>, but feature expectation matching also only guarantees performance-parity with a linear reward parametrization.
An extension to model nonlinear reward functions via neural networks has been suggested by Wulfmeier et al. <span class="csl-ref" id="citation--wulfmeiermaximumentropydeep2016--21">[<a href="#bib-wulfmeiermaximumentropydeep2016">2016</a>]</span>.</p>
<p>Lastly, maximum entropy IRL is constrained to limited transition randomness, i.e., fairly deterministic transition dynamics <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(s_{t+1} \mid s_t, a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.
As noted above, this is due to the reward bias introduced by our probability approximation and can be avoided via the maximum <em>causal</em> entropy IRL approach, proposed subsequently by Ziebart <span class="csl-ref" id="citation--ziebartmodelingpurposefuladaptive2010--ziebartprinciplemaximumcausal2013--22">[<a href="#bib-ziebartmodelingpurposefuladaptive2010">Ziebart 2010</a>; <a href="#bib-ziebartprinciplemaximumcausal2013">Ziebart et al. 2013</a>]</span>.</p>
<p>A somewhat similar, yet model-free approach is relative entropy IRL by Boularias et al. <span class="csl-ref" id="citation--boulariasrelativeentropyinverse2011--23">[<a href="#bib-boulariasrelativeentropyinverse2011">2011</a>]</span>.
See the paper by Snoswell et al. <span class="csl-ref" id="citation--snoswellrevisitingmaximumentropy2020--24">[<a href="#bib-snoswellrevisitingmaximumentropy2020">2020</a>]</span> for a perspective on both relative and maximum entropy IRL approaches.</p>
<h2 id="references"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#references">References</a></h2>
<div id="refs" class="references csl-bib-body">
  <div class="csl-entry" id="bib-abbeelapprenticeshiplearninginverse2004"><span style="font-variant:small-caps">Abbeel, P. and Ng, A.Y.</span> 2004. Apprenticeship learning via inverse reinforcement learning. <i>Twenty-first international conference on Machine learning - ICML ’04</i>, ACM Press.</div>
  <div class="csl-entry" id="bib-aghasadeghimaximumentropyinverse2011"><span style="font-variant:small-caps">Aghasadeghi, N. and Bretl, T.</span> 2011. Maximum entropy inverse reinforcement learning in continuous state spaces with path integrals. <i>2011 IEEE/RSJ International Conference on Intelligent Robots and Systems</i>, 1561–1566.</div>
  <div class="csl-entry" id="bib-bishoppatternrecognitionmachine2006"><span style="font-variant:small-caps">Bishop, C.M.</span> 2006. <i>Pattern Recognition and Machine Learning</i>. Springer, New York.</div>
  <div class="csl-entry" id="bib-boulariasrelativeentropyinverse2011"><span style="font-variant:small-caps">Boularias, A., Kober, J., and Peters, J.</span> 2011. Relative Entropy Inverse Reinforcement Learning. <i>Proceedings of the Fourteenth International Conference on Artificial Intelligence and Statistics</i>, JMLR Workshop and Conference Proceedings, 182–189.</div>
  <div class="csl-entry" id="bib-jaynesinformationtheorystatistical1957"><span style="font-variant:small-caps">Jaynes, E.T.</span> 1957. Information Theory and Statistical Mechanics. <i>Physical Review</i> <i>106</i>, 4, 620–630.</div>
  <div class="csl-entry" id="bib-kalakrishnanlearningobjectivefunctions2013"><span style="font-variant:small-caps">Kalakrishnan, M., Pastor, P., Righetti, L., and Schaal, S.</span> 2013. Learning objective functions for manipulation. <i>2013 IEEE International Conference on Robotics and Automation</i>, 1331–1336.</div>
  <div class="csl-entry" id="bib-ngpolicyinvariancereward1999"><span style="font-variant:small-caps">Ng, A.Y., Harada, D., and Russell, S.J.</span> 1999. Policy Invariance Under Reward Transformations: Theory and Application to Reward Shaping. <i>Proceedings of the Sixteenth International Conference on Machine Learning</i>, Morgan Kaufmann Publishers Inc., 278–287.</div>
  <div class="csl-entry" id="bib-osaalgorithmicperspectiveimitation2018"><span style="font-variant:small-caps">Osa, T., Pajarinen, J., Neumann, G., Bagnell, J.A., Abbeel, P., and Peters, J.</span> 2018. An Algorithmic Perspective on Imitation Learning. <i>Foundations and Trends in Robotics</i> <i>7</i>, 1–2, 1–179.</div>
  <div class="csl-entry" id="bib-snoswellrevisitingmaximumentropy2020"><span style="font-variant:small-caps">Snoswell, A.J., Singh, S.P.N., and Ye, N.</span> 2020. Revisiting Maximum Entropy Inverse Reinforcement Learning: New Perspectives and Algorithms. <i>2020 IEEE Symposium Series on Computational Intelligence (SSCI)</i>, 241–249.</div>
  <div class="csl-entry" id="bib-wulfmeiermaximumentropydeep2016"><span style="font-variant:small-caps">Wulfmeier, M., Ondruska, P., and Posner, I.</span> 2016. Maximum Entropy Deep Inverse Reinforcement Learning. http://arxiv.org/abs/1507.04888.</div>
  <div class="csl-entry" id="bib-ziebartmodelingpurposefuladaptive2010"><span style="font-variant:small-caps">Ziebart, B.D.</span> 2010. Modeling purposeful adaptive behavior with the principle of maximum causal entropy. https://www.cs.cmu.edu/~bziebart/publications/thesis-bziebart.pdf.</div>
  <div class="csl-entry" id="bib-ziebartprinciplemaximumcausal2013"><span style="font-variant:small-caps">Ziebart, B.D., Bagnell, J.A., and Dey, A.K.</span> 2013. The Principle of Maximum Causal Entropy for Estimating Interacting Processes. <i>IEEE Transactions on Information Theory</i>, IEEE, 1966–1980.</div>
  <div class="csl-entry" id="bib-ziebartmaximumentropyinverse2008"><span style="font-variant:small-caps">Ziebart, B.D., Maas, A., Bagnell, J.A., and Dey, A.K.</span> 2008. Maximum Entropy Inverse Reinforcement Learning. <i>Proceedings of the 23rd National Conference on Artificial Intelligence - Volume 3</i>, AAAI Press, 1433–1438.</div>
</div></div></article></div></main><!--$--><!--/$--></div><footer class=" absolute bottom-0 w-full h-14 flex items-center "><div class=" w-fit h-fit mx-auto text-xs text-slate-500 dark:text-slate-600 ">Copyright © 2026 Maximilian Luz</div></footer><script src="/_next/static/chunks/c8f256f3ce8bcb9b.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[13078,[\"/_next/static/chunks/dc82041b01df271f.js\"],\"SidebarProvider\"]\n3:I[22140,[\"/_next/static/chunks/dc82041b01df271f.js\"],\"default\"]\n4:I[22016,[\"/_next/static/chunks/dc82041b01df271f.js\"],\"\"]\n5:I[25883,[\"/_next/static/chunks/dc82041b01df271f.js\"],\"default\"]\nf:I[68027,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n:HL[\"/_next/static/chunks/c6b416b01c5580dd.css\",\"style\"]\n:HC[\"/\",\"\"]\n:HL[\"/_next/static/chunks/237a07649595a9a2.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"lQeDQUt8Hspk-e6naCYvs\",\"c\":[\"\",\"blog\",\"posts\",\"2022\",\"08\",\"irl-maxent\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"2022/08/irl-maxent\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/c6b416b01c5580dd.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/dc82041b01df271f.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"scroll-pt-[4rem] lg:scroll-pt-[5rem]\",\"children\":[\"$\",\"body\",null,{\"className\":\" relative min-h-dvh bg-slate-100 dark:bg-slate-900 text-slate-800 dark:text-slate-300 \",\"children\":[[\"$\",\"$L2\",null,{\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"header\",null,{\"className\":\" fixed top-0 w-full h-12 lg:h-14 z-40 flex-none border-b border-slate-200 dark:border-slate-800 \",\"children\":[\"$\",\"div\",null,{\"className\":\" absolute top-0 left-0 inset-0 backdrop-blur-lg  before:content-[\\\"\\\"] before:absolute before:top-0 before:left-0 before:inset-0 before:opacity-75 before:bg-slate-100 dark:before:bg-slate-900 before:z-[-1] \",\"children\":[\"$\",\"div\",null,{\"className\":\" flex items-center px-8 max-w-screen-xl mx-auto h-full text-slate-900 dark:text-slate-100 \",\"children\":[[\"$\",\"$L4\",null,{\"className\":\"mr-auto\",\"href\":\"/\",\"children\":[\"$\",\"div\",null,{\"className\":\" flex items-center gap-2 lg:gap-3 select-none whitespace-nowrap text-sky-800 dark:text-sky-100 \",\"children\":[[\"$\",\"svg\",null,{\"viewBox\":\"0 16 128 96\",\"fill\":\"currentColor\",\"className\":\"h-5 lg:h-6\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M46.3683 21.0665L56.2987 42.3623L25.8608 107.636H6L46.3683 21.0665Z\"}],[\"$\",\"path\",null,{\"d\":\"M78.7081 107.636H122.866L114.472 89.6365H87.1016L78.7081 107.636Z\"}],[\"$\",\"path\",null,{\"d\":\"M92.2987 42.3623L82.3683 21.0665L42 107.636H61.8608L92.2987 42.3623Z\"}]]}],[\"$\",\"span\",null,{\"className\":\"text-xl lg:text-2xl font-medium\",\"children\":\"Maximilian Luz\"}]]}]}],[\"$\",\"nav\",null,{\"className\":\"h-full font-medium text-base lg:text-[1.025rem] hidden sm:inline-block\",\"children\":[\"$\",\"ul\",null,{\"className\":\"flex items-center gap-5 h-full\",\"children\":[[\"$\",\"li\",\"Home\",{\"className\":\"h-full\",\"children\":[\"$\",\"$L5\",null,{\"inactiveClassName\":\" relative h-full flex items-center hover:text-sky-700 hover:dark:text-sky-500 before:content-[\\\"\\\"] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-transparent hover:before:border-slate-200 dark:hover:before:border-slate-800 transition-color before:transition-color duration-250 before:duration-250\",\"activeClassName\":\" relative h-full flex items-center text-sky-700 dark:text-sky-500 before:content-[\\\"\\\"] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-sky-700 dark:before:border-sky-500 transition-color before:transition-color duration-250 before:duration-250\",\"href\":\"/\",\"children\":\"Home\"}]}],[\"$\",\"li\",\"Blog\",{\"className\":\"h-full\",\"children\":[\"$\",\"$L5\",null,{\"inactiveClassName\":\" relative h-full flex items-center hover:text-sky-700 hover:dark:text-sky-500 before:content-[\\\"\\\"] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-transparent hover:before:border-slate-200 dark:hover:before:border-slate-800 transition-color before:transition-color duration-250 before:duration-250\",\"activeClassName\":\" relative h-full flex items-center text-sky-700 dark:text-sky-500 before:content-[\\\"\\\"] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-sky-700 dark:before:border-sky-500 transition-color before:transition-color duration-250 before:duration-250\",\"href\":\"/blog\",\"children\":\"Blog\"}]}],[\"$\",\"li\",\"Publications\",{\"className\":\"h-full\",\"children\":\"$L6\"}]]}]}],\"$L7\"]}]}]}]]}],\"$L8\",\"$L9\"]}]}]]}],{\"children\":[\"$La\",{\"children\":[\"$Lb\",{\"children\":[\"$Lc\",{\"children\":[\"$Ld\",{},null,false,false]},null,false,false]},null,false,false]},null,false,false]},null,false,false],\"$Le\",false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"10:I[27237,[\"/_next/static/chunks/dc82041b01df271f.js\"],\"default\"]\n11:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n12:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"default\"]\n14:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"OutletBoundary\"]\n15:\"$Sreact.suspense\"\n17:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"ViewportBoundary\"]\n19:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"MetadataBoundary\"]\n6:[\"$\",\"$L5\",null,{\"inactiveClassName\":\" relative h-full flex items-center hover:text-sky-700 hover:dark:text-sky-500 before:content-[\\\"\\\"] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-transparent hover:before:border-slate-200 dark:hover:before:border-slate-800 transition-color before:transition-color duration-250 before:duration-250\",\"activeClassName\":\" relative h-full flex items-center text-sky-700 dark:text-sky-500 before:content-[\\\"\\\"] before:absolute before:top-0 before:left-0 before:inset-0 before:box-border before:border-b-4 before:border-sky-700 dark:before:border-sky-500 transition-color before:transition-color duration-250 before:duration-250\",\"href\":\"/publications\",\"children\":\"Publications\"}]\n7:[\"$\",\"div\",null,{\"className\":\"absolute right-8 sm:hidden flex items-center\",\"children\":[\"$\",\"$L10\",null,{}]}]\n8:[\"$\",\"div\",null,{\"className\":\"pt-12 lg:pt-14 pb-14 min-h-dvh\",\"children\":[\"$\",\"$L11\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L12\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"main\",null,{\"className\":\"w-full h-full text-sky-950 dark:text-sky-100\",\"children\":[\"$\",\"div\",null,{\"className\":\"p-8 w-fit mx-auto mt-[calc(max(15dvh,0px))] flex flex-col *:w-fit *:mx-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"text-9xl font-bold mb-6\",\"children\":\"404\"}],[\"$\",\"p\",null,{\"className\":\"text-base sm:text-lg mb-1 text-center\",\"children\":\"Sorry. The page you are looking for does not exist.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\" mt-8 px-5 py-3 rounded-full border border-transparent bg-slate-300 dark:bg-slate-800 hover:border-slate-400 dark:hover:border-slate-600 \",\"children\":\"Home\"}]]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]\n9:[\"$\",\"footer\",null,{\"className\":\" absolute bottom-0 w-full h-14 flex items-center \",\"children\":[\"$\",\"div\",null,{\"className\":\" w-fit h-fit mx-auto text-xs text-slate-500 dark:text-slate-600 \",\"children\":\"Copyright © 2026 Maximilian Luz\"}]}]\na:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L11\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L12\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\nb:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L11\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L12\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\nc:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L11\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L12\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\nd:[\"$\",\"$1\",\"c\",{\"children\":[\"$L13\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/237a07649595a9a2.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/3b33f78cf07ae5fc.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$"])</script><script>self.__next_f.push([1,"L14\",null,{\"children\":[\"$\",\"$15\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@16\"}]}]]}]\ne:[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L17\",null,{\"children\":\"$L18\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$L19\",null,{\"children\":[\"$\",\"$15\",null,{\"name\":\"Next.Metadata\",\"children\":\"$L1a\"}]}]}],null]}]\n"])</script><script>self.__next_f.push([1,"1b:I[48234,[\"/_next/static/chunks/dc82041b01df271f.js\",\"/_next/static/chunks/3b33f78cf07ae5fc.js\"],\"Mdx\"]\n1c:T5c9d8,"])</script><script>self.__next_f.push([1,"const{Fragment:s,jsx:e,jsxs:a}=arguments[0];function _createMdxContent(l){const n={a:\"a\",annotation:\"annotation\",div:\"div\",em:\"em\",h2:\"h2\",h3:\"h3\",h4:\"h4\",i:\"i\",img:\"img\",li:\"li\",math:\"math\",mfrac:\"mfrac\",mi:\"mi\",mn:\"mn\",mo:\"mo\",mrow:\"mrow\",mspace:\"mspace\",mstyle:\"mstyle\",msub:\"msub\",msubsup:\"msubsup\",msup:\"msup\",mtable:\"mtable\",mtd:\"mtd\",mtext:\"mtext\",mtr:\"mtr\",munder:\"munder\",ol:\"ol\",p:\"p\",semantics:\"semantics\",span:\"span\",strong:\"strong\",ul:\"ul\",...l.components},{EqRef:i,KatexMath:m,Note:t}=n;return i||_missingMdxReference(\"EqRef\",!0),m||_missingMdxReference(\"KatexMath\",!0),t||_missingMdxReference(\"Note\",!0),a(s,{children:[a(t,{type:\"important\",children:[a(n.p,{children:[e(n.strong,{children:\"Disclaimer:\"}),\" This post is an adapted version of the theoretical part of a Jupyter Notebook that I wrote in 2019 for a seminar on Imitation Learning.\\nYou can find it, an accompanying presentation, and a small framework at \",e(n.a,{href:\"https://github.com/qzed/irl-maxent\",children:\"github.com/qzed/irl-maxent\"}),\".\"]}),e(n.p,{children:\"I highly encourage you to have a look at that notebook in case you're interested in the code behind this theory.\"})]}),\"\\n\",e(n.h2,{id:\"context-and-motivation\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#context-and-motivation\",children:\"Context and Motivation\"})}),\"\\n\",a(n.p,{children:[\"Let us start with some context and a brief overview of the problem we're trying to solve:\\n\",e(n.em,{children:\"Reinforcement learning (RL)\"}),\" aims to provide a framework for finding the optimal behavior (i.e., an optimal policy) of intelligent agents regarding some environment they interact with by directing them via a reward signal, measuring their performance.\\nIn \",e(n.em,{children:\"inverse reinforcement learning (IRL)\"}),\", somewhat conversely, we try to recover the reward function (and therefore policy) of an agent given a set of demonstrations performed by that agent.\\nAt first, this may seem to stand somewhat opposed to the larger goal of creating intelligent agents, however, we can use the demonstration of experts ― often humans ― to improve our agents by guiding them to a better solution.\"]}),\"\\n\",a(n.p,{children:[\"An important aspect of IRL is the recovery of the expert's reward function, which in many classical reinforcement-learning scenarios is often hand-designed.\\nThis also sets it apart from \",e(n.em,{children:\"behavioral cloning (BC)\"}),\", another category of methods under the larger \",e(n.em,{children:\"imitation learning (IL)\"}),\" umbrella \",a(n.span,{className:\"csl-ref\",id:\"citation--osaalgorithmicperspectiveimitation2018--1\",children:[\"[\",e(n.a,{href:\"#bib-osaalgorithmicperspectiveimitation2018\",children:\"see Osa et al. 2018\"}),\"]\"]}),\", which focuses on retrieving the expert's policy instead of the reward.\\nThe general idea is that by analyzing the actions taken by an expert, we can infer a better reward function than we could manually design.\"]}),\"\\n\",a(n.p,{children:[\"Maximum entropy (MaxEnt) inverse reinforcement learning \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmaximumentropyinverse2008--2\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmaximumentropyinverse2008\",children:\"Ziebart et al. 2008\"}),\"]\"]}),\" is a powerful and clever, yet fairly simple way to achieve this.\\nHaving discussed the “why”, let us now get to the “how”:\"]}),\"\\n\",e(n.h2,{id:\"a-more-mathematical-introduction\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#a-more-mathematical-introduction\",children:\"A More Mathematical Introduction\"})}),\"\\n\",a(n.p,{children:[\"While I assume some familiarity with the basics of reinforcement and inverse reinforcement learning, here's a short overview:\\nIn both settings, we describe our world using a Markov decision process (MDP).\\nAn MDP is a 5-tuple \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"S\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"A\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"T\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"R\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"γ\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"(S, A, T, R, \\\\gamma)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"A\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"T\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05556em\"},children:\"γ\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" with states \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"S\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"S\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"})]})})]}),\", actions \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"A\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"A\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"A\"})]})})]}),\", transition model \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"T\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"T(s_t, a_t, s_{t+1}) = p(s_{t+1} \\\\mid s_t, a_t)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"T\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\", reward function \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"R\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"∈\"}),e(n.mi,{mathvariant:\"double-struck\",children:\"R\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"R(s_t, a_t, s_{t+1}) \\\\in \\\\mathbb{R}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∈\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6889em\"}}),e(n.span,{className:\"mord mathbb\",children:\"R\"})]})]})]}),\", and reward discount factor \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"γ\"}),e(n.mo,{children:\"∈\"}),e(n.mo,{stretchy:\"false\",children:\"[\"}),e(n.mn,{children:\"0\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mn,{children:\"1\"}),e(n.mo,{stretchy:\"false\",children:\"]\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\gamma \\\\in [0, 1]\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.7335em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05556em\"},children:\"γ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∈\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mopen\",children:\"[\"}),e(n.span,{className:\"mord\",children:\"0\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord\",children:\"1\"}),e(n.span,{className:\"mclose\",children:\"]\"})]})]})]}),\", decreasing the reward over time (where \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{children:\"∈\"}),e(n.mi,{children:\"A\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"a_t \\\\in A\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6891em\",verticalAlign:\"-0.15em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∈\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"A\"})]})]})]}),\" and \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{children:\"∈\"}),e(n.mi,{children:\"S\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"s_t, s_{t+1} \\\\in S\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.7474em\",verticalAlign:\"-0.2083em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∈\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"})]})]})]}),\").\\nIn the inverse reinforcement learning setting, we will only use per-state rewards \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"R\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"s\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"∈\"}),e(n.mi,{mathvariant:\"double-struck\",children:\"R\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"R(s) \\\\in \\\\mathbb{R}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∈\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6889em\"}}),e(n.span,{className:\"mord mathbb\",children:\"R\"})]})]})]}),\".\\nThe key part of an MDP is that any action relies solely on the current state, meaning complete independence of all preceding history.\"]}),\"\\n\",a(n.p,{children:[\"The goal of reinforcement learning then is to find an optimal sequence of actions, i.e., a policy describing the optimal action per state, for an autonomous agent given a reward signal \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"R\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"R\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"})]})})]}),\".\\nThe reward signal provides feedback to the agent, affirming its behavior on actions that help further the goal of the task at hand, and punishing it on actions that are counter-productive to this goal.\\nPolicies come in two flavors: deterministic and stochastic.\\nDeterministic policies are defined as function \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"π\"}),e(n.mo,{children:\":\"}),e(n.mi,{children:\"S\"}),e(n.mo,{children:\"→\"}),e(n.mi,{children:\"A\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi: S \\\\to A\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\":\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"→\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"A\"})]})]})]}),\", whereas stochastic policies are defined as probability distributions over actions, i.e., \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"π\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"a\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"s\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi(a \\\\mid s)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\".\\nWhile in the usual RL setting the (or at least one) optimal policy is guaranteed to be deterministic, in inverse reinforcement learning (and not only there), it makes more sense to talk about stochastic policies.\"]}),\"\\n\",a(n.p,{children:[\"Inverse reinforcement learning, as discussed above and the name suggests, does the inverse of RL.\\nGiven a set of demonstrations \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"script\",children:\"D\"}),e(n.mo,{children:\"=\"}),e(n.mo,{stretchy:\"false\",children:\"{\"}),a(n.msub,{children:[e(n.mi,{children:\"τ\"}),e(n.mi,{children:\"i\"})]}),a(n.msubsup,{children:[e(n.mo,{stretchy:\"false\",children:\"}\"}),a(n.mrow,{children:[e(n.mi,{children:\"i\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"1\"})]}),e(n.mi,{children:\"n\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{D} = \\\\{\\\\tau_i\\\\}_{i=1}^{n}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0087em\",verticalAlign:\"-0.2587em\"}}),e(n.span,{className:\"mopen\",children:\"{\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1132em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),a(n.span,{className:\"mclose\",children:[e(n.span,{className:\"mclose\",children:\"}\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"0.6644em\"},children:[a(n.span,{style:{top:\"-2.4413em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"}),e(n.span,{className:\"mrel mtight\",children:\"=\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]}),a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"n\"})})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2587em\"},children:e(n.span,{})})})]})})]})]})]})]}),\" of an expert (agent), consisting of trajectories \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"=\"}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"(\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mn,{children:\"1\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mn,{children:\"1\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mn,{children:\"2\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mn,{children:\"2\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mo,{children:\"…\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"n\"}),e(n.mo,{children:\"−\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),a(n.mrow,{children:[e(n.mi,{children:\"n\"}),e(n.mo,{children:\"−\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"n\"})]}),e(n.mo,{fence:\"true\",children:\")\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau = \\\\left( (s_1, a_1), (s_2, a_2), \\\\ldots, (s_{n-1}, a_{n-1}), s_n \\\\right)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"(\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"1\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"1\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"minner\",children:\"…\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"n\"}),e(n.span,{className:\"mbin mtight\",children:\"−\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"n\"}),e(n.span,{className:\"mbin mtight\",children:\"−\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"n\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\")\"})]})]})]})]}),\" through the state-action space, IRL aims to recover the underlying reward function \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"R\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"R\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"})]})})]}),\", which explains the behavior of the expert.\"]}),\"\\n\",a(n.p,{children:[\"To allow for computation with states, we use so-called features.\\nFeatures are, in this case, defined as a function \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"ϕ\"}),e(n.mo,{children:\":\"}),e(n.mi,{children:\"S\"}),e(n.mo,{children:\"→\"}),a(n.msup,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"R\"}),e(n.mi,{children:\"d\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi: S \\\\to \\\\mathbb{R}^d\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\":\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"→\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.8491em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"R\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8491em\"},children:a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]})})})})})]})]})]})]}),\", mapping states to \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"d\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"d\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6944em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"d\"})]})})]}),\"-dimensional vectors, and can be arbitrarily chosen.\\nIn general, we assume that \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),a(n.msubsup,{children:[e(n.mo,{children:\"∑\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"1\"})]}),a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"∣\"}),e(n.mi,{children:\"τ\"}),e(n.mi,{mathvariant:\"normal\",children:\"∣\"})]})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi(\\\\tau) = \\\\sum_{t = 1}^{|\\\\tau|} \\\\phi(s_t)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.3276em\",verticalAlign:\"-0.2997em\"}}),a(n.span,{className:\"mop\",children:[e(n.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"∑\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.0279em\"},children:[a(n.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mrel mtight\",children:\"=\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]}),a(n.span,{style:{top:\"-3.2029em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mtight\",children:\"∣\"}),e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mord mtight\",children:\"∣\"})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2997em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" where \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"∣\"}),e(n.mi,{children:\"τ\"}),e(n.mi,{mathvariant:\"normal\",children:\"∣\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"|\\\\tau|\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord\",children:\"∣\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mord\",children:\"∣\"})]})})]}),\" denotes the length of the trajectories (visited states), i.e., that the features of a trajectory \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"τ\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"})]})})]}),\" are the sum of the features of the states visited by this trajectory, counting repetitions.\"]}),\"\\n\",e(n.h2,{id:\"the-principle-of-maximum-entropy\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#the-principle-of-maximum-entropy\",children:\"The Principle of Maximum Entropy\"})}),\"\\n\",a(n.p,{children:[\"The general idea of Maximum Entropy Inverse Reinforcement Learning is based on feature-expectation matching \",a(n.span,{className:\"csl-ref\",id:\"citation--abbeelapprenticeshiplearninginverse2004--3\",children:[\"[\",e(n.a,{href:\"#bib-abbeelapprenticeshiplearninginverse2004\",children:\"Abbeel and Ng 2004\"}),\"]\"]}),\":\\nThe expected visitation-frequency of features in the demonstrations provided by the expert should equal the expected visitation-frequency of features visited by the agent following the recovered reward function.\\nIn other words: The features describing the states of our world should be, in expectation, visited equally often by the agent following our recovered reward function and by the expert demonstrating (nearly) optimal behavior.\\nIn equations, we can express this as the expectation of features \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"ϕ\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"})]})})]}),\" over trajectories \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"τ\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"})]})})]}),\" derived from the reward we want to recover, and\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\"]\"}),e(n.mo,{children:\"=\"}),a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"E\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\"]\"}),e(n.mo,{separator:\"true\",children:\",\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    \\\\mathbb{E}_{\\\\pi^L}[\\\\phi(\\\\tau)] = \\\\mathbb{E}_{\\\\pi^E}[\\\\phi(\\\\tau)],\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")]\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")]\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]})]})}),\"\\n\",a(n.p,{children:[\"where the learner follows a policy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi^L\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.8413em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})]})})]}),\" directly implied by the reward.\\nThe expert follows an implicit policy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"E\"})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi^E\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.8413em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})]})})]}),\" that encodes its notion of reward and optimality.\"]}),\"\\n\",e(n.p,{children:\"Note that we can also express the expected feature visitation frequency as sum over trajectories\"}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\"]\"}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),e(n.mi,{children:\"τ\"})]}),a(n.msub,{children:[e(n.mi,{children:\"p\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    \\\\mathbb{E}_{\\\\pi^L}[\\\\phi(\\\\tau)] = \\\\sum_{\\\\tau} p_{\\\\pi^L}(\\\\tau) \\\\phi(\\\\tau)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")]\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"2.3em\",verticalAlign:\"-1.25em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.25em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]})}),\"\\n\",a(n.p,{children:[\"with the probability distribution \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"p\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p_{\\\\pi^L}(\\\\tau)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" of trajectories of the learner. Finding such a match, however, is not a well-posed problem in accordance to the definition by Hadamard: There is not the single one, but many possible solutions.\\nMultiple reward functions can achieve the same expected feature-visitation frequency \",a(n.span,{className:\"csl-ref\",id:\"citation--ngpolicyinvariancereward1999--abbeelapprenticeshiplearninginverse2004--ziebartmodelingpurposefuladaptive2010--4\",children:[\"[\",e(n.a,{href:\"#bib-ngpolicyinvariancereward1999\",children:\"Ng et al. 1999\"}),\"; \",e(n.a,{href:\"#bib-abbeelapprenticeshiplearninginverse2004\",children:\"Abbeel and Ng 2004\"}),\"; \",e(n.a,{href:\"#bib-ziebartmodelingpurposefuladaptive2010\",children:\"Ziebart 2010\"}),\"]\"]}),\".\\nTo resolve this ambiguity, Ziebart et al. \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmaximumentropyinverse2008--5\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmaximumentropyinverse2008\",children:\"Ziebart et al. 2008\"}),\"]\"]}),\" propose to choose the solution (i.e., the \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"p\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p_{\\\\pi^L}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6276em\",verticalAlign:\"-0.1971em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]})]})})]}),\") maximizing the entropy.\"]}),\"\\n\",a(n.p,{children:[\"But why should we maximize the entropy?\\nTo answer this, we have to understand what entropy represents.\\nFirstly, the entropy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"H\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"H(p)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" of some event probability distribution \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"p\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"})]})})]}),\" is defined as\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[a(n.mtr,{children:[e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mi,{children:\"H\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),e(n.mo,{children:\"−\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.mrow,{children:[e(n.mi,{children:\"x\"}),e(n.mo,{children:\"∈\"}),e(n.mi,{mathvariant:\"script\",children:\"X\"})]})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),a(n.msub,{children:[a(n.mrow,{children:[e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"})]}),e(n.mn,{children:\"2\"})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"})]})})})]}),a(n.mtr,{children:[e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:e(n.mrow,{})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.mrow,{children:[e(n.mi,{children:\"x\"}),e(n.mo,{children:\"∈\"}),e(n.mi,{mathvariant:\"script\",children:\"X\"})]})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"⋅\"}),a(n.msub,{children:[a(n.mrow,{children:[e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"})]}),e(n.mn,{children:\"2\"})]}),a(n.mfrac,{children:[e(n.mn,{children:\"1\"}),a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})]}),e(n.mo,{separator:\"true\",children:\",\"})]})})})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\begin{align*}\\n    H(p)\\n    \u0026= -\\\\sum_{x \\\\in \\\\mathcal{X}} p(x) \\\\log_2 p(x), \\\\\\\\\\n    \u0026= \\\\sum_{x \\\\in \\\\mathcal{X}} p(x) \\\\cdot \\\\log_2 \\\\frac{1}{p(x)},\\n\\\\end{align*}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"5.6149em\",verticalAlign:\"-2.5574em\"}}),e(n.span,{className:\"mord\",children:a(n.span,{className:\"mtable\",children:[e(n.span,{className:\"col-align-r\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"3.0574em\"},children:[a(n.span,{style:{top:\"-5.3289em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]}),a(n.span,{style:{top:\"-2.3857em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),e(n.span,{className:\"mord\"})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.5574em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"col-align-l\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"3.0574em\"},children:[a(n.span,{style:{top:\"-5.3289em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mord\",children:\"−\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.8557em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"x\"}),e(n.span,{className:\"mrel mtight\",children:\"∈\"}),e(n.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14643em\"},children:\"X\"})]})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.3217em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mop\",children:[a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.207em\"},children:a(n.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]}),a(n.span,{style:{top:\"-2.3857em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.8557em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"x\"}),e(n.span,{className:\"mrel mtight\",children:\"∈\"}),e(n.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14643em\"},children:\"X\"})]})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.3217em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),e(n.span,{className:\"mbin\",children:\"⋅\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),a(n.span,{className:\"mop\",children:[a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.207em\"},children:a(n.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mopen nulldelimiter\"}),e(n.span,{className:\"mfrac\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.3214em\"},children:[a(n.span,{style:{top:\"-2.314em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]}),a(n.span,{style:{top:\"-3.23em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),a(n.span,{style:{top:\"-3.677em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"1\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.936em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mclose nulldelimiter\"})]}),e(n.span,{className:\"mpunct\",children:\",\"})]})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.5574em\"},children:e(n.span,{})})})]})})]})})]})})]})}),\"\\n\",a(n.p,{children:[\"where \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"X\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"X\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"X\"})]})})]}),\" is the set containing all events \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"x\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"x\"})]})})]}),\" and \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(x)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" the probability of event \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"x\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"x\"})]})})]}),\" occurring.\"]}),\"\\n\",a(n.p,{children:[\"Let us now assume that we want to communicate the occurrence of all events \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"x\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"x\"})]})})]}),\" with some other party efficiently.\\nTo accomplish this, we wish to minimize the expected message length, so messages that will be sent frequently should be short, and messages that will seldom be sent are allowed to be long.\\nFollowing this trail of thought leads to the term \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"h\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),a(n.msub,{children:[a(n.mrow,{children:[e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"})]}),e(n.mn,{children:\"2\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mn,{children:\"1\"}),e(n.mi,{mathvariant:\"normal\",children:\"/\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"h(x) = \\\\log_2(1/p(x))\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"h\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mop\",children:[a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.207em\"},children:a(n.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord\",children:\"1/\"}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\"))\"})]})]})]}),\", which is the optimal number of bits that we should spend on the message representing event \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"x\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"x\"})]})})]}),\".\\nWith lower probability \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(x)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\", the term \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[a(n.mrow,{children:[e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"})]}),e(n.mn,{children:\"2\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mn,{children:\"1\"}),e(n.mi,{mathvariant:\"normal\",children:\"/\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\log_2(1/p(x))\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mop\",children:[a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.207em\"},children:a(n.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord\",children:\"1/\"}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\"))\"})]})})]}),\" increases.\\nIn fact, it increases logarithmically, as with more bits available, we can encode exponentially more events.\\nUsing this observation for the entropy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"H\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"H\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"})]})})]}),\" then yields nothing more than the entropy being the lower limit of the expected message length over all messages, i.e.:\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"H\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})]}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"[\"}),e(n.mi,{children:\"h\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{fence:\"true\",children:\"]\"})]}),e(n.mi,{mathvariant:\"normal\",children:\".\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    H(p)\\n    = \\\\mathbb{E}_{p(x)}\\\\left[h(x)\\\\right].\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.1052em\",verticalAlign:\"-0.3552em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5198em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"p\"}),e(n.span,{className:\"mopen mtight\",children:\"(\"}),e(n.span,{className:\"mord mathnormal mtight\",children:\"x\"}),e(n.span,{className:\"mclose mtight\",children:\")\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.3552em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"h\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\"]\"})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord\",children:\".\"})]})]})]})}),\"\\n\",e(n.p,{children:\"Summarizing all of this in a single sentence: Entropy is a measure of uncertainty.\"}),\"\\n\",e(t,{children:a(n.p,{children:[e(n.strong,{children:\"Note:\"}),\" This is, in fact, the underlying principle of Huffman coding, which, due to this relation, is guaranteed to be optimal.\"]})}),\"\\n\",a(n.p,{children:[\"As is done generally, we will now use the normal logarithm instead of the base-two one.\\nSince \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[a(n.mrow,{children:[e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"})]}),e(n.mn,{children:\"2\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"x\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mi,{mathvariant:\"normal\",children:\"/\"}),e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mn,{children:\"2\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\log_2(x) = \\\\log(x)/\\\\log(2)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mop\",children:[a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.207em\"},children:a(n.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"2\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"x\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mord\",children:\"/\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord\",children:\"2\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" holds, we are only dropping a constant factor of \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mn,{children:\"2\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\log(2)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord\",children:\"2\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" which does not impact extrema or our reasoning below, and simplifies further computations.\"]}),\"\\n\",a(n.p,{children:[\"With that in mind, let us ask again:\\nWhy should we maximize the entropy?\\nNow we can give a simple reasoning \",a(n.span,{className:\"csl-ref\",id:\"citation--jaynesinformationtheorystatistical1957--6\",children:[\"[\",e(n.a,{href:\"#bib-jaynesinformationtheorystatistical1957\",children:\"Jaynes 1957\"}),\"]\"]}),\":\\nLet us assume that we have two distributions, \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"p\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"})]})})]}),\" and \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"q\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"q\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"})]})})]}),\", with entropy values \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"H\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"\u003e\"}),e(n.mi,{children:\"H\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"q\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"H(p) \u003e H(q)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"\u003e\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\".\\nFrom our previous observations, we now know that to encode messages from \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"p\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"})]})})]}),\" we, in expectancy, need more bits than to encode messages from \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"q\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"q\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"})]})})]}),\".\\nThis is the key point because this in turn also means that we have less information about \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"p\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"})]})})]}),\" than about \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"q\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"q\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"})]})})]}),\".\\nIf we know more about a distribution, we require fewer bits to encode events from it.\\nIf we know everything, we do not need to send/encode anything, and if we know nothing, we need to send everything.\"]}),\"\\n\",a(n.p,{children:[\"But isn't it good if we know more? “The less entropy, the better, right?” you may ask.\\nNo.\\nNot for many optimization problems, or in general, when working with incomplete information:\\nConsider a problem, like feature-expectation matching, which has multiple solutions fulfilling our constraints.\\nThe only information which we give our solver for this problem is the feature-expectations we want to replicate.\\nAll solutions provided by our solver contain this information.\\nYet, they most certainly have different entropy values.\\nThis must mean that (at least) some solutions have additional information that we did not provide, i.e., they have a bias.\\nThis is illustrated in the figure below for our two distributions \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"p\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"})]})})]}),\" and \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"q\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"q\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"})]})})]}),\":\"]}),\"\\n\",e(n.p,{children:e(n.img,{src:\"/assets/blog/20220825-irl-maxent/maxent-principle.png\",alt:\"Illustration of the Maximum Entropy Principle\"})}),\"\\n\",e(n.p,{children:\"By choosing the solution with maximum entropy, we choose the solution with minimal information.\\nNote that all solutions already satisfy our constraints; thus we actually pick the solution that best fits our information with a minimal bias.\"}),\"\\n\",e(n.h2,{id:\"deriving-the-maximum-entropy-inverse-reinforcement-learning-algorithm\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#deriving-the-maximum-entropy-inverse-reinforcement-learning-algorithm\",children:\"Deriving the Maximum Entropy Inverse Reinforcement Learning Algorithm\"})}),\"\\n\",e(n.p,{children:\"Applying our findings from the previous section to feature-expectation matching directly results in a constrained optimization problem:\"}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mtable,{rowspacing:\"0.25em\",columnalign:\"right left right left\",columnspacing:\"0em\",children:[a(n.mtr,{children:[e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[a(n.munder,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"arg max\"}),e(n.mo,{children:\"⁡\"})]}),e(n.mi,{children:\"p\"})]}),e(n.mspace,{width:\"1em\"})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:e(n.mrow,{})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mi,{children:\"H\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})})})]}),a(n.mtr,{children:[e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mtext,{children:\"subject to\"}),e(n.mspace,{width:\"1em\"}),e(n.mrow,{})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:e(n.mrow,{})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\"]\"})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"E\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\"]\"}),e(n.mo,{separator:\"true\",children:\",\"})]})})}),e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{className:\"mml-eqn-num\"})]}),a(n.mtr,{children:[e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:e(n.mrow,{})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:e(n.mrow,{})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[a(n.munder,{children:[e(n.mo,{children:\"∑\"}),e(n.mi,{children:\"τ\"})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"1\"}),e(n.mo,{separator:\"true\",children:\",\"})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mspace,{width:\"1em\"}),e(n.mi,{mathvariant:\"normal\",children:\"∀\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\":\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"\u003e\"}),e(n.mn,{children:\"0\"}),e(n.mo,{separator:\"true\",children:\",\"})]})})}),e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{className:\"mml-eqn-num\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\begin{alignat*}{2}\\n    \\\\argmax_p\\\\quad\\n        \u0026\u0026 H(p) \\\\\\\\\\n    \\\\text{subject to}\\\\quad\\n        \\\\label{eq:feature-constraints}\\n        \u0026\u0026 \\\\mathbb{E}_{\\\\pi^L}[\\\\phi(\\\\tau)] \u0026= \\\\mathbb{E}_{\\\\pi^E}[\\\\phi(\\\\tau)],\\n            \\\\tag{1a} \\\\\\\\\\n        \\\\label{eq:probability-constraints}\\n        \u0026\u0026 \\\\sum_{\\\\tau} p(\\\\tau) = 1, \u0026\\\\quad \\\\forall \\\\tau : p(\\\\tau) \u003e 0,\\n            \\\\tag{1b}\\n\\\\end{alignat*}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"6.2706em\",verticalAlign:\"-2.8853em\"}}),a(n.span,{className:\"mtable\",children:[e(n.span,{className:\"col-align-r\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"3.3853em\"},children:[a(n.span,{style:{top:\"-5.5953em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"0.4306em\"},children:[a(n.span,{style:{top:\"-2.2056em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"p\"})})]}),a(n.span,{style:{top:\"-3em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{children:a(n.span,{className:\"mop\",children:[e(n.span,{className:\"mord mathrm\",style:{marginRight:\"0.01389em\"},children:\"arg\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathrm\",children:\"max\"})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.0305em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]})]}),a(n.span,{style:{top:\"-3.4247em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord text\",children:e(n.span,{className:\"mord\",children:\"subject to\"})}),e(n.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),e(n.span,{className:\"enclosing\",id:\"eq:feature-constraints\"})]})]}),a(n.span,{style:{top:\"-1.7147em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"enclosing\",id:\"eq:probability-constraints\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"col-align-l\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"3.3853em\"},children:[a(n.span,{style:{top:\"-5.5953em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\"})})]}),a(n.span,{style:{top:\"-3.4247em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\"})})]}),a(n.span,{style:{top:\"-1.7147em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"col-align-r\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"3.3853em\"},children:[a(n.span,{style:{top:\"-5.5953em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]}),a(n.span,{style:{top:\"-3.4247em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")]\"})]})]}),a(n.span,{style:{top:\"-1.7147em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.25em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mord\",children:\"1\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"col-align-l\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.2147em\"},children:[a(n.span,{style:{top:\"-3.4247em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")]\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]}),a(n.span,{style:{top:\"-1.7147em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),e(n.span,{className:\"mord\",children:\"∀\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\":\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"\u003e\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mord\",children:\"0\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:e(n.span,{})})})]})})]})]}),e(n.span,{className:\"tag\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"3.3853em\"},children:[a(n.span,{style:{top:\"-5.5953em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{})]}),a(n.span,{style:{top:\"-3.4247em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"1a\"})}),e(n.span,{className:\"mord\",children:\")\"})]})})]}),a(n.span,{style:{top:\"-1.7147em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"1b\"})}),e(n.span,{className:\"mord\",children:\")\"})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:e(n.span,{})})})]})})]})]})}),\"\\n\",a(n.p,{children:[\"where \",e(i,{label:\"eq:feature-constraints\",num:\"1a\"}),\" represents the feature-matching constraint and \",e(i,{label:\"eq:probability-constraints\",num:\"1b\"}),\" the probability constraints.\"]}),\"\\n\",a(n.p,{children:[\"This problem expresses that we want to find a probability distribution \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" over trajectories \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"τ\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"})]})})]}),\" with maximum entropy, under which the expected feature visitation frequencies of learner \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\"]\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbb{E}_{\\\\pi^L}[\\\\phi(\\\\tau)]\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")]\"})]})})]}),\" and expert \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"E\"})]})]}),e(n.mo,{stretchy:\"false\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{stretchy:\"false\",children:\"]\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbb{E}_{\\\\pi^E}[\\\\phi(\\\\tau)]\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")]\"})]})})]}),\" match (that \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi(\\\\tau)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" represents the features visited by trajectory \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"τ\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"})]})})]}),\").\\nNote that the policy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi^L\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.8413em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})]})})]}),\" of the learner depends on the probability distribution \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" with\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[e(n.mtable,{width:\"100%\",children:a(n.mtr,{children:[e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:a(n.mrow,{children:[e(n.mrow,{}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"a\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"s\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"∝\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.mrow,{children:[e(n.mi,{children:\"τ\"}),e(n.mo,{children:\":\"}),e(n.mtext,{children:\" \"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"s\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"a\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"∈\"}),a(n.msub,{children:[e(n.mi,{children:\"τ\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"0\"})]})]})]})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"})]})}),e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:e(n.mtext,{children:\"(2)\"})})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    \\\\label{eq:policy}\\n    \\\\pi^L(a \\\\mid s) \\\\propto \\\\sum_{\\\\tau :\\\\ (s, a) \\\\in \\\\tau_{t=0}} p(\\\\tau),\\n    \\\\tag{2}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.1413em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"enclosing\",id:\"eq:policy\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8913em\"},children:a(n.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∝\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"2.566em\",verticalAlign:\"-1.516em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.809em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mrel mtight\",children:\":\"}),e(n.span,{className:\"mspace mtight\",children:e(n.span,{className:\"mtight\",children:\" \"})}),e(n.span,{className:\"mopen mtight\",children:\"(\"}),e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"mclose mtight\",children:\")\"}),e(n.span,{className:\"mrel mtight\",children:\"∈\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"-0.1132em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mrel mtight\",children:\"=\"}),e(n.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})]})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.516em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"})]}),a(n.span,{className:\"tag\",children:[e(n.span,{className:\"strut\",style:{height:\"2.566em\",verticalAlign:\"-1.516em\"}}),a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"2\"})}),e(n.span,{className:\"mord\",children:\")\"})]})]})]})]})}),\"\\n\",a(n.p,{children:[\"i.e., the policy of the learner is proportional to the sum of the probabilities of all trajectories performing action \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"a\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"a\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"a\"})]})})]}),\" in the starting state \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"s\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"s\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"s\"})]})})]}),\".\"]}),\"\\n\",a(n.p,{children:[\"Now we have the probability distribution over trajectories, but how does this help us to recover the reward function \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"R\"}),e(n.mo,{children:\":\"}),e(n.mi,{children:\"S\"}),e(n.mo,{children:\"→\"}),e(n.mi,{mathvariant:\"double-struck\",children:\"R\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"R: S \\\\to \\\\mathbb{R}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\":\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"→\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6889em\"}}),e(n.span,{className:\"mord mathbb\",children:\"R\"})]})]})]}),\"?\\nFollowing the school of basic reinforcement learning provides us with the answer: The reward dictates the policy, which in turn dictates the trajectory distribution \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\".\\nA key assumption of Maximum Entropy IRL is that we know the behavior of our MDP, i.e., we have a perfect model representing the transition probabilities \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(s_{t+1} \\\\mid s_t, a_t)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\", so the only thing we actually need to learn is the reward.\\nEverything else either is derived from it or assumed known.\\nTo be able to learn the reward, we must parameterize it.\\nFor this, we assume linearity regarding features, i.e.,\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"R\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),a(n.msup,{children:[e(n.mi,{children:\"ω\"}),e(n.mi,{mathvariant:\"normal\",children:\"⊤\"})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    R(\\\\tau) = \\\\omega^\\\\top \\\\phi(\\\\tau),\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.1491em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:a(n.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"⊤\"})})]})})})})})]}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]})]})}),\"\\n\",a(n.p,{children:[\"with \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"ω\"}),e(n.mo,{children:\"∈\"}),a(n.msup,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"R\"}),e(n.mi,{children:\"d\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega \\\\in \\\\mathbb{R}^d\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∈\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.8491em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"R\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8491em\"},children:a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]})})})})})]})]})]})]}),\" being the reward parameter vector.\\nTo make the dependency on the reward parameters explicit, we write \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau \\\\mid \\\\omega)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" and \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"π\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"a\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"s\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi(a \\\\mid s, \\\\omega)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\".\"]}),\"\\n\",e(t,{children:a(n.p,{children:[e(n.strong,{children:\"Note:\"}),\" The choice of a linear parametrization is not by chance, but a direct result of the feature expectation matching constraint:\\nGiven an expert solving an MDP with unknown reward function linear in a set of known features, performing feature expectation matching with those features is guaranteed to yield a policy performing comparable to or better than the expert with respect to that reward \",a(n.span,{className:\"csl-ref\",id:\"citation--abbeelapprenticeshiplearninginverse2004--7\",children:[\"[\",e(n.a,{href:\"#bib-abbeelapprenticeshiplearninginverse2004\",children:\"Abbeel and Ng 2004\"}),\"]\"]}),\".\"]})}),\"\\n\",e(n.h3,{id:\"solution-and-partition-function\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#solution-and-partition-function\",children:\"Solution and Partition Function\"})}),\"\\n\",e(n.p,{children:\"Solving the above mathematical program for MDPs with deterministic transition dynamics (i.e., MDPs where all actions have predetermined deterministic outcomes) using the method of Lagrange multipliers leads to the observation that\"}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[a(n.mtr,{children:[e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"p\"}),e(n.mi,{children:\"d\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.mfrac,{children:[e(n.mn,{children:\"1\"}),a(n.mrow,{children:[e(n.mi,{children:\"Z\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})]}),e(n.mi,{children:\"exp\"}),e(n.mo,{children:\"⁡\"}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"(\"}),a(n.msup,{children:[e(n.mi,{children:\"ω\"}),e(n.mi,{mathvariant:\"normal\",children:\"⊤\"})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{fence:\"true\",children:\")\"})]}),e(n.mo,{separator:\"true\",children:\",\"})]})})})]}),a(n.mtr,{children:[e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mi,{children:\"Z\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),e(n.mi,{children:\"τ\"})]}),e(n.mi,{children:\"exp\"}),e(n.mo,{children:\"⁡\"}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"(\"}),a(n.msup,{children:[e(n.mi,{children:\"ω\"}),e(n.mi,{mathvariant:\"normal\",children:\"⊤\"})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{fence:\"true\",children:\")\"})]})]})})})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\begin{align*}\\n    p_d(\\\\tau \\\\mid \\\\omega) \u0026= \\\\frac{1}{Z(\\\\omega)} \\\\exp \\\\left( \\\\omega^\\\\top \\\\phi(\\\\tau) \\\\right), \\\\\\\\\\n    Z(\\\\omega) \u0026= \\\\sum_{\\\\tau} \\\\exp \\\\left( \\\\omega^\\\\top \\\\phi(\\\\tau) \\\\right)\\n\\\\end{align*}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"5.1575em\",verticalAlign:\"-2.3287em\"}}),e(n.span,{className:\"mord\",children:a(n.span,{className:\"mtable\",children:[e(n.span,{className:\"col-align-r\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"2.8287em\"},children:[a(n.span,{style:{top:\"-4.8287em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),a(n.span,{className:\"mord\",children:[a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]}),a(n.span,{style:{top:\"-2.5427em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.3287em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"col-align-l\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"2.8287em\"},children:[a(n.span,{style:{top:\"-4.8287em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mopen nulldelimiter\"}),e(n.span,{className:\"mfrac\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.3214em\"},children:[a(n.span,{style:{top:\"-2.314em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]}),a(n.span,{style:{top:\"-3.23em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),a(n.span,{style:{top:\"-3.677em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"1\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.936em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mclose nulldelimiter\"})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mop\",children:\"exp\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:e(n.span,{className:\"delimsizing size1\",children:\"(\"})}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:a(n.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"⊤\"})})]})})})})})]}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:e(n.span,{className:\"delimsizing size1\",children:\")\"})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mpunct\",children:\",\"})]})]}),a(n.span,{style:{top:\"-2.5427em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.25em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mop\",children:\"exp\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:e(n.span,{className:\"delimsizing size1\",children:\"(\"})}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:a(n.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"⊤\"})})]})})})})})]}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:e(n.span,{className:\"delimsizing size1\",children:\")\"})})]})]})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.3287em\"},children:e(n.span,{})})})]})})]})})]})})]})}),\"\\n\",a(n.p,{children:[\"with the so-called partition function \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"Z\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"Z(\\\\omega)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" simply normalizing the values to fulfill the probability distribution constraint \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmaximumentropyinverse2008--osaalgorithmicperspectiveimitation2018--8\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmaximumentropyinverse2008\",children:\"Ziebart et al. 2008\"}),\"; \",e(n.a,{href:\"#bib-osaalgorithmicperspectiveimitation2018\",children:\"Osa et al. 2018\"}),\"]\"]}),\".\\nBy choosing the reward to linearly depend on the features, we have also ensured that the Lagrange multipliers are precisely the reward parameters \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"ω\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"})]})})]}),\" \",a(n.span,{className:\"csl-ref\",id:\"citation--osaalgorithmicperspectiveimitation2018--9\",children:[\"[\",e(n.a,{href:\"#bib-osaalgorithmicperspectiveimitation2018\",children:\"Osa et al. 2018\"}),\"]\"]}),\".\\nFor MDPs with stochastic transitions, Ziebart et al. \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmaximumentropyinverse2008--10\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmaximumentropyinverse2008\",children:\"Ziebart et al. 2008\"}),\"]\"]}),\" propose to modify the deterministic solution, yielding the approximation\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[e(n.mtable,{width:\"100%\",children:a(n.mtr,{children:[e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:a(n.mrow,{children:[e(n.mrow,{}),a(n.msub,{children:[e(n.mi,{children:\"p\"}),e(n.mi,{children:\"s\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"≈\"}),a(n.mfrac,{children:[e(n.mn,{children:\"1\"}),a(n.mrow,{children:[e(n.mi,{children:\"Z\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})]}),e(n.mi,{children:\"exp\"}),e(n.mo,{children:\"⁡\"}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"(\"}),a(n.msup,{children:[e(n.mi,{children:\"ω\"}),e(n.mi,{mathvariant:\"normal\",children:\"⊤\"})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{fence:\"true\",children:\")\"})]}),a(n.munder,{children:[e(n.mo,{children:\"∏\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{children:\"∈\"}),e(n.mi,{children:\"τ\"})]})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mi,{mathvariant:\"normal\",children:\".\"})]})}),e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:e(n.mtext,{children:\"(3)\"})})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    \\\\label{eq:approx-probability}\\n    p_s(\\\\tau \\\\mid \\\\omega)\\n    \\\\approx\\n        \\\\frac{1}{Z(\\\\omega)} \\\\exp\\\\left( \\\\omega^\\\\top \\\\phi(\\\\tau) \\\\right)\\n        \\\\prod_{s_{t+1}, a_t, s_t \\\\in \\\\tau} p(s_{t+1} \\\\mid s_t, a_t).\\n    \\\\tag{3}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"enclosing\",id:\"eq:approx-probability\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"≈\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"2.7132em\",verticalAlign:\"-1.3918em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mopen nulldelimiter\"}),e(n.span,{className:\"mfrac\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.3214em\"},children:[a(n.span,{style:{top:\"-2.314em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]}),a(n.span,{style:{top:\"-3.23em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),a(n.span,{style:{top:\"-3.677em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"1\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.936em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mclose nulldelimiter\"})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mop\",children:\"exp\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:e(n.span,{className:\"delimsizing size1\",children:\"(\"})}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:a(n.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"⊤\"})})]})})})})})]}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:e(n.span,{className:\"delimsizing size1\",children:\")\"})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2025em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2963em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2963em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mrel mtight\",children:\"∈\"}),e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"})]})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∏\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.3918em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mord\",children:\".\"})]}),a(n.span,{className:\"tag\",children:[e(n.span,{className:\"strut\",style:{height:\"2.7132em\",verticalAlign:\"-1.3918em\"}}),a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"3\"})}),e(n.span,{className:\"mord\",children:\")\"})]})]})]})]})}),\"\\n\",e(t,{children:a(n.p,{children:[e(n.strong,{children:\"Note:\"}),\" We are simply multiplying the deterministic solution with combined transition probability of the trajectory.\\nAs a result of said modification, however, we introduce a bias to the reward function \",a(n.span,{className:\"csl-ref\",id:\"citation--osaalgorithmicperspectiveimitation2018--11\",children:[\"[\",e(n.a,{href:\"#bib-osaalgorithmicperspectiveimitation2018\",children:\"Osa et al. 2018\"}),\"]\"]}),\".\\nTo avoid this, Ziebart \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmodelingpurposefuladaptive2010--12\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmodelingpurposefuladaptive2010\",children:\"Ziebart 2010\"}),\"]\"]}),\" proposes the Maximum Causal Entropy IRL method in his thesis \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartprinciplemaximumcausal2013--13\",children:[\"[\",e(n.a,{href:\"#bib-ziebartprinciplemaximumcausal2013\",children:\"see also Ziebart et al. 2013\"}),\"]\"]}),\".\\nIn the scope of this post, we'll stick to the normal (non-causal) entropy.\"]})}),\"\\n\",e(n.h3,{id:\"optimization\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#optimization\",children:\"Optimization\"})}),\"\\n\",a(n.p,{children:[\"We now know the parameterized form of the distribution, so how can we optimize the parameters?\\nThe answer is fairly straightforward: We can maximize the log-likelihood over all demonstrated trajectories \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"script\",children:\"D\"}),e(n.mo,{children:\"=\"}),e(n.mo,{stretchy:\"false\",children:\"{\"}),a(n.msub,{children:[e(n.mi,{children:\"τ\"}),e(n.mi,{children:\"i\"})]}),a(n.msubsup,{children:[e(n.mo,{stretchy:\"false\",children:\"}\"}),a(n.mrow,{children:[e(n.mi,{children:\"i\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"1\"})]}),e(n.mi,{children:\"N\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{D} = \\\\{\\\\tau_i\\\\}_{i=1}^{N}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.1em\",verticalAlign:\"-0.2587em\"}}),e(n.span,{className:\"mopen\",children:\"{\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1132em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),a(n.span,{className:\"mclose\",children:[e(n.span,{className:\"mclose\",children:\"}\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:[a(n.span,{style:{top:\"-2.4413em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"}),e(n.span,{className:\"mrel mtight\",children:\"=\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]}),a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"})})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2587em\"},children:e(n.span,{})})})]})})]})]})]})]}),\", i.e.,\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[e(n.mtable,{width:\"100%\",children:a(n.mtr,{children:[e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:a(n.mrow,{children:[e(n.mrow,{}),a(n.msup,{children:[e(n.mi,{children:\"ω\"}),e(n.mo,{children:\"∗\"})]}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"arg max\"}),e(n.mo,{children:\"⁡\"})]}),e(n.mi,{children:\"ω\"})]}),e(n.mi,{mathvariant:\"script\",children:\"L\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"arg max\"}),e(n.mo,{children:\"⁡\"})]}),e(n.mi,{children:\"ω\"})]}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.mrow,{children:[e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∈\"}),e(n.mi,{mathvariant:\"script\",children:\"D\"})]})]}),e(n.mi,{children:\"log\"}),e(n.mo,{children:\"⁡\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"})]})}),e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:e(n.mtext,{children:\"(4)\"})})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    \\\\label{eq:loglikelihood}\\n    \\\\omega^* = \\\\argmax_{\\\\omega} \\\\mathcal{L}(\\\\omega)\\n    = \\\\argmax_{\\\\omega} \\\\sum_{\\\\tau \\\\in \\\\mathcal{D}} \\\\log p(\\\\tau \\\\mid \\\\omega),\\n    \\\\tag{4}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.7387em\"}}),e(n.span,{className:\"enclosing\",id:\"eq:loglikelihood\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7387em\"},children:a(n.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mbin mtight\",children:\"∗\"})})]})})})})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.6444em\",verticalAlign:\"-0.8944em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"0.4306em\"},children:[a(n.span,{style:{top:\"-2.2056em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"ω\"})})})]}),a(n.span,{style:{top:\"-3em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{children:a(n.span,{className:\"mop\",children:[e(n.span,{className:\"mord mathrm\",style:{marginRight:\"0.01389em\"},children:\"arg\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathrm\",children:\"max\"})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8944em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathcal\",children:\"L\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"2.3717em\",verticalAlign:\"-1.3217em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"0.4306em\"},children:[a(n.span,{style:{top:\"-2.2056em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"ω\"})})})]}),a(n.span,{style:{top:\"-3em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{children:a(n.span,{className:\"mop\",children:[e(n.span,{className:\"mord mathrm\",style:{marginRight:\"0.01389em\"},children:\"arg\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathrm\",children:\"max\"})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8944em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.8557em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mrel mtight\",children:\"∈\"}),e(n.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.02778em\"},children:\"D\"})]})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.3217em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mop\",children:[\"lo\",e(n.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"})]}),a(n.span,{className:\"tag\",children:[e(n.span,{className:\"strut\",style:{height:\"2.3717em\",verticalAlign:\"-1.3217em\"}}),a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"4\"})}),e(n.span,{className:\"mord\",children:\")\"})]})]})]})]})}),\"\\n\",a(n.p,{children:[\"using gradient ascent (or any other gradient-based optimization technique) as this function is convex \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmaximumentropyinverse2008--osaalgorithmicperspectiveimitation2018--14\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmaximumentropyinverse2008\",children:\"Ziebart et al. 2008\"}),\"; \",e(n.a,{href:\"#bib-osaalgorithmicperspectiveimitation2018\",children:\"Osa et al. 2018\"}),\"]\"]}),\".\"]}),\"\\n\",a(t,{children:[a(n.p,{children:[e(n.strong,{children:\"Note:\"}),\" Maximizing the log-likelihood is equivalent to minimizing the Kullback-Leibler divergence \",a(n.span,{className:\"csl-ref\",id:\"citation--bishoppatternrecognitionmachine2006--15\",children:[\"[\",e(n.a,{href:\"#bib-bishoppatternrecognitionmachine2006\",children:\"Bishop 2006\"}),\"]\"]})]}),e(m,{math:\"D_{KL}\\\\big(p^E(\\\\tau) \\\\,\\\\|\\\\, p(\\\\tau \\\\mid \\\\omega)\\\\big).\"}),a(n.p,{children:[\"It can therefore also be interpreted as the M-projection onto the manifold of the maximum entropy distribution \",a(n.span,{className:\"csl-ref\",id:\"citation--osaalgorithmicperspectiveimitation2018--16\",children:[\"[\",e(n.a,{href:\"#bib-osaalgorithmicperspectiveimitation2018\",children:\"see e.g., Osa et al. 2018\"}),\"]\"]}),\".\"]})]}),\"\\n\",a(n.p,{children:[\"The (averaged) gradient is then simply the difference between expected empirical feature counts \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"E\"})]})]}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{fence:\"true\",children:\"]\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbb{E}_{\\\\pi^E} \\\\left[ \\\\phi(\\\\tau) \\\\right]\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\"]\"})]})]})})]}),\" and the learner's expected feature counts (derived from the trajectory probabilities \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau \\\\mid \\\\omega)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\"), shown in \",e(i,{label:\"eq:grad-a\",num:\"5a\"}),\", i.e.:\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[a(n.mtr,{children:[e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),a(n.msub,{children:[e(n.mi,{mathvariant:\"normal\",children:\"∇\"}),e(n.mi,{children:\"ω\"})]}),e(n.mi,{mathvariant:\"script\",children:\"L\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"E\"})]})]}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{fence:\"true\",children:\"]\"})]}),e(n.mo,{children:\"−\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),e(n.mi,{children:\"τ\"})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mtext,{children:\" \"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"})]})})}),e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{className:\"mml-eqn-num\"})]}),a(n.mtr,{children:[e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:e(n.mrow,{})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.msub,{children:[e(n.mi,{mathvariant:\"double-struck\",children:\"E\"}),a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"E\"})]})]}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"[\"}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{fence:\"true\",children:\"]\"})]}),e(n.mo,{children:\"−\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]}),a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"})]})})}),e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{className:\"mml-eqn-num\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\begin{align*}\\n    \\\\label{eq:grad-a}\\n    \\\\nabla_\\\\omega \\\\mathcal{L}(\\\\omega)\\n    \u0026= \\\\mathbb{E}_{\\\\pi^E} \\\\left[ \\\\phi(\\\\tau) \\\\right] - \\\\sum_{\\\\tau} p(\\\\tau \\\\mid \\\\omega)\\\\ \\\\phi(\\\\tau),\\n        \\\\tag{5a}\\\\\\\\\\n    \\\\label{eq:grad-b}\\n    \u0026= \\\\mathbb{E}_{\\\\pi^E} \\\\left[ \\\\phi(\\\\tau) \\\\right] - \\\\sum_{s_i} D_{s_i} \\\\phi(s_i),\\n        \\\\tag{5b}\\\\\\\\\\n\\\\end{align*}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"5.3001em\",verticalAlign:\"-2.4001em\"}}),a(n.span,{className:\"mtable\",children:[e(n.span,{className:\"col-align-r\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"2.9001em\"},children:[a(n.span,{style:{top:\"-4.9001em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"enclosing\",id:\"eq:grad-a\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\",children:\"∇\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"ω\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mord mathcal\",children:\"L\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]}),a(n.span,{style:{top:\"-2.3em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"enclosing\",id:\"eq:grad-b\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.4001em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"col-align-l\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"2.9001em\"},children:[a(n.span,{style:{top:\"-4.9001em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\"]\"})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),e(n.span,{className:\"mbin\",children:\"−\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.25em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",children:\" \"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]}),a(n.span,{style:{top:\"-2.3em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathbb\",children:\"E\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:a(n.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"[\"}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\"]\"})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),e(n.span,{className:\"mbin\",children:\"−\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.3501em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.4001em\"},children:e(n.span,{})})})]})})]})]}),e(n.span,{className:\"tag\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"2.9001em\"},children:[a(n.span,{style:{top:\"-4.9001em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"5a\"})}),e(n.span,{className:\"mord\",children:\")\"})]})})]}),a(n.span,{style:{top:\"-2.3em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"5b\"})}),e(n.span,{className:\"mord\",children:\")\"})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"2.4001em\"},children:e(n.span,{})})})]})})]})]})}),\"\\n\",a(n.p,{children:[\"which we can express in terms of the state-visitation frequency \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]})]})})]}),\" with \",e(i,{label:\"eq:grad-b\",num:\"5b\"}),\", assuming \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),a(n.msubsup,{children:[e(n.mo,{children:\"∑\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"0\"})]}),a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"∣\"}),e(n.mi,{children:\"τ\"}),e(n.mi,{mathvariant:\"normal\",children:\"∣\"})]})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi(\\\\tau) = \\\\sum_{t = 0}^{|\\\\tau|} \\\\phi(s_t)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.3276em\",verticalAlign:\"-0.2997em\"}}),a(n.span,{className:\"mop\",children:[e(n.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"∑\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.0279em\"},children:[a(n.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mrel mtight\",children:\"=\"}),e(n.span,{className:\"mord mtight\",children:\"0\"})]})})]}),a(n.span,{style:{top:\"-3.2029em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mtight\",children:\"∣\"}),e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mord mtight\",children:\"∣\"})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2997em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmaximumentropyinverse2008--17\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmaximumentropyinverse2008\",children:\"Ziebart et al. 2008\"}),\"]\"]}),\".\"]}),\"\\n\",a(t,{children:[a(n.p,{children:[e(n.strong,{children:\"Note:\"}),\" The realization that we can transform \",e(i,{label:\"eq:grad-a\",num:\"5a\"}),\" to \",e(i,{label:\"eq:grad-b\",num:\"5b\"}),\", i.e., represent the expected feature count of the learner via the state-visitation frequency \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]})]})})]}),\", is actually one of the most important steps!\"]}),a(n.p,{children:[e(i,{label:\"eq:grad-a\",num:\"5a\"}),\" is generally infeasible (or at the very least quite costly) to compute, as enumerating all trajectories is usually subject to combinatorial explosion (think, for example, of trajectories in a “simple” grid world).\\nComputing the state visitation frequencies, as we will see below, however, is quite feasible (within some restrictions).\"]})]}),\"\\n\",e(t,{children:a(n.p,{children:[e(n.strong,{children:\"Note:\"}),\" Due to the log-likelihood, this gradient holds for both deterministic and stochastic transition dynamics.\"]})}),\"\\n\",e(n.h3,{id:\"computing-the-state-visitation-frequency\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#computing-the-state-visitation-frequency\",children:\"Computing the State-Visitation Frequency\"})}),\"\\n\",a(n.p,{children:[\"Now, we have only one remaining question:\\nHow do we compute the state-visitation frequency \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]})]})})]}),\"?\\nFollowing good computer-science fashion, we divide and conquer:\\nFirst, we compute a (stochastic) policy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"π\"}),e(n.mtext,{children:\"ME\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"a\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"s\"}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}}(a \\\\mid s, \\\\omega)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord text mtight\",children:e(n.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\", referred to as the local action probability, with a backward pass.\\nThereafter, we compute the state-visitation frequency under this policy with a simple forward pass.\"]}),\"\\n\",e(n.h4,{id:\"backward-pass-computing-the-local-action-policy\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#backward-pass-computing-the-local-action-policy\",children:\"Backward Pass: Computing the Local Action Policy\"})}),\"\\n\",a(n.p,{children:[\"The basic idea of the first pass is to remember our earlier observation about the learner policy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msup,{children:[e(n.mi,{children:\"π\"}),e(n.mi,{children:\"L\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"a\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"s\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi^L(a \\\\mid s)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0913em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" made in \",e(i,{label:\"eq:policy\",num:\"2\"}),\", i.e.,\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"π\"}),e(n.mtext,{children:\"ME\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"∝\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.mrow,{children:[e(n.mi,{children:\"τ\"}),e(n.mo,{children:\":\"}),e(n.mtext,{children:\" \"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"∈\"}),a(n.msub,{children:[e(n.mi,{children:\"τ\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"0\"})]})]})]})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    \\\\pi_{\\\\text{ME}}(a_j \\\\mid s_i, \\\\omega) \\\\propto \\\\sum_{\\\\tau :\\\\ (s_i, a_j) \\\\in \\\\tau_{t=0}} p(\\\\tau \\\\mid \\\\omega),\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord text mtight\",children:e(n.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∝\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"2.5883em\",verticalAlign:\"-1.5383em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.809em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mrel mtight\",children:\":\"}),e(n.span,{className:\"mspace mtight\",children:e(n.span,{className:\"mtight\",children:\" \"})}),e(n.span,{className:\"mopen mtight\",children:\"(\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose mtight\",children:\")\"}),e(n.span,{className:\"mrel mtight\",children:\"∈\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"-0.1132em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mrel mtight\",children:\"=\"}),e(n.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})]})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.5383em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"})]})]})]})}),\"\\n\",a(n.p,{children:[\"and then recursively expand this using the solution we derived for our trajectory distribution \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\"∣\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau \\\\mid \\\\omega)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" presented in \",e(i,{label:\"eq:approx-probability\",num:\"3\"}),\" until we are not reasoning about full or partial trajectories any longer, but the individual state transitions.\\nThis then yields the set of equations \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmaximumentropyinverse2008--18\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmaximumentropyinverse2008\",children:\"Ziebart et al. 2008\"}),\"]\"]}),\":\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[a(n.mtr,{children:[e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),a(n.msub,{children:[e(n.mi,{children:\"π\"}),e(n.mtext,{children:\"ME\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.mfrac,{children:[a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]})]})]}),a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"j\"})]})]})]}),e(n.mo,{separator:\"true\",children:\",\"})]})})}),e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{className:\"mml-eqn-num\"})]}),a(n.mtr,{children:[e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]})]})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),e(n.mi,{children:\"k\"})]}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"k\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mtext,{children:\" \"}),e(n.mi,{children:\"exp\"}),e(n.mo,{children:\"⁡\"}),a(n.mrow,{children:[e(n.mo,{fence:\"true\",children:\"(\"}),a(n.msup,{children:[e(n.mi,{children:\"ω\"}),e(n.mi,{mathvariant:\"normal\",children:\"⊤\"})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{fence:\"true\",children:\")\"})]}),e(n.mtext,{children:\" \"}),a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"k\"})]})]}),e(n.mo,{separator:\"true\",children:\",\"})]})})}),e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{className:\"mml-eqn-num\"})]}),a(n.mtr,{children:[e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]})})}),e(n.mtd,{children:e(n.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:a(n.mrow,{children:[e(n.mrow,{}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]})]}),a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]})]})]}),e(n.mi,{mathvariant:\"normal\",children:\".\"})]})})}),e(n.mtd,{className:\"mtr-glue\"}),e(n.mtd,{className:\"mml-eqn-num\"})]})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\begin{align*}\\n    \\\\label{eq:bwpass}\\n    \\\\pi_{\\\\text{ME}}(a_j \\\\mid s_i, \\\\omega) \u0026= \\\\frac{Z_{s_i, a_j}}{Z_{s_j}},\\n        \\\\tag{6a} \\\\\\\\\\n    Z_{s_i, a_j} \u0026= \\\\sum_{k} p(s_k \\\\mid s_i, a_j)\\\\, \\\\exp \\\\left(\\\\omega^\\\\top \\\\phi(s_i)\\\\right)\\\\, Z_{s_k},\\n        \\\\tag{6b} \\\\\\\\\\n    Z_{s_i} \u0026= \\\\sum_{a_j} Z_{s_i, a_j}.\\n        \\\\tag{6c}\\n\\\\end{align*}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"8.2034em\",verticalAlign:\"-3.8517em\"}}),a(n.span,{className:\"mtable\",children:[e(n.span,{className:\"col-align-r\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"4.3517em\"},children:[a(n.span,{style:{top:\"-6.3517em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"enclosing\",id:\"eq:bwpass\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord text mtight\",children:e(n.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]}),a(n.span,{style:{top:\"-3.9684em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),e(n.span,{className:\"mord\",children:a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:e(n.span,{})})})]})})]})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:e(n.span,{})})})]})})]})})]}),a(n.span,{style:{top:\"-1.3163em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),e(n.span,{className:\"mord\",children:a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"3.8517em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"col-align-l\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"4.3517em\"},children:[a(n.span,{style:{top:\"-6.3517em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mopen nulldelimiter\"}),e(n.span,{className:\"mfrac\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.4207em\"},children:[a(n.span,{style:{top:\"-2.314em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"mord\",children:a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:e(n.span,{})})})]})})]})})]}),a(n.span,{style:{top:\"-3.23em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),a(n.span,{style:{top:\"-3.7373em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3em\"}}),e(n.span,{className:\"mord\",children:a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:e(n.span,{})})})]})})]})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:e(n.span,{})})})]})})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.0333em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mclose nulldelimiter\"})]}),e(n.span,{className:\"mpunct\",children:\",\"})]})]}),a(n.span,{style:{top:\"-3.9684em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.8479em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.3021em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mop\",children:\"exp\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"minner\",children:[e(n.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:e(n.span,{className:\"delimsizing size1\",children:\"(\"})}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:a(n.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"⊤\"})})]})})})})})]}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:e(n.span,{className:\"delimsizing size1\",children:\")\"})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.3488em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1512em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2559em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"})]})]}),a(n.span,{style:{top:\"-1.3163em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:e(n.span,{})})})]})})]})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.4473em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:e(n.span,{})})})]})})]})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mord\",children:\".\"})]})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"3.8517em\"},children:e(n.span,{})})})]})})]})]}),e(n.span,{className:\"tag\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"4.3517em\"},children:[a(n.span,{style:{top:\"-6.3517em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),e(n.span,{children:a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"6a\"})}),e(n.span,{className:\"mord\",children:\")\"})]})})]}),a(n.span,{style:{top:\"-3.9684em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),e(n.span,{children:a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"6b\"})}),e(n.span,{className:\"mord\",children:\")\"})]})})]}),a(n.span,{style:{top:\"-1.3163em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),e(n.span,{children:a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"6c\"})}),e(n.span,{className:\"mord\",children:\")\"})]})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"3.8517em\"},children:e(n.span,{})})})]})})]})]})}),\"\\n\",a(n.p,{children:[\"Here, \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]})]})})]}),\" represents the state-partition-function, again normalizing the probabilities, and \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"i\"})]})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i, a_i}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]})]})})]}),\" is referred to as the state-action partition function.\\nSetting the state-partition function \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"1\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i} = 1\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6444em\"}}),e(n.span,{className:\"mord\",children:\"1\"})]})]})]}),\" for terminal states and then recursively backing up, using the equations for \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]})]})})]}),\" and \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"Z\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i, a_j}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0307em\",verticalAlign:\"-0.3473em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:e(n.span,{})})})]})})]})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:e(n.span,{})})})]})})]})]})})]}),\", from those states yields a set of values that we can then use to compute the local action probabilities following the above equation.\"]}),\"\\n\",a(t,{children:[a(n.p,{children:[e(n.strong,{children:\"Note:\"}),\" This backup-pass somewhat resembles a value-iteration scheme to solve an MDP.\\nIt also turns out that this backup part of the algorithm is the only thing that differs between Maximum Entropy and Maximum Causal Entropy IRL.\"]}),a(n.p,{children:[\"In fact, for the Maximum Causal Entropy approach, one can show that the partition functions are an analogy of the Bellman equation — the so-called soft Bellman equation — which allows for a straightforward extension of the value-iteration algorithm to this problem \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmodelingpurposefuladaptive2010--ziebartprinciplemaximumcausal2013--19\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmodelingpurposefuladaptive2010\",children:\"Ziebart 2010\"}),\"; \",e(n.a,{href:\"#bib-ziebartprinciplemaximumcausal2013\",children:\"Ziebart et al. 2013\"}),\"]\"]}),\".\"]})]}),\"\\n\",e(n.h4,{id:\"forward-pass-inferring-state-visitation-frequency-from-pi_textme\",children:a(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#forward-pass-inferring-state-visitation-frequency-from-pi_textme\",children:[\"Forward Pass: Inferring State-Visitation Frequency from \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"π\"}),e(n.mtext,{children:\"ME\"})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord text mtight\",children:e(n.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]})]})})]})]})}),\"\\n\",a(n.p,{children:[\"As we now know the policy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"π\"}),e(n.mtext,{children:\"ME\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}}(a_j \\\\mid s_i, \\\\omega)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord text mtight\",children:e(n.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\", inferring the state-visitation frequency \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]})]})})]}),\" becomes fairly easy:\\nRemember that the policy is a probability distribution that tells us, given a state \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"s_i\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]})]})})]}),\", with which probability the agent should take a certain action \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"a_j\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]})]})})]}),\", which then leads to a new state \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"k\"})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"s_k\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]})]})})]}),\" according to our MDP transition model.\\nGiven an initial state-visitation frequency, we can therefore use the policy to forward-propagate the individual visitation counts, obtaining an updated state-visitation frequency map.\"]}),\"\\n\",a(n.p,{children:[\"To this end, we initialize \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mn,{children:\"0\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i, 0}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),e(n.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]})]})})]}),\" to the starting-state probabilities \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"p\"}),e(n.mn,{children:\"0\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p_0(s_i)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"0\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" at timestep \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"0\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"t=0\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6151em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"t\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6444em\"}}),e(n.span,{className:\"mord\",children:\"0\"})]})]})]}),\", i.e.,\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[e(n.mtable,{width:\"100%\",children:a(n.mtr,{children:[e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:a(n.mrow,{children:[e(n.mrow,{}),a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mn,{children:\"0\"})]})]}),e(n.mo,{children:\"=\"}),a(n.msub,{children:[e(n.mi,{children:\"p\"}),e(n.mn,{children:\"0\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"τ\"}),e(n.mo,{children:\":\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{children:\"∈\"}),a(n.msub,{children:[e(n.mi,{children:\"τ\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"=\"}),e(n.mn,{children:\"0\"})]})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mi,{mathvariant:\"normal\",children:\".\"})]})}),e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:e(n.mtext,{children:\"(7a)\"})})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    \\\\label{eq:fwpass}\\n    D_{s_i, 0} = p_0(s_i) = p(\\\\tau : s_i \\\\in \\\\tau_{t=0}).\\n    \\\\tag{7a}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),e(n.span,{className:\"enclosing\",id:\"eq:fwpass\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),e(n.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:\"0\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\":\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6891em\",verticalAlign:\"-0.15em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∈\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"τ\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1132em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mrel mtight\",children:\"=\"}),e(n.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mord\",children:\".\"})]}),a(n.span,{className:\"tag\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"7a\"})}),e(n.span,{className:\"mord\",children:\")\"})]})]})]})]})}),\"\\n\",e(n.p,{children:\"We then compute updates as mentioned above via\"}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[e(n.mtable,{width:\"100%\",children:a(n.mtr,{children:[e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"k\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]})]}),a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"t\"})]})]}),e(n.mo,{children:\"⋅\"}),a(n.msub,{children:[e(n.mi,{children:\"π\"}),e(n.mtext,{children:\"ME\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"⋅\"}),e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"k\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{separator:\"true\",children:\",\"})]})}),e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:e(n.mtext,{children:\"(7b)\"})})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    D_{s_k, t+1} = \\\\sum_{s_i} \\\\sum_{a_j} D_{s_i, t}\\n        \\\\cdot \\\\pi_{\\\\text{ME}} (a_j \\\\mid s_i, \\\\omega)\\n        \\\\cdot p(s_k \\\\mid s_i, a_j),\\n    \\\\tag{7b}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:a(n.span,{style:{top:\"-2.3488em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.1512em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"2.4973em\",verticalAlign:\"-1.4473em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.3501em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:e(n.span,{})})})]})})]})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.4473em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),e(n.span,{className:\"mbin\",children:\"⋅\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord text mtight\",children:e(n.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),e(n.span,{className:\"mbin\",children:\"⋅\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mpunct\",children:\",\"})]}),a(n.span,{className:\"tag\",children:[e(n.span,{className:\"strut\",style:{height:\"2.4973em\",verticalAlign:\"-1.4473em\"}}),a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"7b\"})}),e(n.span,{className:\"mord\",children:\")\"})]})]})]})]})}),\"\\n\",a(n.p,{children:[\"where \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"k\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(s_k \\\\mid a_j, s_i)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" represents the transition probabilities of our (stochastic) MDP.\\nNote, that \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"t\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i, t}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]})]})})]}),\" only gives us the state-visitation frequency for time-step \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"t\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"t\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6151em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"t\"})]})})]}),\", meaning we have to sum them up to obtain the time-step independent state-visitation\"]}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[e(n.mtable,{width:\"100%\",children:a(n.mtr,{children:[e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]}),e(n.mo,{children:\"=\"}),a(n.munder,{children:[e(n.mo,{children:\"∑\"}),e(n.mi,{children:\"t\"})]}),a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"t\"})]})]}),e(n.mi,{mathvariant:\"normal\",children:\".\"})]})}),e(n.mtd,{width:\"50%\"}),e(n.mtd,{children:e(n.mtext,{children:\"(7c)\"})})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"    D_{s_i} = \\\\sum_{t} D_{s_i, t}.\\n    \\\\tag{7c}\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"2.3em\",verticalAlign:\"-1.25em\"}}),e(n.span,{className:\"mop op-limits\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[a(n.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[a(n.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})})]}),a(n.span,{style:{top:\"-3.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),e(n.span,{children:e(n.span,{className:\"mop op-symbol large-op\",children:\"∑\"})})]})]}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"1.25em\"},children:e(n.span,{})})})]})}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct mtight\",children:\",\"}),e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mord\",children:\".\"})]}),a(n.span,{className:\"tag\",children:[e(n.span,{className:\"strut\",style:{height:\"2.3em\",verticalAlign:\"-1.25em\"}}),a(n.span,{className:\"mord text\",children:[e(n.span,{className:\"mord\",children:\"(\"}),e(n.span,{className:\"mord\",children:e(n.span,{className:\"mord\",children:\"7c\"})}),e(n.span,{className:\"mord\",children:\")\"})]})]})]})]})}),\"\\n\",e(n.h2,{id:\"the-algorithm\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#the-algorithm\",children:\"The Algorithm\"})}),\"\\n\",e(n.p,{children:\"With a plan for computation of the state-visitation frequency, we now have everything we need to state the full algorithm.\\nTo derive that, however, let us first recap our findings:\"}),\"\\n\",a(n.ul,{children:[\"\\n\",a(n.li,{children:[\"\\n\",a(n.p,{children:[\"Our problem is a constrained optimization problem for finding the optimal reward parameters \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"ω\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"})]})})]}),\".\\nWe can solve this problem by maximizing the log-likelihood over all demonstrated trajectories \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{mathvariant:\"script\",children:\"D\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{D}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6833em\"}}),e(n.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"D\"})]})})]}),\" (see \",e(i,{label:\"eq:loglikelihood\",num:\"4\"}),\").\\nThis, in turn, is itself an optimization problem, for which we need the gradient \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"∇\"}),e(n.mi,{mathvariant:\"script\",children:\"L\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\nabla \\\\mathcal{L}(\\\\omega)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord\",children:\"∇\"}),e(n.span,{className:\"mord mathcal\",children:\"L\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" of this log-likelihood.\"]}),\"\\n\"]}),\"\\n\",a(n.li,{children:[\"\\n\",a(n.p,{children:[\"To compute the gradient \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"∇\"}),e(n.mi,{mathvariant:\"script\",children:\"L\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\nabla \\\\mathcal{L}(\\\\omega)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord\",children:\"∇\"}),e(n.span,{className:\"mord mathcal\",children:\"L\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\", we require the state-visitation frequency (see \",e(i,{label:\"eq:grad-b\",num:\"5b\"}),\").\"]}),\"\\n\"]}),\"\\n\",a(n.li,{children:[\"\\n\",a(n.p,{children:[\"To compute the state-visitation frequency, we require the policy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"π\"}),e(n.mtext,{children:\"ME\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}} (a_j \\\\mid s_i, \\\\omega)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord text mtight\",children:e(n.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" (see \",e(i,{text:\"Equation\",label:\"eq:fwpass\",num:\"7b\"}),\").\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",e(n.p,{children:\"Putting this all together yields the following iteration scheme:\"}),\"\\n\",a(n.ol,{children:[\"\\n\",a(n.li,{children:[\"\\n\",a(n.p,{children:[\"Compute policy \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[a(n.msub,{children:[e(n.mi,{children:\"π\"}),e(n.mtext,{children:\"ME\"})]}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"j\"})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}} (a_j \\\\mid s_i, \\\\omega)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"π\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:e(n.span,{className:\"mord text mtight\",children:e(n.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\" the using current estimate of \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:e(n.mi,{children:\"ω\"})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"})]})})]}),\" via the backward pass, i.e., \",e(i,{text:\"Equations\",label:\"eq:bwpass\",num:\"6a–c\"}),\".\"]}),\"\\n\"]}),\"\\n\",a(n.li,{children:[\"\\n\",a(n.p,{children:[\"Compute the state-visitation frequency \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[e(n.mrow,{children:a(n.msub,{children:[e(n.mi,{children:\"D\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"i\"})]})]})}),e(n.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:a(n.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),e(n.span,{className:\"sizing reset-size3 size1 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.143em\"},children:e(n.span,{})})})]})})]})})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:e(n.span,{})})})]})})]})]})})]}),\" via the forward pass, i.e., \",e(i,{text:\"Equations\",label:\"eq:fwpass\",num:\"7a–c\"}),\".\"]}),\"\\n\"]}),\"\\n\",a(n.li,{children:[\"\\n\",a(n.p,{children:[\"Compute the gradient \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{mathvariant:\"normal\",children:\"∇\"}),e(n.mi,{mathvariant:\"script\",children:\"L\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\nabla \\\\mathcal{L}(\\\\omega)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord\",children:\"∇\"}),e(n.span,{className:\"mord mathcal\",children:\"L\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\" via \",e(i,{label:\"eq:grad-b\",num:\"5b\"}),\".\"]}),\"\\n\"]}),\"\\n\",a(n.li,{children:[\"\\n\",e(n.p,{children:\"Perform one gradient-based optimization step, e.g.,\"}),\"\\n\",e(n.span,{className:\"katex-display\",children:a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"ω\"}),e(n.mo,{children:\"←\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{children:\"+\"}),e(n.mi,{children:\"η\"}),e(n.mi,{mathvariant:\"normal\",children:\"∇\"}),e(n.mi,{mathvariant:\"script\",children:\"L\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"ω\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mi,{mathvariant:\"normal\",children:\".\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega \\\\gets \\\\omega + \\\\eta \\\\nabla \\\\mathcal{L}(\\\\omega).\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.4306em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"←\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"0.6667em\",verticalAlign:\"-0.0833em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),e(n.span,{className:\"mbin\",children:\"+\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"η\"}),e(n.span,{className:\"mord\",children:\"∇\"}),e(n.span,{className:\"mord mathcal\",children:\"L\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mord\",children:\".\"})]})]})]})}),\"\\n\"]}),\"\\n\"]}),\"\\n\",e(n.p,{children:\"We then iterate these four steps until convergence.\"}),\"\\n\",e(t,{children:a(n.p,{children:[e(n.strong,{children:\"Note:\"}),\" You can find a Jupyter Notebook discussing a simple implementation of this algorithm (applied to a grid-world example) at \",e(n.a,{href:\"https://github.com/qzed/irl-maxent\",children:\"github.com/qzed/irl-maxent\"}),\".\"]})}),\"\\n\",e(n.h2,{id:\"some-last-words\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#some-last-words\",children:\"Some Last Words…\"})}),\"\\n\",e(n.p,{children:\"Maximum entropy IRL is a clever and ― all in all ― fairly simple solution to the general inverse reinforcement learning problem.\\nHowever, it does have some drawbacks and limitations:\"}),\"\\n\",a(n.p,{children:[\"First and foremost, the algorithm as explained in this post requires us “solving” the MDP once per iteration.\\nAs a result, it is fairly limited in the size of the discrete state-action-spaces that it can (reasonably) be applied to.\\nExtensions to continuous state spaces, for example via Monte-Carlo sampling or via path integrals, have been proposed \",a(n.span,{className:\"csl-ref\",id:\"citation--aghasadeghimaximumentropyinverse2011--kalakrishnanlearningobjectivefunctions2013--20\",children:[\"[see e.g., \",e(n.a,{href:\"#bib-aghasadeghimaximumentropyinverse2011\",children:\"Aghasadeghi and Bretl 2011\"}),\"; \",e(n.a,{href:\"#bib-kalakrishnanlearningobjectivefunctions2013\",children:\"Kalakrishnan et al. 2013\"}),\"]\"]}),\".\\nHowever, the assumption that the transition dynamics of the environment, i.e., the probability distribution \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(s_{t+1} \\\\mid s_t, a_t)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\", are known, further limits its applicability.\"]}),\"\\n\",a(n.p,{children:[\"It also assumes a linear parametrization of the reward \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"R\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"s\"}),e(n.mo,{stretchy:\"false\",children:\")\"}),e(n.mo,{children:\"=\"}),a(n.msup,{children:[e(n.mi,{children:\"ω\"}),e(n.mo,{children:\"⊺\"})]}),e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"s\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"R(s) = \\\\omega^\\\\intercal \\\\phi(s)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mclose\",children:\")\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"=\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"ω\"}),e(n.span,{className:\"msupsub\",children:e(n.span,{className:\"vlist-t\",children:e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.6644em\"},children:a(n.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mbin amsrm mtight\",children:\"⊺\"})})]})})})})})]}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\".\\nThis can be somewhat mitigated by our choice of features \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"ϕ\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),e(n.mi,{children:\"s\"}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi(s)\"})]})})}),e(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"ϕ\"}),e(n.span,{className:\"mopen\",children:\"(\"}),e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"mclose\",children:\")\"})]})})]}),\", but feature expectation matching also only guarantees performance-parity with a linear reward parametrization.\\nAn extension to model nonlinear reward functions via neural networks has been suggested by Wulfmeier et al. \",a(n.span,{className:\"csl-ref\",id:\"citation--wulfmeiermaximumentropydeep2016--21\",children:[\"[\",e(n.a,{href:\"#bib-wulfmeiermaximumentropydeep2016\",children:\"2016\"}),\"]\"]}),\".\"]}),\"\\n\",a(n.p,{children:[\"Lastly, maximum entropy IRL is constrained to limited transition randomness, i.e., fairly deterministic transition dynamics \",a(n.span,{className:\"katex\",children:[e(n.span,{className:\"katex-mathml\",children:e(n.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:a(n.semantics,{children:[a(n.mrow,{children:[e(n.mi,{children:\"p\"}),e(n.mo,{stretchy:\"false\",children:\"(\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),a(n.mrow,{children:[e(n.mi,{children:\"t\"}),e(n.mo,{children:\"+\"}),e(n.mn,{children:\"1\"})]})]}),e(n.mo,{children:\"∣\"}),a(n.msub,{children:[e(n.mi,{children:\"s\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{separator:\"true\",children:\",\"}),a(n.msub,{children:[e(n.mi,{children:\"a\"}),e(n.mi,{children:\"t\"})]}),e(n.mo,{stretchy:\"false\",children:\")\"})]}),e(n.annotation,{encoding:\"application/x-tex\",children:\"p(s_{t+1} \\\\mid s_t, a_t)\"})]})})}),a(n.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),e(n.span,{className:\"mord mathnormal\",children:\"p\"}),e(n.span,{className:\"mopen\",children:\"(\"}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:a(n.span,{className:\"mord mtight\",children:[e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"}),e(n.span,{className:\"mbin mtight\",children:\"+\"}),e(n.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),e(n.span,{className:\"mrel\",children:\"∣\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),a(n.span,{className:\"base\",children:[e(n.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"s\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mpunct\",children:\",\"}),e(n.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),a(n.span,{className:\"mord\",children:[e(n.span,{className:\"mord mathnormal\",children:\"a\"}),e(n.span,{className:\"msupsub\",children:a(n.span,{className:\"vlist-t vlist-t2\",children:[a(n.span,{className:\"vlist-r\",children:[e(n.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:a(n.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[e(n.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),e(n.span,{className:\"sizing reset-size6 size3 mtight\",children:e(n.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),e(n.span,{className:\"vlist-s\",children:\"​\"})]}),e(n.span,{className:\"vlist-r\",children:e(n.span,{className:\"vlist\",style:{height:\"0.15em\"},children:e(n.span,{})})})]})})]}),e(n.span,{className:\"mclose\",children:\")\"})]})]})]}),\".\\nAs noted above, this is due to the reward bias introduced by our probability approximation and can be avoided via the maximum \",e(n.em,{children:\"causal\"}),\" entropy IRL approach, proposed subsequently by Ziebart \",a(n.span,{className:\"csl-ref\",id:\"citation--ziebartmodelingpurposefuladaptive2010--ziebartprinciplemaximumcausal2013--22\",children:[\"[\",e(n.a,{href:\"#bib-ziebartmodelingpurposefuladaptive2010\",children:\"Ziebart 2010\"}),\"; \",e(n.a,{href:\"#bib-ziebartprinciplemaximumcausal2013\",children:\"Ziebart et al. 2013\"}),\"]\"]}),\".\"]}),\"\\n\",a(n.p,{children:[\"A somewhat similar, yet model-free approach is relative entropy IRL by Boularias et al. \",a(n.span,{className:\"csl-ref\",id:\"citation--boulariasrelativeentropyinverse2011--23\",children:[\"[\",e(n.a,{href:\"#bib-boulariasrelativeentropyinverse2011\",children:\"2011\"}),\"]\"]}),\".\\nSee the paper by Snoswell et al. \",a(n.span,{className:\"csl-ref\",id:\"citation--snoswellrevisitingmaximumentropy2020--24\",children:[\"[\",e(n.a,{href:\"#bib-snoswellrevisitingmaximumentropy2020\",children:\"2020\"}),\"]\"]}),\" for a perspective on both relative and maximum entropy IRL approaches.\"]}),\"\\n\",e(n.h2,{id:\"references\",children:e(n.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#references\",children:\"References\"})}),\"\\n\",a(n.div,{id:\"refs\",className:\"references csl-bib-body\",children:[\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-abbeelapprenticeshiplearninginverse2004\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Abbeel, P. and Ng, A.Y.\"}),\" 2004. Apprenticeship learning via inverse reinforcement learning. \",e(n.i,{children:\"Twenty-first international conference on Machine learning - ICML ’04\"}),\", ACM Press.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-aghasadeghimaximumentropyinverse2011\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Aghasadeghi, N. and Bretl, T.\"}),\" 2011. Maximum entropy inverse reinforcement learning in continuous state spaces with path integrals. \",e(n.i,{children:\"2011 IEEE/RSJ International Conference on Intelligent Robots and Systems\"}),\", 1561–1566.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-bishoppatternrecognitionmachine2006\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Bishop, C.M.\"}),\" 2006. \",e(n.i,{children:\"Pattern Recognition and Machine Learning\"}),\". Springer, New York.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-boulariasrelativeentropyinverse2011\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Boularias, A., Kober, J., and Peters, J.\"}),\" 2011. Relative Entropy Inverse Reinforcement Learning. \",e(n.i,{children:\"Proceedings of the Fourteenth International Conference on Artificial Intelligence and Statistics\"}),\", JMLR Workshop and Conference Proceedings, 182–189.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-jaynesinformationtheorystatistical1957\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Jaynes, E.T.\"}),\" 1957. Information Theory and Statistical Mechanics. \",e(n.i,{children:\"Physical Review\"}),\" \",e(n.i,{children:\"106\"}),\", 4, 620–630.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-kalakrishnanlearningobjectivefunctions2013\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Kalakrishnan, M., Pastor, P., Righetti, L., and Schaal, S.\"}),\" 2013. Learning objective functions for manipulation. \",e(n.i,{children:\"2013 IEEE International Conference on Robotics and Automation\"}),\", 1331–1336.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-ngpolicyinvariancereward1999\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Ng, A.Y., Harada, D., and Russell, S.J.\"}),\" 1999. Policy Invariance Under Reward Transformations: Theory and Application to Reward Shaping. \",e(n.i,{children:\"Proceedings of the Sixteenth International Conference on Machine Learning\"}),\", Morgan Kaufmann Publishers Inc., 278–287.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-osaalgorithmicperspectiveimitation2018\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Osa, T., Pajarinen, J., Neumann, G., Bagnell, J.A., Abbeel, P., and Peters, J.\"}),\" 2018. An Algorithmic Perspective on Imitation Learning. \",e(n.i,{children:\"Foundations and Trends in Robotics\"}),\" \",e(n.i,{children:\"7\"}),\", 1–2, 1–179.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-snoswellrevisitingmaximumentropy2020\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Snoswell, A.J., Singh, S.P.N., and Ye, N.\"}),\" 2020. Revisiting Maximum Entropy Inverse Reinforcement Learning: New Perspectives and Algorithms. \",e(n.i,{children:\"2020 IEEE Symposium Series on Computational Intelligence (SSCI)\"}),\", 241–249.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-wulfmeiermaximumentropydeep2016\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Wulfmeier, M., Ondruska, P., and Posner, I.\"}),\" 2016. Maximum Entropy Deep Inverse Reinforcement Learning. http://arxiv.org/abs/1507.04888.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-ziebartmodelingpurposefuladaptive2010\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Ziebart, B.D.\"}),\" 2010. Modeling purposeful adaptive behavior with the principle of maximum causal entropy. https://www.cs.cmu.edu/~bziebart/publications/thesis-bziebart.pdf.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-ziebartprinciplemaximumcausal2013\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Ziebart, B.D., Bagnell, J.A., and Dey, A.K.\"}),\" 2013. The Principle of Maximum Causal Entropy for Estimating Interacting Processes. \",e(n.i,{children:\"IEEE Transactions on Information Theory\"}),\", IEEE, 1966–1980.\"]}),\"\\n  \",a(n.div,{className:\"csl-entry\",id:\"bib-ziebartmaximumentropyinverse2008\",children:[e(n.span,{style:{fontVariant:\"small-caps\"},children:\"Ziebart, B.D., Maas, A., Bagnell, J.A., and Dey, A.K.\"}),\" 2008. Maximum Entropy Inverse Reinforcement Learning. \",e(n.i,{children:\"Proceedings of the 23rd National Conference on Artificial Intelligence - Volume 3\"}),\", AAAI Press, 1433–1438.\"]}),\"\\n\"]})]})}return{default:function(s={}){const{wrapper:a}=s.components||{};return a?e(a,{...s,children:e(_createMdxContent,{...s})}):_createMdxContent(s)}};function _missingMdxReference(s,e){throw new Error(\"Expected \"+(e?\"component\":\"object\")+\" `\"+s+\"` to be defined: you likely forgot to import, pass, or provide it.\")}"])</script><script>self.__next_f.push([1,"13:[\"$\",\"main\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"py-8 sm:py-12 lg:py-16 px-8\",\"children\":[\"$\",\"article\",null,{\"className\":\"mx-auto max-w-prose\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-10\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-gray-500 dark:text-gray-500\",\"children\":\"August 25, 2022\"}],[\"$\",\"div\",null,{\"className\":\"mt-2 sm:mt-3 mb-5 sm:mb-6\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl sm:text-5xl font-bold\",\"children\":\"Maximum Entropy Inverse Reinforcement Learning\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center gap-1\",\"children\":[[\"$\",\"p\",\"machine-learning\",{\"className\":\" px-1 py-0.5 rounded text-sm font-light whitespace-nowrap bg-slate-300 text-slate-900 dark:bg-slate-800 dark:text-slate-100 \",\"children\":[\"#\",\"machine-learning\"]}],[\"$\",\"p\",\"reinforcement-learning\",{\"className\":\" px-1 py-0.5 rounded text-sm font-light whitespace-nowrap bg-slate-300 text-slate-900 dark:bg-slate-800 dark:text-slate-100 \",\"children\":[\"#\",\"reinforcement-learning\"]}],[\"$\",\"p\",\"inverse-reinforcement-learning\",{\"className\":\" px-1 py-0.5 rounded text-sm font-light whitespace-nowrap bg-slate-300 text-slate-900 dark:bg-slate-800 dark:text-slate-100 \",\"children\":[\"#\",\"inverse-reinforcement-learning\"]}]]}]]}],[\"$\",\"div\",null,{\"className\":\" mdprose max-w-none prose-slate dark:prose-invert prose-sm sm:prose-base  text-pretty text-optimize-legibility break-words hyphens-auto subpixel-antialiased  prose-img:rounded prose-img:border prose-img:border-slate-200 dark:prose-img:border-slate-800  prose-table:rounded prose-table:bg-slate-200 dark:prose-table:bg-slate-800  prose-th:px-3 prose-td:px-3 prose-th:py-2 prose-td:py-2  prose-thead:border-b prose-thead:border-slate-400 dark:prose-thead:border-slate-500 prose-td:border-b prose-td:border-slate-300 dark:prose-td:border-slate-700 [\u0026\u003e*]:last:prose-tr:border-none  first:prose-th:pl-5 first:prose-td:pl-5 last:prose-th:pr-5 last:prose-td:pr-5  prose-code:font-normal \",\"children\":[\"$\",\"$L1b\",null,{\"code\":\"$1c\"}]}]]}]}]}]\n"])</script><script>self.__next_f.push([1,"18:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"1d:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/d2be314c3ece3fbe.js\"],\"IconMark\"]\n16:null\n"])</script><script>self.__next_f.push([1,"1a:[[\"$\",\"title\",\"0\",{\"children\":\"Maximilian Luz | Maximum Entropy Inverse Reinforcement Learning\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Maximum Entropy Inverse Reinforcement Learning - A blog post by Maximilian Luz\"}],[\"$\",\"link\",\"2\",{\"rel\":\"shortcut icon\",\"href\":\"/assets/icons/dark/favicon.png\"}],[\"$\",\"link\",\"3\",{\"rel\":\"shortcut icon\",\"href\":\"/assets/icons/dark/favicon.png\",\"media\":\"(prefers-color-scheme: light)\"}],[\"$\",\"link\",\"4\",{\"rel\":\"shortcut icon\",\"href\":\"/assets/icons/light/favicon.png\",\"media\":\"(prefers-color-scheme: dark)\"}],[\"$\",\"link\",\"5\",{\"rel\":\"icon\",\"href\":\"/assets/icons/dark/favicon.svg\"}],[\"$\",\"link\",\"6\",{\"rel\":\"icon\",\"href\":\"/assets/icons/dark/favicon.svg\",\"media\":\"(prefers-color-scheme: light)\"}],[\"$\",\"link\",\"7\",{\"rel\":\"icon\",\"href\":\"/assets/icons/light/favicon.svg\",\"media\":\"(prefers-color-scheme: dark)\"}],[\"$\",\"link\",\"8\",{\"rel\":\"apple-touch-icon\",\"href\":\"/assets/icons/dark/apple-touch-icon.png\"}],[\"$\",\"link\",\"9\",{\"rel\":\"apple-touch-icon\",\"href\":\"/assets/icons/dark/apple-touch-icon.png\",\"media\":\"(prefers-color-scheme: light)\"}],[\"$\",\"link\",\"10\",{\"rel\":\"apple-touch-icon\",\"href\":\"/assets/icons/light/apple-touch-icon.png\",\"media\":\"(prefers-color-scheme: dark)\"}],[\"$\",\"link\",\"11\",{\"rel\":\"mask-icon\",\"href\":\"/assets/icons/black/favicon.png\",\"color\":\"#06060b\"}],[\"$\",\"link\",\"12\",{\"rel\":\"mask-icon\",\"href\":\"/assets/icons/black/favicon.png\",\"media\":\"(prefers-color-scheme: light)\",\"color\":\"#06060b\"}],[\"$\",\"link\",\"13\",{\"rel\":\"mask-icon\",\"href\":\"/assets/icons/black/favicon.png\",\"media\":\"(prefers-color-scheme: dark)\",\"color\":\"#ffffff\"}],[\"$\",\"$L1d\",\"14\",{}]]\n"])</script></body></html>