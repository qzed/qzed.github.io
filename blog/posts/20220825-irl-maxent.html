<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Maximum Entropy Inverse Reinforcement Learning | Maximilian Luz</title><meta name="description" content="Blog of Maximilian Luz"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/851187a8f50eae40.css" as="style"/><link rel="stylesheet" href="/_next/static/css/851187a8f50eae40.css" data-n-g=""/><link rel="preload" href="/_next/static/css/eb8e0e671082361b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/eb8e0e671082361b.css" data-n-p=""/><link rel="preload" href="/_next/static/css/3e263976a2a9df74.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3e263976a2a9df74.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-73b63104b83bee32.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-56e54c109101a285.js" defer=""></script><script src="/_next/static/chunks/814-38d62155dfe3a73a.js" defer=""></script><script src="/_next/static/chunks/pages/blog/posts/%5Bslug%5D-d53272144c542a0f.js" defer=""></script><script src="/_next/static/VqO7pMtKrH6zG5R5-5JQ8/_buildManifest.js" defer=""></script><script src="/_next/static/VqO7pMtKrH6zG5R5-5JQ8/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="blog-post_base__HJjr3"><nav class="navbar_base__qZ3rK"><ul class="navbar_menu__lmA2R"><li class="navbar_item__9W3fH undefined"><a href="/"><div>Home</div></a></li><li class="navbar_item__9W3fH undefined"><a href="/blog"><div>Blog</div></a></li></ul></nav><main><div class="blog-post_topspace__i_l7C"></div><div class="blog-post_page__RuJUY"><div class="blog-post_column__UetXx"><div class="blog-post_text__rtwKs"><h1 class="blog-post_title__dGcQ4">Maximum Entropy Inverse Reinforcement Learning</h1><div class="blog-post_meta__wLjqE"><p class="blog-post_date___v3_v">August 25, 2022</p><div class="blog-post_tags___uPeq"><p class="blog-post_tag__q_Gfh">#<!-- -->machine-learning</p><p class="blog-post_tag__q_Gfh">#<!-- -->reinforcement-learning</p><p class="blog-post_tag__q_Gfh">#<!-- -->inverse-reinforcement-learning</p></div></div><div class="markdown_markdown__28kdH"><div class="note"><p><strong>Disclaimer:</strong> This post is an adapted version of the theoretical part of a Jupyter Notebook that I wrote in 2019 for a seminar on Imitation Learning.
You can find it, an accompanying presentation, and a small framework at <a href="https://github.com/qzed/irl-maxent">github.com/qzed/irl-maxent</a>.</p><p>I highly encourage you to have a look at that notebook in case you&#x27;re interested in the code behind this theory.</p></div>
<h1 id="context-and-motivation"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#context-and-motivation">Context and Motivation</a></h1>
<p>Let us start with some context and a brief overview of the problem we&#x27;re trying to solve:
<em>Reinforcement learning (RL)</em> aims to provide a framework for finding the optimal behavior (i.e., an optimal policy) of intelligent agents regarding some environment they interact with by directing them via a reward signal, measuring their performance.
In <em>inverse reinforcement learning (IRL)</em>, somewhat conversely, we try to recover the reward function (and therefore policy) of an agent given a set of demonstrations performed by that agent.
At first, this may seem to stand somewhat opposed to the larger goal of creating intelligent agents, however, we can use the demonstration of experts ― often humans ― to improve our agents by guiding them to a better solution.</p>
<p>An important aspect of IRL is the recovery of the expert&#x27;s reward function, which in many classical reinforcement-learning scenarios is often hand-designed.
This also sets it apart from <em>behavioral cloning (BC)</em>, another category of methods under the larger <em>imitation learning (IL)</em> umbrella <span class="csl-ref" id="csl-ref-a1gvqi3hjv5"><a href="#csl-entry-osaAlgorithmicPerspectiveImitation2018">(see Osa et al., 2018 for an overview)</a></span>, which focuses on retrieving the expert&#x27;s policy instead of the reward.
The general idea is that by analyzing the actions taken by an expert, we can infer a better reward function than we could manually design.</p>
<p>Maximum entropy (MaxEnt) inverse reinforcement learning <span class="csl-ref" id="csl-ref-a5kmk23jfg"><a href="#csl-entry-ziebartMaximumEntropyInverse2008">(Ziebart et al., 2008)</a></span> is a powerful and clever, yet fairly simple way to achieve this.
Having discussed the “why”, let us now get to the “how”:</p>
<h1 id="a-more-mathematical-introduction"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#a-more-mathematical-introduction">A More Mathematical Introduction</a></h1>
<p>While I assume some familiarity with the basics of reinforcement and inverse reinforcement learning, here&#x27;s a short overview:
In both settings, we describe our world using a Markov decision process (MDP).
An MDP is a 5-tuple <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>T</mi><mo separator="true">,</mo><mi>R</mi><mo separator="true">,</mo><mi>γ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S, A, T, R, \gamma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mclose">)</span></span></span></span></span> with states <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span></span>, actions <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span>, transition model <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(s_t, a_t, s_{t+1}) = p(s_{t+1} \mid s_t, a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, reward function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>∈</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">R(s_t, a_t, s_{t+1}) \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord mathbb">R</span></span></span></span></span>, and reward discount factor <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\gamma \in [0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>, decreasing the reward over time (where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">a_t \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∈</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">s_t, s_{t+1} \in S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7474em;vertical-align:-0.2083em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span></span>).
In the inverse reinforcement learning setting, we will only use per-state rewards <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>∈</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">R(s) \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord mathbb">R</span></span></span></span></span>.
The key part of an MDP is that any action relies solely on the current state, meaning complete independence of all preceding history.</p>
<p>The goal of reinforcement learning then is to find an optimal sequence of actions, i.e., a policy describing the optimal action per state, for an autonomous agent given a reward signal <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span></span>.
The reward signal provides feedback to the agent, affirming its behavior on actions that help further the goal of the task at hand, and punishing it on actions that are counter-productive to this goal.
Policies come in two flavors: deterministic and stochastic.
Deterministic policies are defined as function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>:</mo><mi>S</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">\pi: S \to A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">A</span></span></span></span></span>, whereas stochastic policies are defined as probability distributions over actions, i.e., <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(a \mid s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span>.
While in the usual RL setting the (or at least one) optimal policy is guaranteed to be deterministic, in inverse reinforcement learning (and not only there), it makes more sense to talk about stochastic policies.</p>
<p>Inverse reinforcement learning, as discussed above and the name suggests, does the inverse of RL.
Given a set of demonstrations <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>τ</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{D} = \{\tau_i\}_{i=1}^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0087em;vertical-align:-0.2587em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span></span> of an expert (agent), consisting of trajectories <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mrow><mo fence="true">(</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>s</mi><mi>n</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tau = \left( (s_1, a_1), (s_2, a_2), \ldots, (s_{n-1}, a_{n-1}), s_n \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span> through the state-action space, IRL aims to recover the underlying reward function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span></span>, which explains the behavior of the expert.</p>
<p>To allow for computation with states, we use so-called features.
Features are, in this case, defined as a function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>:</mo><mi>S</mi><mo>→</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">\phi: S \to \mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal">ϕ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span>, mapping states to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span></span>-dimensional vectors, and can be arbitrarily chosen.
In general, we assume that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">∣</mi><mi>τ</mi><mi mathvariant="normal">∣</mi></mrow></msubsup><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(\tau) = \sum_{t = 1}^{|\tau|} \phi(s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3276em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0279em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>τ</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\tau|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mord">∣</span></span></span></span></span> denotes the length of the trajectories (visited states), i.e., that the features of a trajectory <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span> are the sum of the features of the states visited by this trajectory, counting repetitions.</p>
<h1 id="the-principle-of-maximum-entropy"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#the-principle-of-maximum-entropy">The Principle of Maximum Entropy</a></h1>
<p>The general idea of Maximum Entropy Inverse Reinforcement Learning is based on feature-expectation matching <span class="csl-ref" id="csl-ref-a8do62nm0p"><a href="#csl-entry-abbeelApprenticeshipLearningInverse2004">(Abbeel &amp; Ng, 2004)</a></span>:
The expected visitation-frequency of features in the demonstrations provided by the expert should equal the expected visitation-frequency of features visited by the agent following the recovered reward function.
In other words: The features describing the states of our world should be, in expectation, visited equally often by the agent following our recovered reward function and by the expert demonstrating (nearly) optimal behavior.
In equations, we can express this as the expectation of features <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal">ϕ</span></span></span></span></span> over trajectories <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span> derived from the reward we want to recover, and</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">    \mathbb{E}_{\pi^L}[\phi(\tau)] = \mathbb{E}_{\pi^E}[\phi(\tau)],</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span><span class="mpunct">,</span></span></span></span></span></div>
<p>where the learner follows a policy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mi>L</mi></msup></mrow><annotation encoding="application/x-tex">\pi^L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span> directly implied by the reward.
The expert follows an implicit policy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mi>E</mi></msup></mrow><annotation encoding="application/x-tex">\pi^E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span> that encodes its notion of reward and optimality.</p>
<p>Note that we can also express the expected feature visitation frequency as sum over trajectories</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><munder><mo>∑</mo><mi>τ</mi></munder><msub><mi>p</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    \mathbb{E}_{\pi^L}[\phi(\tau)] = \sum_{\tau} p_{\pi^L}(\tau) \phi(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.3em;vertical-align:-1.25em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span></span></div>
<p>with the probability distribution <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{\pi^L}(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span></span> of trajectories of the learner. Finding such a match, however, is not a well-posed problem in accordance to the definition by Hadamard: There is not the single one, but many possible solutions.
Multiple reward functions can achieve the same expected feature-visitation frequency <span class="csl-ref" id="csl-ref-a2b30tdu40u"><a href="#csl-entry-ngPolicyInvarianceReward1999">(Abbeel &amp; Ng, 2004; Ng et al., 1999; Ziebart, 2010)</a></span>.
To resolve this ambiguity, Ziebart et al. <span class="csl-ref" id="csl-ref-anlf0ktci"><a href="#csl-entry-ziebartMaximumEntropyInverse2008">(Ziebart et al., 2008)</a></span> propose to choose the solution (i.e., the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><msup><mi>π</mi><mi>L</mi></msup></msub></mrow><annotation encoding="application/x-tex">p_{\pi^L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6276em;vertical-align:-0.1971em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span></span></span></span></span>) maximizing the entropy.</p>
<p>But why should we maximize the entropy?
To answer this, we have to understand what entropy represents.
Firstly, the entropy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span> of some event probability distribution <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span></span> is defined as</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant="script">X</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi mathvariant="script">X</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mfrac><mn>1</mn><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    H(p)
    &amp;= -\sum_{x \in \mathcal{X}} p(x) \log_2 p(x), \\
    &amp;= \sum_{x \in \mathcal{X}} p(x) \cdot \log_2 \frac{1}{p(x)},
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.6149em;vertical-align:-2.5574em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0574em"><span style="top:-5.3289em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span><span style="top:-2.3857em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.5574em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0574em"><span style="top:-5.3289em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.14643em">X</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.3857em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.14643em">X</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.5574em"><span></span></span></span></span></span></span></span></span></span></span></span></div>
<p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span></span> is the set containing all events <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> the probability of event <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></span> occurring.</p>
<p>Let us now assume that we want to communicate the occurrence of all events <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></span> with some other party efficiently.
To accomplish this, we wish to minimize the expected message length, so messages that will be sent frequently should be short, and messages that will seldom be sent are allowed to be long.
Following this trail of thought leads to the term <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x) = \log_2(1/p(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1/</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></span>, which is the optimal number of bits that we should spend on the message representing event <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></span>.
With lower probability <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>, the term <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log_2(1/p(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1/</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></span> increases.
In fact, it increases logarithmically, as with more bits available, we can encode exponentially more events.
Using this observation for the entropy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span></span> then yields nothing more than the entropy being the lower limit of the expected message length over all messages, i.e.:</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mrow><mo fence="true">[</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">    H(p)
    = \mathbb{E}_{p(x)}\left[h(x)\right].</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">]</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">.</span></span></span></span></span></div>
<p>Summarizing all of this in a single sentence: Entropy is a measure of uncertainty.</p>
<div class="note"><p><strong>Note:</strong> This is, in fact, the underlying principle of Huffman coding, which, due to this relation, is guaranteed to be optimal.</p></div>
<p>As is done generally, we will now use the normal logarithm instead of the base-two one.
Since <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log_2(x) = \log(x)/\log(2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">/</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span> holds, we are only dropping a constant factor of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span> which does not impact extrema or our reasoning below, and simplifies further computations.</p>
<p>With that in mind, let us ask again:
Why should we maximize the entropy?
Now we can give a simple reasoning <span class="csl-ref" id="csl-ref-av3g4l9eoe"><a href="#csl-entry-jaynesInformationTheoryStatistical1957">(Jaynes, 1957)</a></span>:
Let us assume that we have two distributions, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span></span>, with entropy values <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>H</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(p) &gt; H(q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mclose">)</span></span></span></span></span>.
From our previous observations, we now know that to encode messages from <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span></span> we, in expectancy, need more bits than to encode messages from <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span></span>.
This is the key point because this in turn also means that we have less information about <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span></span> than about <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span></span>.
If we know more about a distribution, we require fewer bits to encode events from it.
If we know everything, we do not need to send/encode anything, and if we know nothing, we need to send everything.</p>
<p>But isn&#x27;t it good if we know more? “The less entropy, the better, right?” you may ask.
No.
Not for many optimization problems, or in general, when working with incomplete information:
Consider a problem, like feature-expectation matching, which has multiple solutions fulfilling our constraints.
The only information which we give our solver for this problem is the feature-expectations we want to replicate.
All solutions provided by our solver contain this information.
Yet, they most certainly have different entropy values.
This must mean that (at least) some solutions have additional information that we did not provide, i.e., they have a bias.
This is illustrated in the figure below for our two distributions <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span></span>:</p>
<p><img src="/assets/blog/20220825-irl-maxent/maxent-principle.png" alt="Illustration of the Maximum Entropy Principle"/></p>
<p>By choosing the solution with maximum entropy, we choose the solution with minimal information.
Note that all solutions already satisfy our constraints; thus we actually pick the solution that best fits our information with a minimal bias.</p>
<h1 id="deriving-the-maximum-entropy-inverse-reinforcement-learning-algorithm"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#deriving-the-maximum-entropy-inverse-reinforcement-learning-algorithm">Deriving the Maximum Entropy Inverse Reinforcement Learning Algorithm</a></h1>
<p>Applying our findings from the previous section to feature-expectation matching directly results in a constrained optimization problem:</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mrow><mi mathvariant="normal">arg max</mi><mo>⁡</mo></mrow><mi>p</mi></munder><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>subject to</mtext><mspace width="1em"></mspace><mrow></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo>∑</mo><mi>τ</mi></munder><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="1em"></mspace><mi mathvariant="normal">∀</mi><mi>τ</mi><mo>:</mo><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{alignat*}{2}
    \argmax_p\quad
        &amp;&amp; H(p) \\
    \text{subject to}\quad
        \label{eq:feature-constraints}
        &amp;&amp; \mathbb{E}_{\pi^L}[\phi(\tau)] &amp;= \mathbb{E}_{\pi^E}[\phi(\tau)],
            \tag{1a} \\
        \label{eq:probability-constraints}
        &amp;&amp; \sum_{\tau} p(\tau) = 1, &amp;\quad \forall \tau : p(\tau) &gt; 0,
            \tag{1b}
\end{alignat*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.2706em;vertical-align:-2.8853em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3853em"><span style="top:-5.5953em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.2056em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">arg</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathrm">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0305em"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span></span></span><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord text"><span class="mord">subject to</span></span><span class="mspace" style="margin-right:1em"></span><span class="enclosing" id="eq:feature-constraints"></span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="enclosing" id="eq:probability-constraints"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3853em"><span style="top:-5.5953em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3853em"><span style="top:-5.5953em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2147em"><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span><span class="mpunct">,</span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:1em"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3853em"><span style="top:-5.5953em"><span class="pstrut" style="height:3.05em"></span><span></span></span><span style="top:-3.4247em"><span class="pstrut" style="height:3.05em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1a</span></span><span class="mord">)</span></span></span></span><span style="top:-1.7147em"><span class="pstrut" style="height:3.05em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1b</span></span><span class="mord">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8853em"><span></span></span></span></span></span></span></span></span></div>
<p>where <a class="eq-ref" href="#eq:feature-constraints">Equation (1a)</a> represents the feature-matching constraint and <a class="eq-ref" href="#eq:probability-constraints">Equation (1b)</a> the probability constraints.</p>
<p>This problem expresses that we want to find a probability distribution <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span></span> over trajectories <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span> with maximum entropy, under which the expected feature visitation frequencies of learner <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>L</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}_{\pi^L}[\phi(\tau)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span></span></span></span></span> and expert <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mo stretchy="false">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}_{\pi^E}[\phi(\tau)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)]</span></span></span></span></span> match (that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span></span> represents the features visited by trajectory <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span>).
Note that the policy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mi>L</mi></msup></mrow><annotation encoding="application/x-tex">\pi^L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span></span></span></span></span> of the learner depends on the probability distribution <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span></span> with</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow></mrow><msup><mi>π</mi><mi>L</mi></msup><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy="false">)</mo><mo>∝</mo><munder><mo>∑</mo><mrow><mi>τ</mi><mo>:</mo><mtext> </mtext><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>∈</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    \label{eq:policy}
    \pi^L(a \mid s) \propto \sum_{\tau :\ (s, a) \in \tau_{t=0}} p(\tau),
    \tag{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em"></span><span class="enclosing" id="eq:policy"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.809em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mrel mtight">:</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">s</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.1132em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mpunct">,</span></span><span class="tag"><span class="strut" style="height:2.566em;vertical-align:-1.516em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></div>
<p>i.e., the policy of the learner is proportional to the sum of the probabilities of all trajectories performing action <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">a</span></span></span></span></span> in the starting state <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">s</span></span></span></span></span>.</p>
<p>Now we have the probability distribution over trajectories, but how does this help us to recover the reward function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>:</mo><mi>S</mi><mo>→</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">R: S \to \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord mathbb">R</span></span></span></span></span>?
Following the school of basic reinforcement learning provides us with the answer: The reward dictates the policy, which in turn dictates the trajectory distribution <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span></span>.
A key assumption of Maximum Entropy IRL is that we know the behavior of our MDP, i.e., we have a perfect model representing the transition probabilities <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(s_{t+1} \mid s_t, a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, so the only thing we actually need to learn is the reward.
Everything else either is derived from it or assumed known.
To be able to learn the reward, we must parameterize it.
For this, we assume linearity regarding features, i.e.,</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">    R(\tau) = \omega^\top \phi(\tau),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></div>
<p>with <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">\omega \in \mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span> being the reward parameter vector.
To make the dependency on the reward parameters explicit, we write <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau \mid \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi(a \mid s, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span>.</p>
<div class="note"><p><strong>Note:</strong> The choice of a linear parametrization is not by chance, but a direct result of the feature expectation matching constraint:
Given an expert solving an MDP with unknown reward function linear in a set of known features, performing feature expectation matching with those features is guaranteed to yield a policy performing comparable to or better than the expert with respect to that reward <span class="csl-ref" id="csl-ref-a1p5dt98ism"><a href="#csl-entry-abbeelApprenticeshipLearningInverse2004">(Abbeel &amp; Ng, 2004)</a></span>.</p></div>
<h2 id="solution-and-partition-function"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#solution-and-partition-function">Solution and Partition Function</a></h2>
<p>Solving the above mathematical program for MDPs with deterministic transition dynamics (i.e., MDPs where all actions have predetermined deterministic outcomes) using the method of Lagrange multipliers leads to the observation that</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>p</mi><mi>d</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mi>τ</mi></munder><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    p_d(\tau \mid \omega) &amp;= \frac{1}{Z(\omega)} \exp \left( \omega^\top \phi(\tau) \right), \\
    Z(\omega) &amp;= \sum_{\tau} \exp \left( \omega^\top \phi(\tau) \right)
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.1575em;vertical-align:-2.3287em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8287em"><span style="top:-4.8287em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-2.5427em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3287em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.8287em"><span style="top:-4.8287em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span></span></span><span style="top:-2.5427em"><span class="pstrut" style="height:3.3214em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.3287em"><span></span></span></span></span></span></span></span></span></span></span></span></div>
<p>with the so-called partition function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Z(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span> simply normalizing the values to fulfill the probability distribution constraint <span class="csl-ref" id="csl-ref-aok1beo2jg"><a href="#csl-entry-ziebartMaximumEntropyInverse2008">(Osa et al., 2018; Ziebart et al., 2008)</a></span>.
By choosing the reward to linearly depend on the features, we have also ensured that the Lagrange multipliers are precisely the reward parameters <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span></span></span></span></span> <span class="csl-ref" id="csl-ref-a1bls2ie4h2"><a href="#csl-entry-osaAlgorithmicPerspectiveImitation2018">(Osa et al., 2018)</a></span>.
For MDPs with stochastic transitions, Ziebart et al. <span class="csl-ref" id="csl-ref-a2ohn2ak7jn"><a href="#csl-entry-ziebartMaximumEntropyInverse2008">(Ziebart et al., 2008)</a></span> propose to modify the deterministic solution, yielding the approximation</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow></mrow><msub><mi>p</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>≈</mo><mfrac><mn>1</mn><mrow><mi>Z</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><munder><mo>∏</mo><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>t</mi></msub><mo>∈</mo><mi>τ</mi></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    \label{eq:approx-probability}
    p_s(\tau \mid \omega)
    \approx
        \frac{1}{Z(\omega)} \exp\left( \omega^\top \phi(\tau) \right)
        \prod_{s_{t+1}, a_t, s_t \in \tau} p(s_{t+1} \mid s_t, a_t).
    \tag{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="enclosing" id="eq:approx-probability"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.7132em;vertical-align:-1.3918em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span><span class="tag"><span class="strut" style="height:2.7132em;vertical-align:-1.3918em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span></div>
<div class="note"><p><strong>Note:</strong> We are simply multiplying the deterministic solution with combined transition probability of the trajectory.
As a result of said modification, however, we introduce a bias to the reward function <span class="csl-ref" id="csl-ref-a2j9r6nc4jj"><a href="#csl-entry-osaAlgorithmicPerspectiveImitation2018">(Osa et al., 2018)</a></span>.
To avoid this, Ziebart <span class="csl-ref" id="csl-ref-ajf7rra1cj"><a href="#csl-entry-ziebartModelingPurposefulAdaptive2010">(Ziebart, 2010)</a></span> proposes the Maximum Causal Entropy IRL method in his thesis <span class="csl-ref" id="csl-ref-a14p6atqmag"><a href="#csl-entry-ziebartPrincipleMaximumCausal2013">(see also Ziebart et al., 2013)</a></span>.
In the scope of this post, we&#x27;ll stick to the normal (non-causal) entropy.</p></div>
<h2 id="optimization"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#optimization">Optimization</a></h2>
<p>We now know the parameterized form of the distribution, so how can we optimize the parameters?
The answer is fairly straightforward: We can maximize the log-likelihood over all demonstrated trajectories <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>τ</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{D} = \{\tau_i\}_{i=1}^{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span></span>, i.e.,</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow></mrow><msup><mi>ω</mi><mo>∗</mo></msup><mo>=</mo><munder><mrow><mi mathvariant="normal">arg max</mi><mo>⁡</mo></mrow><mi>ω</mi></munder><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow><mi mathvariant="normal">arg max</mi><mo>⁡</mo></mrow><mi>ω</mi></munder><munder><mo>∑</mo><mrow><mi>τ</mi><mo>∈</mo><mi mathvariant="script">D</mi></mrow></munder><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    \label{eq:loglikelihood}
    \omega^* = \argmax_{\omega} \mathcal{L}(\omega)
    = \argmax_{\omega} \sum_{\tau \in \mathcal{D}} \log p(\tau \mid \omega),
    \tag{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7387em"></span><span class="enclosing" id="eq:loglikelihood"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.6444em;vertical-align:-0.8944em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.2056em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ω</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">arg</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathrm">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.3717em;vertical-align:-1.3217em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.2056em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ω</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">arg</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathrm">max</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8944em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.02778em">D</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mpunct">,</span></span><span class="tag"><span class="strut" style="height:2.3717em;vertical-align:-1.3217em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span></div>
<p>using gradient ascent (or any other gradient-based optimization technique) as this function is convex <span class="csl-ref" id="csl-ref-af7mptheev"><a href="#csl-entry-ziebartMaximumEntropyInverse2008">(Osa et al., 2018; Ziebart et al., 2008)</a></span>.</p>
<div class="note"><p><strong>Note:</strong> Maximizing the log-likelihood is equivalent to minimizing the Kullback-Leibler divergence <span class="csl-ref" id="csl-ref-a16t7citgch"><a href="#csl-entry-bishopPatternRecognitionMachine2006">(Bishop, 2006)</a></span></p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msup><mi>p</mi><mi>E</mi></msup><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mtext> </mtext><mi mathvariant="normal">∥</mi><mtext> </mtext><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">D_{KL}\big(p^E(\tau) \,\|\, p(\tau \mid \omega)\big).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2413em;vertical-align:-0.35em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∥</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mord">.</span></span></span></span></span></div><p>It can therefore also be interpreted as the M-projection onto the manifold of the maximum entropy distribution <span class="csl-ref" id="csl-ref-atlbi4114n"><a href="#csl-entry-osaAlgorithmicPerspectiveImitation2018">(see e.g., Osa et al., 2018)</a></span>.</p></div>
<p>The (averaged) gradient is then simply the difference between expected empirical feature counts <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mrow><mo fence="true">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}_{\pi^E} \left[ \phi(\tau) \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">]</span></span></span></span></span></span> and the learner&#x27;s expected feature counts (derived from the trajectory probabilities <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau \mid \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span>), shown in <a class="eq-ref" href="#eq:grad-a">Equation (5a)</a>, i.e.:</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi mathvariant="normal">∇</mi><mi>ω</mi></msub><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mrow><mo fence="true">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mo>−</mo><munder><mo>∑</mo><mi>τ</mi></munder><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mtext> </mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><msup><mi>π</mi><mi>E</mi></msup></msub><mrow><mo fence="true">[</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mo>−</mo><munder><mo>∑</mo><msub><mi>s</mi><mi>i</mi></msub></munder><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \label{eq:grad-a}
    \nabla_\omega \mathcal{L}(\omega)
    &amp;= \mathbb{E}_{\pi^E} \left[ \phi(\tau) \right] - \sum_{\tau} p(\tau \mid \omega)\ \phi(\tau),
        \tag{5a}\\
    \label{eq:grad-b}
    &amp;= \mathbb{E}_{\pi^E} \left[ \phi(\tau) \right] - \sum_{s_i} D_{s_i} \phi(s_i),
        \tag{5b}\\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.3001em;vertical-align:-2.4001em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9001em"><span style="top:-4.9001em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="enclosing" id="eq:grad-a"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ω</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-2.3em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="enclosing" id="eq:grad-b"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4001em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9001em"><span style="top:-4.9001em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">]</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace"> </span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mpunct">,</span></span></span><span style="top:-2.3em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1971em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">]</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3501em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4001em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9001em"><span style="top:-4.9001em"><span class="pstrut" style="height:3.05em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5a</span></span><span class="mord">)</span></span></span></span><span style="top:-2.3em"><span class="pstrut" style="height:3.05em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5b</span></span><span class="mord">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4001em"><span></span></span></span></span></span></span></span></span></div>
<p>which we can express in terms of the state-visitation frequency <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span></span> with <a class="eq-ref" href="#eq:grad-b">Equation (5b)</a>, assuming <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi mathvariant="normal">∣</mi><mi>τ</mi><mi mathvariant="normal">∣</mi></mrow></msubsup><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(\tau) = \sum_{t = 0}^{|\tau|} \phi(s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3276em;vertical-align:-0.2997em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0279em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> <span class="csl-ref" id="csl-ref-ac7oghtj7n"><a href="#csl-entry-ziebartMaximumEntropyInverse2008">(Ziebart et al., 2008)</a></span>.</p>
<div class="note"><p><strong>Note:</strong> The realization that we can transform <a class="eq-ref" href="#eq:grad-a">Equation (5a)</a> to <a class="eq-ref" href="#eq:grad-b">Equation (5b)</a>, i.e., represent the expected feature count of the learner via the state-visitation frequency <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span></span>, is actually one of the most important steps!</p><p><a class="eq-ref" href="#eq:grad-a">Equation (5a)</a> is generally infeasible (or at the very least quite costly) to compute, as enumerating all trajectories is usually subject to combinatorial explosion (think, for example, of trajectories in a “simple” grid world).
Computing the state visitation frequencies, as we will see below, however, is quite feasible (within some restrictions).</p></div>
<div class="note"><p><strong>Note:</strong> Due to the log-likelihood, this gradient holds for both deterministic and stochastic transition dynamics.</p></div>
<h2 id="computing-the-state-visitation-frequency"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#computing-the-state-visitation-frequency">Computing the State-Visitation Frequency</a></h2>
<p>Now, we have only one remaining question:
How do we compute the state-visitation frequency <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span></span>?
Following good computer-science fashion, we divide and conquer:
First, we compute a (stochastic) policy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}}(a \mid s, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span>, referred to as the local action probability, with a backward pass.
Thereafter, we compute the state-visitation frequency under this policy with a simple forward pass.</p>
<h3 id="backward-pass-computing-the-local-action-policy"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#backward-pass-computing-the-local-action-policy">Backward Pass: Computing the Local Action Policy</a></h3>
<p>The basic idea of the first pass is to remember our earlier observation about the learner policy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mi>L</mi></msup><mo stretchy="false">(</mo><mi>a</mi><mo>∣</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi^L(a \mid s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span> made in <a class="eq-ref" href="#eq:policy">Equation (2)</a>, i.e.,</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>∝</mo><munder><mo>∑</mo><mrow><mi>τ</mi><mo>:</mo><mtext> </mtext><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>∈</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow></munder><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">    \pi_{\text{ME}}(a_j \mid s_i, \omega) \propto \sum_{\tau :\ (s_i, a_j) \in \tau_{t=0}} p(\tau \mid \omega),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.5883em;vertical-align:-1.5383em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.809em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="mrel mtight">:</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.1132em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5383em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></div>
<p>and then recursively expand this using the solution we derived for our trajectory distribution <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>∣</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\tau \mid \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span> presented in <a class="eq-ref" href="#eq:approx-probability">Equation (3)</a> until we are not reasoning about full or partial trajectories any longer, but the individual state transitions.
This then yields the set of equations <span class="csl-ref" id="csl-ref-a2j0k28bej5"><a href="#csl-entry-ziebartMaximumEntropyInverse2008">(Ziebart et al., 2008)</a></span>:</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub></mrow></msub><msub><mi>Z</mi><msub><mi>s</mi><mi>j</mi></msub></msub></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mi>k</mi></munder><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>k</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mtext> </mtext><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msup><mi>ω</mi><mi mathvariant="normal">⊤</mi></msup><mi>ϕ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mtext> </mtext><msub><mi>Z</mi><msub><mi>s</mi><mi>k</mi></msub></msub><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>Z</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><msub><mi>a</mi><mi>j</mi></msub></munder><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub></mrow></msub><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \label{eq:bwpass}
    \pi_{\text{ME}}(a_j \mid s_i, \omega) &amp;= \frac{Z_{s_i, a_j}}{Z_{s_j}},
        \tag{6a} \\
    Z_{s_i, a_j} &amp;= \sum_{k} p(s_k \mid s_i, a_j)\, \exp \left(\omega^\top \phi(s_i)\right)\, Z_{s_k},
        \tag{6b} \\
    Z_{s_i} &amp;= \sum_{a_j} Z_{s_i, a_j}.
        \tag{6c}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:8.2034em;vertical-align:-3.8517em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.3517em"><span style="top:-6.3517em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="enclosing" id="eq:bwpass"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span><span style="top:-3.9684em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span></span></span><span style="top:-1.3163em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.8517em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.3517em"><span style="top:-6.3517em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4207em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.7373em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0333em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span style="top:-3.9684em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8479em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2559em"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-1.3163em"><span class="pstrut" style="height:3.4207em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4473em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.8517em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.3517em"><span style="top:-6.3517em"><span class="pstrut" style="height:3.4207em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6a</span></span><span class="mord">)</span></span></span></span><span style="top:-3.9684em"><span class="pstrut" style="height:3.4207em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6b</span></span><span class="mord">)</span></span></span></span><span style="top:-1.3163em"><span class="pstrut" style="height:3.4207em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6c</span></span><span class="mord">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.8517em"><span></span></span></span></span></span></span></span></span></div>
<p>Here, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">Z_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span></span> represents the state-partition-function, again normalizing the probabilities, and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{s_i, a_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> is referred to as the state-action partition function.
Setting the state-partition function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><msub><mi>s</mi><mi>i</mi></msub></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Z_{s_i} = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span> for terminal states and then recursively backing up, using the equations for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">Z_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">Z_{s_i, a_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0307em;vertical-align:-0.3473em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em"><span></span></span></span></span></span></span></span></span></span></span>, from those states yields a set of values that we can then use to compute the local action probabilities following the above equation.</p>
<div class="note"><p><strong>Note:</strong> This backup-pass somewhat resembles a value-iteration scheme to solve an MDP.
It also turns out that this backup part of the algorithm is the only thing that differs between Maximum Entropy and Maximum Causal Entropy IRL.</p><p>In fact, for the Maximum Causal Entropy approach, one can show that the partition functions are an analogy of the Bellman equation — the so-called soft Bellman equation — which allows for a straightforward extension of the value-iteration algorithm to this problem <span class="csl-ref" id="csl-ref-a2q8uo2kom0"><a href="#csl-entry-ziebartModelingPurposefulAdaptive2010">(Ziebart, 2010; Ziebart et al., 2013)</a></span>.</p></div>
<h3 id="forward-pass-inferring-state-visitation-frequency-from-πmepi_textmeπme"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#forward-pass-inferring-state-visitation-frequency-from-πmepi_textmeπme">Forward Pass: Inferring State-Visitation Frequency from <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></a></h3>
<p>As we now know the policy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}}(a_j \mid s_i, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span>, inferring the state-visitation frequency <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span></span> becomes fairly easy:
Remember that the policy is a probability distribution that tells us, given a state <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, with which probability the agent should take a certain action <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">a_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span>, which then leads to a new state <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> according to our MDP transition model.
Given an initial state-visitation frequency, we can therefore use the policy to forward-propagate the individual visitation counts, obtaining an updated state-visitation frequency map.</p>
<p>To this end, we initialize <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">D_{s_i, 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> to the starting-state probabilities <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_0(s_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> at timestep <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></span>, i.e.,</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mrow></mrow><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>p</mi><mn>0</mn></msub><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>τ</mi><mo>:</mo><msub><mi>s</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>τ</mi><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></msub><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(7a)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    \label{eq:fwpass}
    D_{s_i, 0} = p_0(s_i) = p(\tau : s_i \in \tau_{t=0}).
    \tag{7a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="enclosing" id="eq:fwpass"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span><span class="tag"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7a</span></span><span class="mord">)</span></span></span></span></span></span></div>
<p>We then compute updates as mentioned above via</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>k</mi></msub><mo separator="true">,</mo><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><munder><mo>∑</mo><msub><mi>s</mi><mi>i</mi></msub></munder><munder><mo>∑</mo><msub><mi>a</mi><mi>j</mi></msub></munder><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>⋅</mo><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>k</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(7b)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    D_{s_k, t+1} = \sum_{s_i} \sum_{a_j} D_{s_i, t}
        \cdot \pi_{\text{ME}} (a_j \mid s_i, \omega)
        \cdot p(s_k \mid s_i, a_j),
    \tag{7b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.4973em;vertical-align:-1.4473em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3501em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4473em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span><span class="tag"><span class="strut" style="height:2.4973em;vertical-align:-1.4473em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7b</span></span><span class="mord">)</span></span></span></span></span></span></div>
<p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>k</mi></msub><mo>∣</mo><msub><mi>a</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(s_k \mid a_j, s_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> represents the transition probabilities of our (stochastic) MDP.
Note, that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{s_i, t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> only gives us the state-visitation frequency for time-step <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span></span>, meaning we have to sum them up to obtain the time-step independent state-visitation</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub><mo>=</mo><munder><mo>∑</mo><mi>t</mi></munder><msub><mi>D</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(7c)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">    D_{s_i} = \sum_{t} D_{s_i, t}.
    \tag{7c}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.3em;vertical-align:-1.25em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.9em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord">.</span></span><span class="tag"><span class="strut" style="height:2.3em;vertical-align:-1.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7c</span></span><span class="mord">)</span></span></span></span></span></span></div>
<h1 id="the-algorithm"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#the-algorithm">The Algorithm</a></h1>
<p>With a plan for computation of the state-visitation frequency, we now have everything we need to state the full algorithm.
To derive that, however, let us first recap our findings:</p>
<ul>
<li>
<p>Our problem is a constrained optimization problem for finding the optimal reward parameters <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span></span></span></span></span>.
We can solve this problem by maximizing the log-likelihood over all demonstrated trajectories <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span></span></span></span></span> (see <a class="eq-ref" href="#eq:loglikelihood">Equation (4)</a>).
This, in turn, is itself an optimization problem, for which we need the gradient <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \mathcal{L}(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∇</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span> of this log-likelihood.</p>
</li>
<li>
<p>To compute the gradient <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \mathcal{L}(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∇</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span>, we require the state-visitation frequency (see <a class="eq-ref" href="#eq:grad-b">Equation (5b)</a>).</p>
</li>
<li>
<p>To compute the state-visitation frequency, we require the policy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}} (a_j \mid s_i, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span> (see <a class="eq-ref" href="#eq:fwpass">Equation (7b)</a>).</p>
</li>
</ul>
<p>Putting this all together yields the following iteration scheme:</p>
<ol>
<li>
<p>Compute policy <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mtext>ME</mtext></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi_{\text{ME}} (a_j \mid s_i, \omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ME</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span> the using current estimate of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span></span></span></span></span> via the backward pass, i.e., <a class="eq-ref" href="#eq:bwpass">Equations (6a–c)</a>.</p>
</li>
<li>
<p>Compute the state-visitation frequency <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><msub><mi>s</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">D_{s_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span></span></span></span></span> via the forward pass, i.e., <a class="eq-ref" href="#eq:fwpass">Equations (7a–c)</a>.</p>
</li>
<li>
<p>Compute the gradient <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∇</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \mathcal{L}(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∇</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span></span></span></span></span> via <a class="eq-ref" href="#eq:grad-b">Equation (5b)</a>.</p>
</li>
<li>
<p>Perform one gradient-based optimization step, e.g.,</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ω</mi><mo>←</mo><mi>ω</mi><mo>+</mo><mi>η</mi><mi mathvariant="normal">∇</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\omega \gets \omega + \eta \nabla \mathcal{L}(\omega).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mord">∇</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></div>
</li>
</ol>
<p>We then iterate these four steps until convergence.</p>
<div class="note"><p><strong>Note:</strong> You can find a Jupyter Notebook discussing a simple implementation of this algorithm (applied to a grid-world example) at <a href="https://github.com/qzed/irl-maxent">github.com/qzed/irl-maxent</a>.</p></div>
<h1 id="some-last-words"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#some-last-words">Some Last Words…</a></h1>
<p>Maximum entropy IRL is a clever and ― all in all ― fairly simple solution to the general inverse reinforcement learning problem.
However, it does have some drawbacks and limitations:</p>
<p>First and foremost, the algorithm as explained in this post requires us “solving” the MDP once per iteration.
As a result, it is fairly limited in the size of the discrete state-action-spaces that it can (reasonably) be applied to.
Extensions to continuous state spaces, for example via Monte-Carlo sampling or via path integrals, have been proposed <span class="csl-ref" id="csl-ref-a1hs1k4veqa"><a href="#csl-entry-aghasadeghiMaximumEntropyInverse2011">(see e.g., Aghasadeghi &amp; Bretl, 2011; Kalakrishnan et al., 2013)</a></span>.
However, the assumption that the transition dynamics of the environment, i.e., the probability distribution <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(s_{t+1} \mid s_t, a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, are known, further limits its applicability.</p>
<p>It also assumes a linear parametrization of the reward <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>ω</mi><mo>⊺</mo></msup><mi>ϕ</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(s) = \omega^\intercal \phi(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin amsrm mtight">⊺</span></span></span></span></span></span></span></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span>.
This can be somewhat mitigated by our choice of features <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span>, but feature expectation matching also only guarantees performance-parity with a linear reward parametrization.
An extension to model nonlinear reward functions via neural networks has been suggested by Wulfmeier et al. <span class="csl-ref" id="csl-ref-amftpgc0ih"><a href="#csl-entry-wulfmeierMaximumEntropyDeep2016">(2016)</a></span>.</p>
<p>Lastly, maximum entropy IRL is constrained to limited transition randomness, i.e., fairly deterministic transition dynamics <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∣</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(s_{t+1} \mid s_t, a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>.
As noted above, this is due to the reward bias introduced by our probability approximation and can be avoided via the maximum <em>causal</em> entropy IRL approach, proposed subsequently by Ziebart <span class="csl-ref" id="csl-ref-a25tmap8h3r"><a href="#csl-entry-ziebartModelingPurposefulAdaptive2010">(Ziebart, 2010; Ziebart et al., 2013)</a></span>.</p>
<p>A somewhat similar, yet model-free approach is relative entropy IRL by Boularias et al. <span class="csl-ref" id="csl-ref-a18ta7s8n1v"><a href="#csl-entry-boulariasRelativeEntropyInverse2011">(2011)</a></span>.
See the paper by Snoswell et al. <span class="csl-ref" id="csl-ref-a19fh547rgo"><a href="#csl-entry-snoswellRevisitingMaximumEntropy2020">(2020)</a></span> for a perspective on both relative and maximum entropy IRL approaches.</p>
<h1 id="references"><a class="autolink-anchor" aria-hidden="true" tabindex="-1" href="#references">References</a></h1>
<div class="csl-bib-body"><div class="csl-entry" id="csl-entry-abbeelApprenticeshipLearningInverse2004">Abbeel, P., &amp; Ng, A. Y. (2004). Apprenticeship learning via inverse reinforcement learning. <i>Twenty-First International Conference on Machine Learning - ICML ’04</i>. <a href="https://doi.org/10.1145/1015330.1015430">https://doi.org/10.1145/1015330.1015430</a></div><div class="csl-entry" id="csl-entry-aghasadeghiMaximumEntropyInverse2011">Aghasadeghi, N., &amp; Bretl, T. (2011). Maximum entropy inverse reinforcement learning in continuous state spaces with path integrals. <i>2011 IEEE/RSJ International Conference on Intelligent Robots and Systems</i>, 1561–1566. <a href="https://doi.org/10.1109/IROS.2011.6094679">https://doi.org/10.1109/IROS.2011.6094679</a></div><div class="csl-entry" id="csl-entry-bishopPatternRecognitionMachine2006">Bishop, C. M. (2006). <i>Pattern Recognition and Machine Learning</i>. Springer. <a href="https://link.springer.com/book/9780387310732">https://link.springer.com/book/9780387310732</a></div><div class="csl-entry" id="csl-entry-boulariasRelativeEntropyInverse2011">Boularias, A., Kober, J., &amp; Peters, J. (2011). Relative Entropy Inverse Reinforcement Learning. <i>Proceedings of the Fourteenth International Conference on Artificial Intelligence and Statistics</i>, 182–189. <a href="https://proceedings.mlr.press/v15/boularias11a.html">https://proceedings.mlr.press/v15/boularias11a.html</a></div><div class="csl-entry" id="csl-entry-jaynesInformationTheoryStatistical1957">Jaynes, E. T. (1957). Information Theory and Statistical Mechanics. <i>Physical Review</i>, <i>106</i>(4), 620–630. <a href="https://doi.org/10.1103/PhysRev.106.620">https://doi.org/10.1103/PhysRev.106.620</a></div><div class="csl-entry" id="csl-entry-kalakrishnanLearningObjectiveFunctions2013">Kalakrishnan, M., Pastor, P., Righetti, L., &amp; Schaal, S. (2013). Learning objective functions for manipulation. <i>2013 IEEE International Conference on Robotics and Automation</i>, 1331–1336. <a href="https://doi.org/10.1109/ICRA.2013.6630743">https://doi.org/10.1109/ICRA.2013.6630743</a></div><div class="csl-entry" id="csl-entry-ngPolicyInvarianceReward1999">Ng, A. Y., Harada, D., &amp; Russell, S. J. (1999). Policy Invariance Under Reward Transformations: Theory and Application to Reward Shaping. <i>Proceedings of the Sixteenth International Conference on Machine Learning</i>, 278–287. <a href="https://people.eecs.berkeley.edu/~pabbeel/cs287-fa09/readings/NgHaradaRussell-shaping-ICML1999.pdf">https://people.eecs.berkeley.edu/~pabbeel/cs287-fa09/readings/NgHaradaRussell-shaping-ICML1999.pdf</a></div><div class="csl-entry" id="csl-entry-osaAlgorithmicPerspectiveImitation2018">Osa, T., Pajarinen, J., Neumann, G., Bagnell, J. A., Abbeel, P., &amp; Peters, J. (2018). An Algorithmic Perspective on Imitation Learning. <i>Foundations and Trends in Robotics</i>, <i>7</i>(1–2), 1–179. <a href="https://doi.org/10.1561/2300000053">https://doi.org/10.1561/2300000053</a></div><div class="csl-entry" id="csl-entry-snoswellRevisitingMaximumEntropy2020">Snoswell, A. J., Singh, S. P. N., &amp; Ye, N. (2020). Revisiting Maximum Entropy Inverse Reinforcement Learning: New Perspectives and Algorithms. <i>2020 IEEE Symposium Series on Computational Intelligence (SSCI)</i>, 241–249. <a href="https://doi.org/10.1109/SSCI47803.2020.9308391">https://doi.org/10.1109/SSCI47803.2020.9308391</a></div><div class="csl-entry" id="csl-entry-wulfmeierMaximumEntropyDeep2016">Wulfmeier, M., Ondruska, P., &amp; Posner, I. (2016). <i>Maximum Entropy Deep Inverse Reinforcement Learning</i> (arXiv:1507.04888). <a href="https://doi.org/10.48550/arXiv.1507.04888">https://doi.org/10.48550/arXiv.1507.04888</a></div><div class="csl-entry" id="csl-entry-ziebartModelingPurposefulAdaptive2010">Ziebart, B. D. (2010). <i>Modeling purposeful adaptive behavior with the principle of maximum causal entropy</i> [Phd, Carnegie Mellon University]. <a href="https://www.cs.cmu.edu/~bziebart/publications/thesis-bziebart.pdf">https://www.cs.cmu.edu/~bziebart/publications/thesis-bziebart.pdf</a></div><div class="csl-entry" id="csl-entry-ziebartPrincipleMaximumCausal2013">Ziebart, B. D., Bagnell, J. A., &amp; Dey, A. K. (2013). The Principle of Maximum Causal Entropy for Estimating Interacting Processes. <i>IEEE Transactions on Information Theory</i>, <i>59</i>, 1966–1980. <a href="https://doi.org/10.1109/TIT.2012.2234824">https://doi.org/10.1109/TIT.2012.2234824</a></div><div class="csl-entry" id="csl-entry-ziebartMaximumEntropyInverse2008">Ziebart, B. D., Maas, A., Bagnell, J. A., &amp; Dey, A. K. (2008). Maximum Entropy Inverse Reinforcement Learning. <i>Proceedings of the 23rd National Conference on Artificial Intelligence - Volume 3</i>, 1433–1438. <a href="https://www.aaai.org/Library/AAAI/2008/aaai08-227.php">https://www.aaai.org/Library/AAAI/2008/aaai08-227.php</a></div></div></div></div></div></div></main><footer class="footer_footer__CKQ67">Copyright © 2022 Maximilian Luz</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"20220825-irl-maxent","title":"Maximum Entropy Inverse Reinforcement Learning","author":"Maximilian Luz","date":1661385600000,"abstract":"var Component=(()=\u003e{var g=Object.create;var s=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var c=(n,e)=\u003e()=\u003e(n\u0026\u0026(e=n(n=0)),e);var y=(n,e)=\u003e()=\u003e(e||n((e={exports:{}}).exports,e),e.exports),b=(n,e)=\u003e{for(var i in e)s(n,i,{get:e[i],enumerable:!0})},l=(n,e,i,m)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let r of u(e))!x.call(n,r)\u0026\u0026r!==i\u0026\u0026s(n,r,{get:()=\u003ee[r],enumerable:!(m=f(e,r))||m.enumerable});return n};var w=(n,e,i)=\u003e(i=n!=null?g(v(n)):{},l(e||!n||!n.__esModule?s(i,\"default\",{value:n,enumerable:!0}):i,n)),j=n=\u003el(s({},\"__esModule\",{value:!0}),n);var o=c(()=\u003e{});var a=c(()=\u003e{});var p=y((X,h)=\u003e{o();a();h.exports=_jsx_runtime});var M={};b(M,{default:()=\u003eR});o();a();var t=w(p());function d(n){let e=Object.assign({p:\"p\",em:\"em\"},n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.em,{children:\"Reinforcement learning (RL)\"}),` aims to provide a framework for finding the optimal behavior (i.e., an optimal policy) of intelligent agents regarding some environment they interact with by directing them via a reward signal, measuring their performance.\nWith the help of `,(0,t.jsx)(e.em,{children:\"inverse reinforcement learning (IRL)\"}),\" we can try to improve our agents by recovering the reward function (and therefore policy) of an expert, in essence using its domain knowledge for our needs.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.em,{children:\"Maximum entropy IRL\"}),` is a comparatively simple but clever method of solving the general IRL problem for discrete Markov decision processes.\nIn this blog post, I will lay out the theoretical foundation of this approach, including the principle of maximum entropy, and derive the maximum entropy IRL algorithm.`]})]})}function L(n={}){let{wrapper:e}=n.components||{};return e?(0,t.jsx)(e,Object.assign({},n,{children:(0,t.jsx)(d,n)})):d(n)}var R=L;return j(M);})();\n;return Component;","tags":["machine-learning","reinforcement-learning","inverse-reinforcement-learning"],"content":"var Component=(()=\u003e{var ji=Object.create;var Xa=Object.defineProperty;var Gi=Object.getOwnPropertyDescriptor;var _i=Object.getOwnPropertyNames;var Vi=Object.getPrototypeOf,Zi=Object.prototype.hasOwnProperty;var Rn=(G,e)=\u003e()=\u003e(G\u0026\u0026(e=G(G=0)),e);var An=(G,e)=\u003e()=\u003e(e||G((e={exports:{}}).exports,e),e.exports),Ui=(G,e)=\u003e{for(var ae in e)Xa(G,ae,{get:e[ae],enumerable:!0})},Sn=(G,e,ae,A)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let $e of _i(e))!Zi.call(G,$e)\u0026\u0026$e!==ae\u0026\u0026Xa(G,$e,{get:()=\u003ee[$e],enumerable:!(A=Gi(e,$e))||A.enumerable});return G};var Ln=(G,e,ae)=\u003e(ae=G!=null?ji(Vi(G)):{},Sn(e||!G||!G.__esModule?Xa(ae,\"default\",{value:G,enumerable:!0}):ae,G)),Wi=G=\u003eSn(Xa({},\"__esModule\",{value:!0}),G);var ze=Rn(()=\u003e{});var Me=Rn(()=\u003e{});var Tn=An((ir,Bn)=\u003e{ze();Me();Bn.exports=_jsx_runtime});var Dn=An((xa,Vs)=\u003e{ze();Me();(function(e,ae){typeof xa==\"object\"\u0026\u0026typeof Vs==\"object\"?Vs.exports=ae():typeof define==\"function\"\u0026\u0026define.amd?define([],ae):typeof xa==\"object\"?xa.katex=ae():e.katex=ae()})(typeof self\u003c\"u\"?self:xa,function(){return function(){\"use strict\";var G={};(function(){G.d=function(m,s){for(var t in s)G.o(s,t)\u0026\u0026!G.o(m,t)\u0026\u0026Object.defineProperty(m,t,{enumerable:!0,get:s[t]})}})(),function(){G.o=function(m,s){return Object.prototype.hasOwnProperty.call(m,s)}}();var e={};G.d(e,{default:function(){return Fi}});var ae=function m(s,t){this.position=void 0;var n=\"KaTeX parse error: \"+s,l,i=t\u0026\u0026t.loc;if(i\u0026\u0026i.start\u003c=i.end){var c=i.lexer.input;l=i.start;var d=i.end;l===c.length?n+=\" at end of input: \":n+=\" at position \"+(l+1)+\": \";var o=c.slice(l,d).replace(/[^]/g,\"$\u0026\\u0332\"),g;l\u003e15?g=\"\\u2026\"+c.slice(l-15,l):g=c.slice(0,l);var y;d+15\u003cc.length?y=c.slice(d,d+15)+\"\\u2026\":y=c.slice(d),n+=g+o+y}var x=new Error(n);return x.name=\"ParseError\",x.__proto__=m.prototype,x.position=l,x};ae.prototype.__proto__=Error.prototype;var A=ae,$e=function(s,t){return s.indexOf(t)!==-1},qn=function(s,t){return s===void 0?t:s},In=/([A-Z])/g,Fn=function(s){return s.replace(In,\"-$1\").toLowerCase()},On={\"\u0026\":\"\u0026amp;\",\"\u003e\":\"\u0026gt;\",\"\u003c\":\"\u0026lt;\",'\"':\"\u0026quot;\",\"'\":\"\u0026#x27;\"},Hn=/[\u0026\u003e\u003c\"']/g;function Pn(m){return String(m).replace(Hn,function(s){return On[s]})}var Zs=function m(s){return s.type===\"ordgroup\"||s.type===\"color\"?s.body.length===1?m(s.body[0]):s:s.type===\"font\"?m(s.body):s},jn=function(s){var t=Zs(s);return t.type===\"mathord\"||t.type===\"textord\"||t.type===\"atom\"},Gn=function(s){if(!s)throw new Error(\"Expected non-null, but got \"+String(s));return s},_n=function(s){var t=/^\\s*([^\\\\/#]*?)(?::|\u0026#0*58|\u0026#x0*3a)/i.exec(s);return t!=null?t[1]:\"_relative\"},O={contains:$e,deflt:qn,escape:Pn,hyphenate:Fn,getBaseElem:Zs,isCharacterBox:jn,protocolFromUrl:_n},wa={displayMode:{type:\"boolean\",description:\"Render math in display mode, which puts the math in display style (so \\\\int and \\\\sum are large, for example), and centers the math on the page on its own line.\",cli:\"-d, --display-mode\"},output:{type:{enum:[\"htmlAndMathml\",\"html\",\"mathml\"]},description:\"Determines the markup language of the output.\",cli:\"-F, --format \u003ctype\u003e\"},leqno:{type:\"boolean\",description:\"Render display math in leqno style (left-justified tags).\"},fleqn:{type:\"boolean\",description:\"Render display math flush left.\"},throwOnError:{type:\"boolean\",default:!0,cli:\"-t, --no-throw-on-error\",cliDescription:\"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error.\"},errorColor:{type:\"string\",default:\"#cc0000\",cli:\"-c, --error-color \u003ccolor\u003e\",cliDescription:\"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.\",cliProcessor:function(s){return\"#\"+s}},macros:{type:\"object\",cli:\"-m, --macro \u003cdef\u003e\",cliDescription:\"Define custom macro of the form '\\\\foo:expansion' (use multiple -m arguments for multiple macros).\",cliDefault:[],cliProcessor:function(s,t){return t.push(s),t}},minRuleThickness:{type:\"number\",description:\"Specifies a minimum thickness, in ems, for fraction lines, `\\\\sqrt` top lines, `{array}` vertical lines, `\\\\hline`, `\\\\hdashline`, `\\\\underline`, `\\\\overline`, and the borders of `\\\\fbox`, `\\\\boxed`, and `\\\\fcolorbox`.\",processor:function(s){return Math.max(0,s)},cli:\"--min-rule-thickness \u003csize\u003e\",cliProcessor:parseFloat},colorIsTextColor:{type:\"boolean\",description:\"Makes \\\\color behave like LaTeX's 2-argument \\\\textcolor, instead of LaTeX's one-argument \\\\color mode change.\",cli:\"-b, --color-is-text-color\"},strict:{type:[{enum:[\"warn\",\"ignore\",\"error\"]},\"boolean\",\"function\"],description:\"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.\",cli:\"-S, --strict\",cliDefault:!1},trust:{type:[\"boolean\",\"function\"],description:\"Trust the input, enabling all HTML features such as \\\\url.\",cli:\"-T, --trust\"},maxSize:{type:\"number\",default:1/0,description:\"If non-zero, all user-specified sizes, e.g. in \\\\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large\",processor:function(s){return Math.max(0,s)},cli:\"-s, --max-size \u003cn\u003e\",cliProcessor:parseInt},maxExpand:{type:\"number\",default:1e3,description:\"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.\",processor:function(s){return Math.max(0,s)},cli:\"-e, --max-expand \u003cn\u003e\",cliProcessor:function(s){return s===\"Infinity\"?1/0:parseInt(s)}},globalGroup:{type:\"boolean\",cli:!1}};function Vn(m){if(m.default)return m.default;var s=m.type,t=Array.isArray(s)?s[0]:s;if(typeof t!=\"string\")return t.enum[0];switch(t){case\"boolean\":return!1;case\"string\":return\"\";case\"number\":return 0;case\"object\":return{}}}var Ja=function(){function m(t){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,t=t||{};for(var n in wa)if(wa.hasOwnProperty(n)){var l=wa[n];this[n]=t[n]!==void 0?l.processor?l.processor(t[n]):t[n]:Vn(l)}}var s=m.prototype;return s.reportNonstrict=function(n,l,i){var c=this.strict;if(typeof c==\"function\"\u0026\u0026(c=c(n,l,i)),!(!c||c===\"ignore\")){if(c===!0||c===\"error\")throw new A(\"LaTeX-incompatible input and strict mode is set to 'error': \"+(l+\" [\"+n+\"]\"),i);c===\"warn\"?typeof console\u003c\"u\"\u0026\u0026console.warn(\"LaTeX-incompatible input and strict mode is set to 'warn': \"+(l+\" [\"+n+\"]\")):typeof console\u003c\"u\"\u0026\u0026console.warn(\"LaTeX-incompatible input and strict mode is set to \"+(\"unrecognized '\"+c+\"': \"+l+\" [\"+n+\"]\"))}},s.useStrictBehavior=function(n,l,i){var c=this.strict;if(typeof c==\"function\")try{c=c(n,l,i)}catch{c=\"error\"}return!c||c===\"ignore\"?!1:c===!0||c===\"error\"?!0:c===\"warn\"?(typeof console\u003c\"u\"\u0026\u0026console.warn(\"LaTeX-incompatible input and strict mode is set to 'warn': \"+(l+\" [\"+n+\"]\")),!1):(typeof console\u003c\"u\"\u0026\u0026console.warn(\"LaTeX-incompatible input and strict mode is set to \"+(\"unrecognized '\"+c+\"': \"+l+\" [\"+n+\"]\")),!1)},s.isTrusted=function(n){n.url\u0026\u0026!n.protocol\u0026\u0026(n.protocol=O.protocolFromUrl(n.url));var l=typeof this.trust==\"function\"?this.trust(n):this.trust;return Boolean(l)},m}(),He=function(){function m(t,n,l){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=t,this.size=n,this.cramped=l}var s=m.prototype;return s.sup=function(){return Re[Zn[this.id]]},s.sub=function(){return Re[Un[this.id]]},s.fracNum=function(){return Re[Wn[this.id]]},s.fracDen=function(){return Re[Xn[this.id]]},s.cramp=function(){return Re[Yn[this.id]]},s.text=function(){return Re[$n[this.id]]},s.isTight=function(){return this.size\u003e=2},m}(),Ka=0,ka=1,aa=2,De=3,da=4,Ne=5,sa=6,me=7,Re=[new He(Ka,0,!1),new He(ka,0,!0),new He(aa,1,!1),new He(De,1,!0),new He(da,2,!1),new He(Ne,2,!0),new He(sa,3,!1),new He(me,3,!0)],Zn=[da,Ne,da,Ne,sa,me,sa,me],Un=[Ne,Ne,Ne,Ne,me,me,me,me],Wn=[aa,De,da,Ne,sa,me,sa,me],Xn=[De,De,Ne,Ne,me,me,me,me],Yn=[ka,ka,De,De,Ne,Ne,me,me],$n=[Ka,ka,aa,De,aa,De,aa,De],I={DISPLAY:Re[Ka],TEXT:Re[aa],SCRIPT:Re[da],SCRIPTSCRIPT:Re[sa]},Qa=[{name:\"latin\",blocks:[[256,591],[768,879]]},{name:\"cyrillic\",blocks:[[1024,1279]]},{name:\"armenian\",blocks:[[1328,1423]]},{name:\"brahmic\",blocks:[[2304,4255]]},{name:\"georgian\",blocks:[[4256,4351]]},{name:\"cjk\",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:\"hangul\",blocks:[[44032,55215]]}];function Jn(m){for(var s=0;s\u003cQa.length;s++)for(var t=Qa[s],n=0;n\u003ct.blocks.length;n++){var l=t.blocks[n];if(m\u003e=l[0]\u0026\u0026m\u003c=l[1])return t.name}return null}var pa=[];Qa.forEach(function(m){return m.blocks.forEach(function(s){return pa.push.apply(pa,s)})});function Us(m){for(var s=0;s\u003cpa.length;s+=2)if(m\u003e=pa[s]\u0026\u0026m\u003c=pa[s+1])return!0;return!1}var ta=80,Kn=function(s,t){return\"M95,\"+(622+s+t)+`\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl`+s/2.075+\" -\"+s+`\nc5.3,-9.3,12,-14,20,-14\nH400000v`+(40+s)+`H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM`+(834+s)+\" \"+t+\"h400000v\"+(40+s)+\"h-400000z\"},Qn=function(s,t){return\"M263,\"+(601+s+t)+`c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl`+s/2.084+\" -\"+s+`\nc4.7,-7.3,11,-11,19,-11\nH40000v`+(40+s)+`H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM`+(1001+s)+\" \"+t+\"h400000v\"+(40+s)+\"h-400000z\"},el=function(s,t){return\"M983 \"+(10+s+t)+`\nl`+s/3.13+\" -\"+s+`\nc4,-6.7,10,-10,18,-10 H400000v`+(40+s)+`\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM`+(1001+s)+\" \"+t+\"h400000v\"+(40+s)+\"h-400000z\"},al=function(s,t){return\"M424,\"+(2398+s+t)+`\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl`+s/4.223+\" -\"+s+`c4,-6.7,10,-10,18,-10 H400000\nv`+(40+s)+`H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M`+(1001+s)+\" \"+t+`\nh400000v`+(40+s)+\"h-400000z\"},sl=function(s,t){return\"M473,\"+(2713+s+t)+`\nc339.3,-1799.3,509.3,-2700,510,-2702 l`+s/5.298+\" -\"+s+`\nc3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+s)+`H1017.7\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\n606zM`+(1001+s)+\" \"+t+\"h400000v\"+(40+s)+\"H1017.7z\"},tl=function(s){var t=s/2;return\"M400000 \"+s+\" H0 L\"+t+\" 0 l65 45 L145 \"+(s-80)+\" H400000z\"},nl=function(s,t,n){var l=n-54-t-s;return\"M702 \"+(s+t)+\"H400000\"+(40+s)+`\nH742v`+l+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 `+t+\"H400000v\"+(40+s)+\"H742z\"},ll=function(s,t,n){t=1e3*t;var l=\"\";switch(s){case\"sqrtMain\":l=Kn(t,ta);break;case\"sqrtSize1\":l=Qn(t,ta);break;case\"sqrtSize2\":l=el(t,ta);break;case\"sqrtSize3\":l=al(t,ta);break;case\"sqrtSize4\":l=sl(t,ta);break;case\"sqrtTall\":l=nl(t,ta,n)}return l},il=function(s,t){switch(s){case\"\\u239C\":return\"M291 0 H417 V\"+t+\" H291z M291 0 H417 V\"+t+\" H291z\";case\"\\u2223\":return\"M145 0 H188 V\"+t+\" H145z M145 0 H188 V\"+t+\" H145z\";case\"\\u2225\":return\"M145 0 H188 V\"+t+\" H145z M145 0 H188 V\"+t+\" H145z\"+(\"M367 0 H410 V\"+t+\" H367z M367 0 H410 V\"+t+\" H367z\");case\"\\u239F\":return\"M457 0 H583 V\"+t+\" H457z M457 0 H583 V\"+t+\" H457z\";case\"\\u23A2\":return\"M319 0 H403 V\"+t+\" H319z M319 0 H403 V\"+t+\" H319z\";case\"\\u23A5\":return\"M263 0 H347 V\"+t+\" H263z M263 0 H347 V\"+t+\" H263z\";case\"\\u23AA\":return\"M384 0 H504 V\"+t+\" H384z M384 0 H504 V\"+t+\" H384z\";case\"\\u23D0\":return\"M312 0 H355 V\"+t+\" H312z M312 0 H355 V\"+t+\" H312z\";case\"\\u2016\":return\"M257 0 H300 V\"+t+\" H257z M257 0 H300 V\"+t+\" H257z\"+(\"M478 0 H521 V\"+t+\" H478z M478 0 H521 V\"+t+\" H478z\");default:return\"\"}},Ws={doubleleftarrow:`M262 157\nl10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3\n 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28\n 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5\nc2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5\n 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87\n-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7\n-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z\nm8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l\n-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5\n 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88\n-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68\n-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18\n-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782\nc-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3\n-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120\n 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8\n-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247\nc-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208\n 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3\n 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202\n l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80\nH435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0\n 435 0h399565z`,leftgroupunder:`M400000 262\nH435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219\n 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3\n-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5\n-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7\n-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5\n 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3\n-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7\n-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z\nm0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333\n 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5\n 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667\n-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12\n 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7\n-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0\nv40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5\n-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3\n-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21\n 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z\nM40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z\nM40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23\n-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8\nc28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3\n 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z\nM0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6\n-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z\nm368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8\n60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8\n-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z\nm502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2\nc0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6\n-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z\nm525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0\n85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8\n-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z\nm770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1\nc0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0\n 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18\n 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3\n-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2\n-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58\n 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11\n-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7\n 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z\nm0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8\n 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5\n-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95\n-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8\n 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3\n 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3\n-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z\nm0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3\n 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0\n-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21\n 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z\nM399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23\n 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32\n-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142\n-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40\n 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69\n-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3\n-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19\n-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101\n 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167\nc-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3\n 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42\n 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333\n-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70\n 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7\n-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0\n 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0\n 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128\n-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418\n-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9\n 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114\nc1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751\n 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457\n-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0\n 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697\n 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696\n -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345\n-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409\n 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9\n 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409\n -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,\n-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202\nc4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5\nc-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130\ns-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47\n121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6\ns2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11\nc0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z\nM100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32\n-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0\n13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39\n-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5\n-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17\nc2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21\nc-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40\nc-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z\nM0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\nM0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,\n1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,\n-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z\nM93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\nM500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},rl=function(s,t){switch(s){case\"lbrack\":return\"M403 1759 V84 H666 V0 H319 V1759 v\"+t+` v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v`+t+\" v1759 h84z\";case\"rbrack\":return\"M347 1759 V0 H0 V84 H263 V1759 v\"+t+` v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v`+t+\" v1759 h84z\";case\"vert\":return\"M145 15 v585 v\"+t+` v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+t+\" v585 h43z\";case\"doublevert\":return\"M145 15 v585 v\"+t+` v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+t+` v585 h43z\nM367 15 v585 v`+t+` v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+t+\" v585 h43z\";case\"lfloor\":return\"M319 602 V0 H403 V602 v\"+t+` v1715 h263 v84 H319z\nMM319 602 V0 H403 V602 v`+t+\" v1715 H319z\";case\"rfloor\":return\"M319 602 V0 H403 V602 v\"+t+` v1799 H0 v-84 H319z\nMM319 602 V0 H403 V602 v`+t+\" v1715 H319z\";case\"lceil\":return\"M403 1759 V84 H666 V0 H319 V1759 v\"+t+` v602 h84z\nM403 1759 V0 H319 V1759 v`+t+\" v602 h84z\";case\"rceil\":return\"M347 1759 V0 H0 V84 H263 V1759 v\"+t+` v602 h84z\nM347 1759 V0 h-84 V1759 v`+t+\" v602 h84z\";case\"lparen\":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\n-36,557 l0,`+(t+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\nl0,-`+(t+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case\"rparen\":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(t+9)+`\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\nl0,-`+(t+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error(\"Unknown stretchy delimiter.\")}},oa=function(){function m(t){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=t,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}var s=m.prototype;return s.hasClass=function(n){return O.contains(this.classes,n)},s.toNode=function(){for(var n=document.createDocumentFragment(),l=0;l\u003cthis.children.length;l++)n.appendChild(this.children[l].toNode());return n},s.toMarkup=function(){for(var n=\"\",l=0;l\u003cthis.children.length;l++)n+=this.children[l].toMarkup();return n},s.toText=function(){var n=function(i){return i.toText()};return this.children.map(n).join(\"\")},m}(),Ae={\"AMS-Regular\":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},\"Caligraphic-Regular\":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},\"Fraktur-Regular\":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},\"Main-Bold\":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},\"Main-BoldItalic\":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},\"Main-Italic\":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},\"Main-Regular\":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},\"Math-BoldItalic\":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},\"Math-Italic\":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},\"SansSerif-Bold\":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},\"SansSerif-Italic\":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},\"SansSerif-Regular\":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},\"Script-Regular\":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},\"Size1-Regular\":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},\"Size2-Regular\":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},\"Size3-Regular\":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},\"Size4-Regular\":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},\"Typewriter-Regular\":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},za={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},Xs={\\u00C5:\"A\",\\u00D0:\"D\",\\u00DE:\"o\",\\u00E5:\"a\",\\u00F0:\"d\",\\u00FE:\"o\",\\u0410:\"A\",\\u0411:\"B\",\\u0412:\"B\",\\u0413:\"F\",\\u0414:\"A\",\\u0415:\"E\",\\u0416:\"K\",\\u0417:\"3\",\\u0418:\"N\",\\u0419:\"N\",\\u041A:\"K\",\\u041B:\"N\",\\u041C:\"M\",\\u041D:\"H\",\\u041E:\"O\",\\u041F:\"N\",\\u0420:\"P\",\\u0421:\"C\",\\u0422:\"T\",\\u0423:\"y\",\\u0424:\"O\",\\u0425:\"X\",\\u0426:\"U\",\\u0427:\"h\",\\u0428:\"W\",\\u0429:\"W\",\\u042A:\"B\",\\u042B:\"X\",\\u042C:\"B\",\\u042D:\"3\",\\u042E:\"X\",\\u042F:\"R\",\\u0430:\"a\",\\u0431:\"b\",\\u0432:\"a\",\\u0433:\"r\",\\u0434:\"y\",\\u0435:\"e\",\\u0436:\"m\",\\u0437:\"e\",\\u0438:\"n\",\\u0439:\"n\",\\u043A:\"n\",\\u043B:\"n\",\\u043C:\"m\",\\u043D:\"n\",\\u043E:\"o\",\\u043F:\"n\",\\u0440:\"p\",\\u0441:\"c\",\\u0442:\"o\",\\u0443:\"y\",\\u0444:\"b\",\\u0445:\"x\",\\u0446:\"n\",\\u0447:\"n\",\\u0448:\"w\",\\u0449:\"w\",\\u044A:\"a\",\\u044B:\"m\",\\u044C:\"a\",\\u044D:\"e\",\\u044E:\"m\",\\u044F:\"r\"};function ml(m,s){Ae[m]=s}function es(m,s,t){if(!Ae[s])throw new Error(\"Font metrics not found for font: \"+s+\".\");var n=m.charCodeAt(0),l=Ae[s][n];if(!l\u0026\u0026m[0]in Xs\u0026\u0026(n=Xs[m[0]].charCodeAt(0),l=Ae[s][n]),!l\u0026\u0026t===\"text\"\u0026\u0026Us(n)\u0026\u0026(l=Ae[s][77]),l)return{depth:l[0],height:l[1],italic:l[2],skew:l[3],width:l[4]}}var as={};function cl(m){var s;if(m\u003e=5?s=0:m\u003e=3?s=1:s=2,!as[s]){var t=as[s]={cssEmPerMu:za.quad[s]/18};for(var n in za)za.hasOwnProperty(n)\u0026\u0026(t[n]=za[n][s])}return as[s]}var hl=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],Ys=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],$s=function(s,t){return t.size\u003c2?s:hl[s-1][t.size-1]},Js=function(){function m(t){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=t.style,this.color=t.color,this.size=t.size||m.BASESIZE,this.textSize=t.textSize||this.size,this.phantom=!!t.phantom,this.font=t.font||\"\",this.fontFamily=t.fontFamily||\"\",this.fontWeight=t.fontWeight||\"\",this.fontShape=t.fontShape||\"\",this.sizeMultiplier=Ys[this.size-1],this.maxSize=t.maxSize,this.minRuleThickness=t.minRuleThickness,this._fontMetrics=void 0}var s=m.prototype;return s.extend=function(n){var l={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var i in n)n.hasOwnProperty(i)\u0026\u0026(l[i]=n[i]);return new m(l)},s.havingStyle=function(n){return this.style===n?this:this.extend({style:n,size:$s(this.textSize,n)})},s.havingCrampedStyle=function(){return this.havingStyle(this.style.cramp())},s.havingSize=function(n){return this.size===n\u0026\u0026this.textSize===n?this:this.extend({style:this.style.text(),size:n,textSize:n,sizeMultiplier:Ys[n-1]})},s.havingBaseStyle=function(n){n=n||this.style.text();var l=$s(m.BASESIZE,n);return this.size===l\u0026\u0026this.textSize===m.BASESIZE\u0026\u0026this.style===n?this:this.extend({style:n,size:l})},s.havingBaseSizing=function(){var n;switch(this.style.id){case 4:case 5:n=3;break;case 6:case 7:n=1;break;default:n=6}return this.extend({style:this.style.text(),size:n})},s.withColor=function(n){return this.extend({color:n})},s.withPhantom=function(){return this.extend({phantom:!0})},s.withFont=function(n){return this.extend({font:n})},s.withTextFontFamily=function(n){return this.extend({fontFamily:n,font:\"\"})},s.withTextFontWeight=function(n){return this.extend({fontWeight:n,font:\"\"})},s.withTextFontShape=function(n){return this.extend({fontShape:n,font:\"\"})},s.sizingClasses=function(n){return n.size!==this.size?[\"sizing\",\"reset-size\"+n.size,\"size\"+this.size]:[]},s.baseSizingClasses=function(){return this.size!==m.BASESIZE?[\"sizing\",\"reset-size\"+this.size,\"size\"+m.BASESIZE]:[]},s.fontMetrics=function(){return this._fontMetrics||(this._fontMetrics=cl(this.size)),this._fontMetrics},s.getColor=function(){return this.phantom?\"transparent\":this.color},m}();Js.BASESIZE=6;var dl=Js,ss={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},pl={ex:!0,em:!0,mu:!0},Ks=function(s){return typeof s!=\"string\"\u0026\u0026(s=s.unit),s in ss||s in pl||s===\"ex\"},J=function(s,t){var n;if(s.unit in ss)n=ss[s.unit]/t.fontMetrics().ptPerEm/t.sizeMultiplier;else if(s.unit===\"mu\")n=t.fontMetrics().cssEmPerMu;else{var l;if(t.style.isTight()?l=t.havingStyle(t.style.text()):l=t,s.unit===\"ex\")n=l.fontMetrics().xHeight;else if(s.unit===\"em\")n=l.fontMetrics().quad;else throw new A(\"Invalid unit: '\"+s.unit+\"'\");l!==t\u0026\u0026(n*=l.sizeMultiplier/t.sizeMultiplier)}return Math.min(s.number*n,t.maxSize)},L=function(s){return+s.toFixed(4)+\"em\"},Pe=function(s){return s.filter(function(t){return t}).join(\" \")},Qs=function(s,t,n){if(this.classes=s||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=n||{},t){t.style.isTight()\u0026\u0026this.classes.push(\"mtight\");var l=t.getColor();l\u0026\u0026(this.style.color=l)}},et=function(s){var t=document.createElement(s);t.className=Pe(this.classes);for(var n in this.style)this.style.hasOwnProperty(n)\u0026\u0026(t.style[n]=this.style[n]);for(var l in this.attributes)this.attributes.hasOwnProperty(l)\u0026\u0026t.setAttribute(l,this.attributes[l]);for(var i=0;i\u003cthis.children.length;i++)t.appendChild(this.children[i].toNode());return t},at=function(s){var t=\"\u003c\"+s;this.classes.length\u0026\u0026(t+=' class=\"'+O.escape(Pe(this.classes))+'\"');var n=\"\";for(var l in this.style)this.style.hasOwnProperty(l)\u0026\u0026(n+=O.hyphenate(l)+\":\"+this.style[l]+\";\");n\u0026\u0026(t+=' style=\"'+O.escape(n)+'\"');for(var i in this.attributes)this.attributes.hasOwnProperty(i)\u0026\u0026(t+=\" \"+i+'=\"'+O.escape(this.attributes[i])+'\"');t+=\"\u003e\";for(var c=0;c\u003cthis.children.length;c++)t+=this.children[c].toMarkup();return t+=\"\u003c/\"+s+\"\u003e\",t},ua=function(){function m(t,n,l,i){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,Qs.call(this,t,l,i),this.children=n||[]}var s=m.prototype;return s.setAttribute=function(n,l){this.attributes[n]=l},s.hasClass=function(n){return O.contains(this.classes,n)},s.toNode=function(){return et.call(this,\"span\")},s.toMarkup=function(){return at.call(this,\"span\")},m}(),ts=function(){function m(t,n,l,i){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,Qs.call(this,n,i),this.children=l||[],this.setAttribute(\"href\",t)}var s=m.prototype;return s.setAttribute=function(n,l){this.attributes[n]=l},s.hasClass=function(n){return O.contains(this.classes,n)},s.toNode=function(){return et.call(this,\"a\")},s.toMarkup=function(){return at.call(this,\"a\")},m}(),ol=function(){function m(t,n,l){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=n,this.src=t,this.classes=[\"mord\"],this.style=l}var s=m.prototype;return s.hasClass=function(n){return O.contains(this.classes,n)},s.toNode=function(){var n=document.createElement(\"img\");n.src=this.src,n.alt=this.alt,n.className=\"mord\";for(var l in this.style)this.style.hasOwnProperty(l)\u0026\u0026(n.style[l]=this.style[l]);return n},s.toMarkup=function(){var n=\"\u003cimg  src='\"+this.src+\" 'alt='\"+this.alt+\"' \",l=\"\";for(var i in this.style)this.style.hasOwnProperty(i)\u0026\u0026(l+=O.hyphenate(i)+\":\"+this.style[i]+\";\");return l\u0026\u0026(n+=' style=\"'+O.escape(l)+'\"'),n+=\"'/\u003e\",n},m}(),ul={\\u00EE:\"\\u0131\\u0302\",\\u00EF:\"\\u0131\\u0308\",\\u00ED:\"\\u0131\\u0301\",\\u00EC:\"\\u0131\\u0300\"},ve=function(){function m(t,n,l,i,c,d,o,g){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=t,this.height=n||0,this.depth=l||0,this.italic=i||0,this.skew=c||0,this.width=d||0,this.classes=o||[],this.style=g||{},this.maxFontSize=0;var y=Jn(this.text.charCodeAt(0));y\u0026\u0026this.classes.push(y+\"_fallback\"),/[îïíì]/.test(this.text)\u0026\u0026(this.text=ul[this.text])}var s=m.prototype;return s.hasClass=function(n){return O.contains(this.classes,n)},s.toNode=function(){var n=document.createTextNode(this.text),l=null;this.italic\u003e0\u0026\u0026(l=document.createElement(\"span\"),l.style.marginRight=L(this.italic)),this.classes.length\u003e0\u0026\u0026(l=l||document.createElement(\"span\"),l.className=Pe(this.classes));for(var i in this.style)this.style.hasOwnProperty(i)\u0026\u0026(l=l||document.createElement(\"span\"),l.style[i]=this.style[i]);return l?(l.appendChild(n),l):n},s.toMarkup=function(){var n=!1,l=\"\u003cspan\";this.classes.length\u0026\u0026(n=!0,l+=' class=\"',l+=O.escape(Pe(this.classes)),l+='\"');var i=\"\";this.italic\u003e0\u0026\u0026(i+=\"margin-right:\"+this.italic+\"em;\");for(var c in this.style)this.style.hasOwnProperty(c)\u0026\u0026(i+=O.hyphenate(c)+\":\"+this.style[c]+\";\");i\u0026\u0026(n=!0,l+=' style=\"'+O.escape(i)+'\"');var d=O.escape(this.text);return n?(l+=\"\u003e\",l+=d,l+=\"\u003c/span\u003e\",l):d},m}(),Ce=function(){function m(t,n){this.children=void 0,this.attributes=void 0,this.children=t||[],this.attributes=n||{}}var s=m.prototype;return s.toNode=function(){var n=\"http://www.w3.org/2000/svg\",l=document.createElementNS(n,\"svg\");for(var i in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,i)\u0026\u0026l.setAttribute(i,this.attributes[i]);for(var c=0;c\u003cthis.children.length;c++)l.appendChild(this.children[c].toNode());return l},s.toMarkup=function(){var n='\u003csvg xmlns=\"http://www.w3.org/2000/svg\"';for(var l in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,l)\u0026\u0026(n+=\" \"+l+\"='\"+this.attributes[l]+\"'\");n+=\"\u003e\";for(var i=0;i\u003cthis.children.length;i++)n+=this.children[i].toMarkup();return n+=\"\u003c/svg\u003e\",n},m}(),je=function(){function m(t,n){this.pathName=void 0,this.alternate=void 0,this.pathName=t,this.alternate=n}var s=m.prototype;return s.toNode=function(){var n=\"http://www.w3.org/2000/svg\",l=document.createElementNS(n,\"path\");return this.alternate?l.setAttribute(\"d\",this.alternate):l.setAttribute(\"d\",Ws[this.pathName]),l},s.toMarkup=function(){return this.alternate?\"\u003cpath d='\"+this.alternate+\"'/\u003e\":\"\u003cpath d='\"+Ws[this.pathName]+\"'/\u003e\"},m}(),ns=function(){function m(t){this.attributes=void 0,this.attributes=t||{}}var s=m.prototype;return s.toNode=function(){var n=\"http://www.w3.org/2000/svg\",l=document.createElementNS(n,\"line\");for(var i in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,i)\u0026\u0026l.setAttribute(i,this.attributes[i]);return l},s.toMarkup=function(){var n=\"\u003cline\";for(var l in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,l)\u0026\u0026(n+=\" \"+l+\"='\"+this.attributes[l]+\"'\");return n+=\"/\u003e\",n},m}();function st(m){if(m instanceof ve)return m;throw new Error(\"Expected symbolNode but got \"+String(m)+\".\")}function gl(m){if(m instanceof ua)return m;throw new Error(\"Expected span\u003cHtmlDomNode\u003e but got \"+String(m)+\".\")}var Nl={bin:1,close:1,inner:1,open:1,punct:1,rel:1},vl={\"accent-token\":1,mathord:1,\"op-token\":1,spacing:1,textord:1},Ma={math:{},text:{}},K=Ma;function r(m,s,t,n,l,i){Ma[m][l]={font:s,group:t,replace:n},i\u0026\u0026n\u0026\u0026(Ma[m][n]=Ma[m][l])}var h=\"math\",M=\"text\",p=\"main\",N=\"ams\",$=\"accent-token\",D=\"bin\",ce=\"close\",na=\"inner\",F=\"mathord\",te=\"op-token\",ue=\"open\",Ra=\"punct\",v=\"rel\",Ee=\"spacing\",f=\"textord\";r(h,p,v,\"\\u2261\",\"\\\\equiv\",!0),r(h,p,v,\"\\u227A\",\"\\\\prec\",!0),r(h,p,v,\"\\u227B\",\"\\\\succ\",!0),r(h,p,v,\"\\u223C\",\"\\\\sim\",!0),r(h,p,v,\"\\u22A5\",\"\\\\perp\"),r(h,p,v,\"\\u2AAF\",\"\\\\preceq\",!0),r(h,p,v,\"\\u2AB0\",\"\\\\succeq\",!0),r(h,p,v,\"\\u2243\",\"\\\\simeq\",!0),r(h,p,v,\"\\u2223\",\"\\\\mid\",!0),r(h,p,v,\"\\u226A\",\"\\\\ll\",!0),r(h,p,v,\"\\u226B\",\"\\\\gg\",!0),r(h,p,v,\"\\u224D\",\"\\\\asymp\",!0),r(h,p,v,\"\\u2225\",\"\\\\parallel\"),r(h,p,v,\"\\u22C8\",\"\\\\bowtie\",!0),r(h,p,v,\"\\u2323\",\"\\\\smile\",!0),r(h,p,v,\"\\u2291\",\"\\\\sqsubseteq\",!0),r(h,p,v,\"\\u2292\",\"\\\\sqsupseteq\",!0),r(h,p,v,\"\\u2250\",\"\\\\doteq\",!0),r(h,p,v,\"\\u2322\",\"\\\\frown\",!0),r(h,p,v,\"\\u220B\",\"\\\\ni\",!0),r(h,p,v,\"\\u221D\",\"\\\\propto\",!0),r(h,p,v,\"\\u22A2\",\"\\\\vdash\",!0),r(h,p,v,\"\\u22A3\",\"\\\\dashv\",!0),r(h,p,v,\"\\u220B\",\"\\\\owns\"),r(h,p,Ra,\".\",\"\\\\ldotp\"),r(h,p,Ra,\"\\u22C5\",\"\\\\cdotp\"),r(h,p,f,\"#\",\"\\\\#\"),r(M,p,f,\"#\",\"\\\\#\"),r(h,p,f,\"\u0026\",\"\\\\\u0026\"),r(M,p,f,\"\u0026\",\"\\\\\u0026\"),r(h,p,f,\"\\u2135\",\"\\\\aleph\",!0),r(h,p,f,\"\\u2200\",\"\\\\forall\",!0),r(h,p,f,\"\\u210F\",\"\\\\hbar\",!0),r(h,p,f,\"\\u2203\",\"\\\\exists\",!0),r(h,p,f,\"\\u2207\",\"\\\\nabla\",!0),r(h,p,f,\"\\u266D\",\"\\\\flat\",!0),r(h,p,f,\"\\u2113\",\"\\\\ell\",!0),r(h,p,f,\"\\u266E\",\"\\\\natural\",!0),r(h,p,f,\"\\u2663\",\"\\\\clubsuit\",!0),r(h,p,f,\"\\u2118\",\"\\\\wp\",!0),r(h,p,f,\"\\u266F\",\"\\\\sharp\",!0),r(h,p,f,\"\\u2662\",\"\\\\diamondsuit\",!0),r(h,p,f,\"\\u211C\",\"\\\\Re\",!0),r(h,p,f,\"\\u2661\",\"\\\\heartsuit\",!0),r(h,p,f,\"\\u2111\",\"\\\\Im\",!0),r(h,p,f,\"\\u2660\",\"\\\\spadesuit\",!0),r(h,p,f,\"\\xA7\",\"\\\\S\",!0),r(M,p,f,\"\\xA7\",\"\\\\S\"),r(h,p,f,\"\\xB6\",\"\\\\P\",!0),r(M,p,f,\"\\xB6\",\"\\\\P\"),r(h,p,f,\"\\u2020\",\"\\\\dag\"),r(M,p,f,\"\\u2020\",\"\\\\dag\"),r(M,p,f,\"\\u2020\",\"\\\\textdagger\"),r(h,p,f,\"\\u2021\",\"\\\\ddag\"),r(M,p,f,\"\\u2021\",\"\\\\ddag\"),r(M,p,f,\"\\u2021\",\"\\\\textdaggerdbl\"),r(h,p,ce,\"\\u23B1\",\"\\\\rmoustache\",!0),r(h,p,ue,\"\\u23B0\",\"\\\\lmoustache\",!0),r(h,p,ce,\"\\u27EF\",\"\\\\rgroup\",!0),r(h,p,ue,\"\\u27EE\",\"\\\\lgroup\",!0),r(h,p,D,\"\\u2213\",\"\\\\mp\",!0),r(h,p,D,\"\\u2296\",\"\\\\ominus\",!0),r(h,p,D,\"\\u228E\",\"\\\\uplus\",!0),r(h,p,D,\"\\u2293\",\"\\\\sqcap\",!0),r(h,p,D,\"\\u2217\",\"\\\\ast\"),r(h,p,D,\"\\u2294\",\"\\\\sqcup\",!0),r(h,p,D,\"\\u25EF\",\"\\\\bigcirc\",!0),r(h,p,D,\"\\u2219\",\"\\\\bullet\",!0),r(h,p,D,\"\\u2021\",\"\\\\ddagger\"),r(h,p,D,\"\\u2240\",\"\\\\wr\",!0),r(h,p,D,\"\\u2A3F\",\"\\\\amalg\"),r(h,p,D,\"\u0026\",\"\\\\And\"),r(h,p,v,\"\\u27F5\",\"\\\\longleftarrow\",!0),r(h,p,v,\"\\u21D0\",\"\\\\Leftarrow\",!0),r(h,p,v,\"\\u27F8\",\"\\\\Longleftarrow\",!0),r(h,p,v,\"\\u27F6\",\"\\\\longrightarrow\",!0),r(h,p,v,\"\\u21D2\",\"\\\\Rightarrow\",!0),r(h,p,v,\"\\u27F9\",\"\\\\Longrightarrow\",!0),r(h,p,v,\"\\u2194\",\"\\\\leftrightarrow\",!0),r(h,p,v,\"\\u27F7\",\"\\\\longleftrightarrow\",!0),r(h,p,v,\"\\u21D4\",\"\\\\Leftrightarrow\",!0),r(h,p,v,\"\\u27FA\",\"\\\\Longleftrightarrow\",!0),r(h,p,v,\"\\u21A6\",\"\\\\mapsto\",!0),r(h,p,v,\"\\u27FC\",\"\\\\longmapsto\",!0),r(h,p,v,\"\\u2197\",\"\\\\nearrow\",!0),r(h,p,v,\"\\u21A9\",\"\\\\hookleftarrow\",!0),r(h,p,v,\"\\u21AA\",\"\\\\hookrightarrow\",!0),r(h,p,v,\"\\u2198\",\"\\\\searrow\",!0),r(h,p,v,\"\\u21BC\",\"\\\\leftharpoonup\",!0),r(h,p,v,\"\\u21C0\",\"\\\\rightharpoonup\",!0),r(h,p,v,\"\\u2199\",\"\\\\swarrow\",!0),r(h,p,v,\"\\u21BD\",\"\\\\leftharpoondown\",!0),r(h,p,v,\"\\u21C1\",\"\\\\rightharpoondown\",!0),r(h,p,v,\"\\u2196\",\"\\\\nwarrow\",!0),r(h,p,v,\"\\u21CC\",\"\\\\rightleftharpoons\",!0),r(h,N,v,\"\\u226E\",\"\\\\nless\",!0),r(h,N,v,\"\\uE010\",\"\\\\@nleqslant\"),r(h,N,v,\"\\uE011\",\"\\\\@nleqq\"),r(h,N,v,\"\\u2A87\",\"\\\\lneq\",!0),r(h,N,v,\"\\u2268\",\"\\\\lneqq\",!0),r(h,N,v,\"\\uE00C\",\"\\\\@lvertneqq\"),r(h,N,v,\"\\u22E6\",\"\\\\lnsim\",!0),r(h,N,v,\"\\u2A89\",\"\\\\lnapprox\",!0),r(h,N,v,\"\\u2280\",\"\\\\nprec\",!0),r(h,N,v,\"\\u22E0\",\"\\\\npreceq\",!0),r(h,N,v,\"\\u22E8\",\"\\\\precnsim\",!0),r(h,N,v,\"\\u2AB9\",\"\\\\precnapprox\",!0),r(h,N,v,\"\\u2241\",\"\\\\nsim\",!0),r(h,N,v,\"\\uE006\",\"\\\\@nshortmid\"),r(h,N,v,\"\\u2224\",\"\\\\nmid\",!0),r(h,N,v,\"\\u22AC\",\"\\\\nvdash\",!0),r(h,N,v,\"\\u22AD\",\"\\\\nvDash\",!0),r(h,N,v,\"\\u22EA\",\"\\\\ntriangleleft\"),r(h,N,v,\"\\u22EC\",\"\\\\ntrianglelefteq\",!0),r(h,N,v,\"\\u228A\",\"\\\\subsetneq\",!0),r(h,N,v,\"\\uE01A\",\"\\\\@varsubsetneq\"),r(h,N,v,\"\\u2ACB\",\"\\\\subsetneqq\",!0),r(h,N,v,\"\\uE017\",\"\\\\@varsubsetneqq\"),r(h,N,v,\"\\u226F\",\"\\\\ngtr\",!0),r(h,N,v,\"\\uE00F\",\"\\\\@ngeqslant\"),r(h,N,v,\"\\uE00E\",\"\\\\@ngeqq\"),r(h,N,v,\"\\u2A88\",\"\\\\gneq\",!0),r(h,N,v,\"\\u2269\",\"\\\\gneqq\",!0),r(h,N,v,\"\\uE00D\",\"\\\\@gvertneqq\"),r(h,N,v,\"\\u22E7\",\"\\\\gnsim\",!0),r(h,N,v,\"\\u2A8A\",\"\\\\gnapprox\",!0),r(h,N,v,\"\\u2281\",\"\\\\nsucc\",!0),r(h,N,v,\"\\u22E1\",\"\\\\nsucceq\",!0),r(h,N,v,\"\\u22E9\",\"\\\\succnsim\",!0),r(h,N,v,\"\\u2ABA\",\"\\\\succnapprox\",!0),r(h,N,v,\"\\u2246\",\"\\\\ncong\",!0),r(h,N,v,\"\\uE007\",\"\\\\@nshortparallel\"),r(h,N,v,\"\\u2226\",\"\\\\nparallel\",!0),r(h,N,v,\"\\u22AF\",\"\\\\nVDash\",!0),r(h,N,v,\"\\u22EB\",\"\\\\ntriangleright\"),r(h,N,v,\"\\u22ED\",\"\\\\ntrianglerighteq\",!0),r(h,N,v,\"\\uE018\",\"\\\\@nsupseteqq\"),r(h,N,v,\"\\u228B\",\"\\\\supsetneq\",!0),r(h,N,v,\"\\uE01B\",\"\\\\@varsupsetneq\"),r(h,N,v,\"\\u2ACC\",\"\\\\supsetneqq\",!0),r(h,N,v,\"\\uE019\",\"\\\\@varsupsetneqq\"),r(h,N,v,\"\\u22AE\",\"\\\\nVdash\",!0),r(h,N,v,\"\\u2AB5\",\"\\\\precneqq\",!0),r(h,N,v,\"\\u2AB6\",\"\\\\succneqq\",!0),r(h,N,v,\"\\uE016\",\"\\\\@nsubseteqq\"),r(h,N,D,\"\\u22B4\",\"\\\\unlhd\"),r(h,N,D,\"\\u22B5\",\"\\\\unrhd\"),r(h,N,v,\"\\u219A\",\"\\\\nleftarrow\",!0),r(h,N,v,\"\\u219B\",\"\\\\nrightarrow\",!0),r(h,N,v,\"\\u21CD\",\"\\\\nLeftarrow\",!0),r(h,N,v,\"\\u21CF\",\"\\\\nRightarrow\",!0),r(h,N,v,\"\\u21AE\",\"\\\\nleftrightarrow\",!0),r(h,N,v,\"\\u21CE\",\"\\\\nLeftrightarrow\",!0),r(h,N,v,\"\\u25B3\",\"\\\\vartriangle\"),r(h,N,f,\"\\u210F\",\"\\\\hslash\"),r(h,N,f,\"\\u25BD\",\"\\\\triangledown\"),r(h,N,f,\"\\u25CA\",\"\\\\lozenge\"),r(h,N,f,\"\\u24C8\",\"\\\\circledS\"),r(h,N,f,\"\\xAE\",\"\\\\circledR\"),r(M,N,f,\"\\xAE\",\"\\\\circledR\"),r(h,N,f,\"\\u2221\",\"\\\\measuredangle\",!0),r(h,N,f,\"\\u2204\",\"\\\\nexists\"),r(h,N,f,\"\\u2127\",\"\\\\mho\"),r(h,N,f,\"\\u2132\",\"\\\\Finv\",!0),r(h,N,f,\"\\u2141\",\"\\\\Game\",!0),r(h,N,f,\"\\u2035\",\"\\\\backprime\"),r(h,N,f,\"\\u25B2\",\"\\\\blacktriangle\"),r(h,N,f,\"\\u25BC\",\"\\\\blacktriangledown\"),r(h,N,f,\"\\u25A0\",\"\\\\blacksquare\"),r(h,N,f,\"\\u29EB\",\"\\\\blacklozenge\"),r(h,N,f,\"\\u2605\",\"\\\\bigstar\"),r(h,N,f,\"\\u2222\",\"\\\\sphericalangle\",!0),r(h,N,f,\"\\u2201\",\"\\\\complement\",!0),r(h,N,f,\"\\xF0\",\"\\\\eth\",!0),r(M,p,f,\"\\xF0\",\"\\xF0\"),r(h,N,f,\"\\u2571\",\"\\\\diagup\"),r(h,N,f,\"\\u2572\",\"\\\\diagdown\"),r(h,N,f,\"\\u25A1\",\"\\\\square\"),r(h,N,f,\"\\u25A1\",\"\\\\Box\"),r(h,N,f,\"\\u25CA\",\"\\\\Diamond\"),r(h,N,f,\"\\xA5\",\"\\\\yen\",!0),r(M,N,f,\"\\xA5\",\"\\\\yen\",!0),r(h,N,f,\"\\u2713\",\"\\\\checkmark\",!0),r(M,N,f,\"\\u2713\",\"\\\\checkmark\"),r(h,N,f,\"\\u2136\",\"\\\\beth\",!0),r(h,N,f,\"\\u2138\",\"\\\\daleth\",!0),r(h,N,f,\"\\u2137\",\"\\\\gimel\",!0),r(h,N,f,\"\\u03DD\",\"\\\\digamma\",!0),r(h,N,f,\"\\u03F0\",\"\\\\varkappa\"),r(h,N,ue,\"\\u250C\",\"\\\\@ulcorner\",!0),r(h,N,ce,\"\\u2510\",\"\\\\@urcorner\",!0),r(h,N,ue,\"\\u2514\",\"\\\\@llcorner\",!0),r(h,N,ce,\"\\u2518\",\"\\\\@lrcorner\",!0),r(h,N,v,\"\\u2266\",\"\\\\leqq\",!0),r(h,N,v,\"\\u2A7D\",\"\\\\leqslant\",!0),r(h,N,v,\"\\u2A95\",\"\\\\eqslantless\",!0),r(h,N,v,\"\\u2272\",\"\\\\lesssim\",!0),r(h,N,v,\"\\u2A85\",\"\\\\lessapprox\",!0),r(h,N,v,\"\\u224A\",\"\\\\approxeq\",!0),r(h,N,D,\"\\u22D6\",\"\\\\lessdot\"),r(h,N,v,\"\\u22D8\",\"\\\\lll\",!0),r(h,N,v,\"\\u2276\",\"\\\\lessgtr\",!0),r(h,N,v,\"\\u22DA\",\"\\\\lesseqgtr\",!0),r(h,N,v,\"\\u2A8B\",\"\\\\lesseqqgtr\",!0),r(h,N,v,\"\\u2251\",\"\\\\doteqdot\"),r(h,N,v,\"\\u2253\",\"\\\\risingdotseq\",!0),r(h,N,v,\"\\u2252\",\"\\\\fallingdotseq\",!0),r(h,N,v,\"\\u223D\",\"\\\\backsim\",!0),r(h,N,v,\"\\u22CD\",\"\\\\backsimeq\",!0),r(h,N,v,\"\\u2AC5\",\"\\\\subseteqq\",!0),r(h,N,v,\"\\u22D0\",\"\\\\Subset\",!0),r(h,N,v,\"\\u228F\",\"\\\\sqsubset\",!0),r(h,N,v,\"\\u227C\",\"\\\\preccurlyeq\",!0),r(h,N,v,\"\\u22DE\",\"\\\\curlyeqprec\",!0),r(h,N,v,\"\\u227E\",\"\\\\precsim\",!0),r(h,N,v,\"\\u2AB7\",\"\\\\precapprox\",!0),r(h,N,v,\"\\u22B2\",\"\\\\vartriangleleft\"),r(h,N,v,\"\\u22B4\",\"\\\\trianglelefteq\"),r(h,N,v,\"\\u22A8\",\"\\\\vDash\",!0),r(h,N,v,\"\\u22AA\",\"\\\\Vvdash\",!0),r(h,N,v,\"\\u2323\",\"\\\\smallsmile\"),r(h,N,v,\"\\u2322\",\"\\\\smallfrown\"),r(h,N,v,\"\\u224F\",\"\\\\bumpeq\",!0),r(h,N,v,\"\\u224E\",\"\\\\Bumpeq\",!0),r(h,N,v,\"\\u2267\",\"\\\\geqq\",!0),r(h,N,v,\"\\u2A7E\",\"\\\\geqslant\",!0),r(h,N,v,\"\\u2A96\",\"\\\\eqslantgtr\",!0),r(h,N,v,\"\\u2273\",\"\\\\gtrsim\",!0),r(h,N,v,\"\\u2A86\",\"\\\\gtrapprox\",!0),r(h,N,D,\"\\u22D7\",\"\\\\gtrdot\"),r(h,N,v,\"\\u22D9\",\"\\\\ggg\",!0),r(h,N,v,\"\\u2277\",\"\\\\gtrless\",!0),r(h,N,v,\"\\u22DB\",\"\\\\gtreqless\",!0),r(h,N,v,\"\\u2A8C\",\"\\\\gtreqqless\",!0),r(h,N,v,\"\\u2256\",\"\\\\eqcirc\",!0),r(h,N,v,\"\\u2257\",\"\\\\circeq\",!0),r(h,N,v,\"\\u225C\",\"\\\\triangleq\",!0),r(h,N,v,\"\\u223C\",\"\\\\thicksim\"),r(h,N,v,\"\\u2248\",\"\\\\thickapprox\"),r(h,N,v,\"\\u2AC6\",\"\\\\supseteqq\",!0),r(h,N,v,\"\\u22D1\",\"\\\\Supset\",!0),r(h,N,v,\"\\u2290\",\"\\\\sqsupset\",!0),r(h,N,v,\"\\u227D\",\"\\\\succcurlyeq\",!0),r(h,N,v,\"\\u22DF\",\"\\\\curlyeqsucc\",!0),r(h,N,v,\"\\u227F\",\"\\\\succsim\",!0),r(h,N,v,\"\\u2AB8\",\"\\\\succapprox\",!0),r(h,N,v,\"\\u22B3\",\"\\\\vartriangleright\"),r(h,N,v,\"\\u22B5\",\"\\\\trianglerighteq\"),r(h,N,v,\"\\u22A9\",\"\\\\Vdash\",!0),r(h,N,v,\"\\u2223\",\"\\\\shortmid\"),r(h,N,v,\"\\u2225\",\"\\\\shortparallel\"),r(h,N,v,\"\\u226C\",\"\\\\between\",!0),r(h,N,v,\"\\u22D4\",\"\\\\pitchfork\",!0),r(h,N,v,\"\\u221D\",\"\\\\varpropto\"),r(h,N,v,\"\\u25C0\",\"\\\\blacktriangleleft\"),r(h,N,v,\"\\u2234\",\"\\\\therefore\",!0),r(h,N,v,\"\\u220D\",\"\\\\backepsilon\"),r(h,N,v,\"\\u25B6\",\"\\\\blacktriangleright\"),r(h,N,v,\"\\u2235\",\"\\\\because\",!0),r(h,N,v,\"\\u22D8\",\"\\\\llless\"),r(h,N,v,\"\\u22D9\",\"\\\\gggtr\"),r(h,N,D,\"\\u22B2\",\"\\\\lhd\"),r(h,N,D,\"\\u22B3\",\"\\\\rhd\"),r(h,N,v,\"\\u2242\",\"\\\\eqsim\",!0),r(h,p,v,\"\\u22C8\",\"\\\\Join\"),r(h,N,v,\"\\u2251\",\"\\\\Doteq\",!0),r(h,N,D,\"\\u2214\",\"\\\\dotplus\",!0),r(h,N,D,\"\\u2216\",\"\\\\smallsetminus\"),r(h,N,D,\"\\u22D2\",\"\\\\Cap\",!0),r(h,N,D,\"\\u22D3\",\"\\\\Cup\",!0),r(h,N,D,\"\\u2A5E\",\"\\\\doublebarwedge\",!0),r(h,N,D,\"\\u229F\",\"\\\\boxminus\",!0),r(h,N,D,\"\\u229E\",\"\\\\boxplus\",!0),r(h,N,D,\"\\u22C7\",\"\\\\divideontimes\",!0),r(h,N,D,\"\\u22C9\",\"\\\\ltimes\",!0),r(h,N,D,\"\\u22CA\",\"\\\\rtimes\",!0),r(h,N,D,\"\\u22CB\",\"\\\\leftthreetimes\",!0),r(h,N,D,\"\\u22CC\",\"\\\\rightthreetimes\",!0),r(h,N,D,\"\\u22CF\",\"\\\\curlywedge\",!0),r(h,N,D,\"\\u22CE\",\"\\\\curlyvee\",!0),r(h,N,D,\"\\u229D\",\"\\\\circleddash\",!0),r(h,N,D,\"\\u229B\",\"\\\\circledast\",!0),r(h,N,D,\"\\u22C5\",\"\\\\centerdot\"),r(h,N,D,\"\\u22BA\",\"\\\\intercal\",!0),r(h,N,D,\"\\u22D2\",\"\\\\doublecap\"),r(h,N,D,\"\\u22D3\",\"\\\\doublecup\"),r(h,N,D,\"\\u22A0\",\"\\\\boxtimes\",!0),r(h,N,v,\"\\u21E2\",\"\\\\dashrightarrow\",!0),r(h,N,v,\"\\u21E0\",\"\\\\dashleftarrow\",!0),r(h,N,v,\"\\u21C7\",\"\\\\leftleftarrows\",!0),r(h,N,v,\"\\u21C6\",\"\\\\leftrightarrows\",!0),r(h,N,v,\"\\u21DA\",\"\\\\Lleftarrow\",!0),r(h,N,v,\"\\u219E\",\"\\\\twoheadleftarrow\",!0),r(h,N,v,\"\\u21A2\",\"\\\\leftarrowtail\",!0),r(h,N,v,\"\\u21AB\",\"\\\\looparrowleft\",!0),r(h,N,v,\"\\u21CB\",\"\\\\leftrightharpoons\",!0),r(h,N,v,\"\\u21B6\",\"\\\\curvearrowleft\",!0),r(h,N,v,\"\\u21BA\",\"\\\\circlearrowleft\",!0),r(h,N,v,\"\\u21B0\",\"\\\\Lsh\",!0),r(h,N,v,\"\\u21C8\",\"\\\\upuparrows\",!0),r(h,N,v,\"\\u21BF\",\"\\\\upharpoonleft\",!0),r(h,N,v,\"\\u21C3\",\"\\\\downharpoonleft\",!0),r(h,p,v,\"\\u22B6\",\"\\\\origof\",!0),r(h,p,v,\"\\u22B7\",\"\\\\imageof\",!0),r(h,N,v,\"\\u22B8\",\"\\\\multimap\",!0),r(h,N,v,\"\\u21AD\",\"\\\\leftrightsquigarrow\",!0),r(h,N,v,\"\\u21C9\",\"\\\\rightrightarrows\",!0),r(h,N,v,\"\\u21C4\",\"\\\\rightleftarrows\",!0),r(h,N,v,\"\\u21A0\",\"\\\\twoheadrightarrow\",!0),r(h,N,v,\"\\u21A3\",\"\\\\rightarrowtail\",!0),r(h,N,v,\"\\u21AC\",\"\\\\looparrowright\",!0),r(h,N,v,\"\\u21B7\",\"\\\\curvearrowright\",!0),r(h,N,v,\"\\u21BB\",\"\\\\circlearrowright\",!0),r(h,N,v,\"\\u21B1\",\"\\\\Rsh\",!0),r(h,N,v,\"\\u21CA\",\"\\\\downdownarrows\",!0),r(h,N,v,\"\\u21BE\",\"\\\\upharpoonright\",!0),r(h,N,v,\"\\u21C2\",\"\\\\downharpoonright\",!0),r(h,N,v,\"\\u21DD\",\"\\\\rightsquigarrow\",!0),r(h,N,v,\"\\u21DD\",\"\\\\leadsto\"),r(h,N,v,\"\\u21DB\",\"\\\\Rrightarrow\",!0),r(h,N,v,\"\\u21BE\",\"\\\\restriction\"),r(h,p,f,\"\\u2018\",\"`\"),r(h,p,f,\"$\",\"\\\\$\"),r(M,p,f,\"$\",\"\\\\$\"),r(M,p,f,\"$\",\"\\\\textdollar\"),r(h,p,f,\"%\",\"\\\\%\"),r(M,p,f,\"%\",\"\\\\%\"),r(h,p,f,\"_\",\"\\\\_\"),r(M,p,f,\"_\",\"\\\\_\"),r(M,p,f,\"_\",\"\\\\textunderscore\"),r(h,p,f,\"\\u2220\",\"\\\\angle\",!0),r(h,p,f,\"\\u221E\",\"\\\\infty\",!0),r(h,p,f,\"\\u2032\",\"\\\\prime\"),r(h,p,f,\"\\u25B3\",\"\\\\triangle\"),r(h,p,f,\"\\u0393\",\"\\\\Gamma\",!0),r(h,p,f,\"\\u0394\",\"\\\\Delta\",!0),r(h,p,f,\"\\u0398\",\"\\\\Theta\",!0),r(h,p,f,\"\\u039B\",\"\\\\Lambda\",!0),r(h,p,f,\"\\u039E\",\"\\\\Xi\",!0),r(h,p,f,\"\\u03A0\",\"\\\\Pi\",!0),r(h,p,f,\"\\u03A3\",\"\\\\Sigma\",!0),r(h,p,f,\"\\u03A5\",\"\\\\Upsilon\",!0),r(h,p,f,\"\\u03A6\",\"\\\\Phi\",!0),r(h,p,f,\"\\u03A8\",\"\\\\Psi\",!0),r(h,p,f,\"\\u03A9\",\"\\\\Omega\",!0),r(h,p,f,\"A\",\"\\u0391\"),r(h,p,f,\"B\",\"\\u0392\"),r(h,p,f,\"E\",\"\\u0395\"),r(h,p,f,\"Z\",\"\\u0396\"),r(h,p,f,\"H\",\"\\u0397\"),r(h,p,f,\"I\",\"\\u0399\"),r(h,p,f,\"K\",\"\\u039A\"),r(h,p,f,\"M\",\"\\u039C\"),r(h,p,f,\"N\",\"\\u039D\"),r(h,p,f,\"O\",\"\\u039F\"),r(h,p,f,\"P\",\"\\u03A1\"),r(h,p,f,\"T\",\"\\u03A4\"),r(h,p,f,\"X\",\"\\u03A7\"),r(h,p,f,\"\\xAC\",\"\\\\neg\",!0),r(h,p,f,\"\\xAC\",\"\\\\lnot\"),r(h,p,f,\"\\u22A4\",\"\\\\top\"),r(h,p,f,\"\\u22A5\",\"\\\\bot\"),r(h,p,f,\"\\u2205\",\"\\\\emptyset\"),r(h,N,f,\"\\u2205\",\"\\\\varnothing\"),r(h,p,F,\"\\u03B1\",\"\\\\alpha\",!0),r(h,p,F,\"\\u03B2\",\"\\\\beta\",!0),r(h,p,F,\"\\u03B3\",\"\\\\gamma\",!0),r(h,p,F,\"\\u03B4\",\"\\\\delta\",!0),r(h,p,F,\"\\u03F5\",\"\\\\epsilon\",!0),r(h,p,F,\"\\u03B6\",\"\\\\zeta\",!0),r(h,p,F,\"\\u03B7\",\"\\\\eta\",!0),r(h,p,F,\"\\u03B8\",\"\\\\theta\",!0),r(h,p,F,\"\\u03B9\",\"\\\\iota\",!0),r(h,p,F,\"\\u03BA\",\"\\\\kappa\",!0),r(h,p,F,\"\\u03BB\",\"\\\\lambda\",!0),r(h,p,F,\"\\u03BC\",\"\\\\mu\",!0),r(h,p,F,\"\\u03BD\",\"\\\\nu\",!0),r(h,p,F,\"\\u03BE\",\"\\\\xi\",!0),r(h,p,F,\"\\u03BF\",\"\\\\omicron\",!0),r(h,p,F,\"\\u03C0\",\"\\\\pi\",!0),r(h,p,F,\"\\u03C1\",\"\\\\rho\",!0),r(h,p,F,\"\\u03C3\",\"\\\\sigma\",!0),r(h,p,F,\"\\u03C4\",\"\\\\tau\",!0),r(h,p,F,\"\\u03C5\",\"\\\\upsilon\",!0),r(h,p,F,\"\\u03D5\",\"\\\\phi\",!0),r(h,p,F,\"\\u03C7\",\"\\\\chi\",!0),r(h,p,F,\"\\u03C8\",\"\\\\psi\",!0),r(h,p,F,\"\\u03C9\",\"\\\\omega\",!0),r(h,p,F,\"\\u03B5\",\"\\\\varepsilon\",!0),r(h,p,F,\"\\u03D1\",\"\\\\vartheta\",!0),r(h,p,F,\"\\u03D6\",\"\\\\varpi\",!0),r(h,p,F,\"\\u03F1\",\"\\\\varrho\",!0),r(h,p,F,\"\\u03C2\",\"\\\\varsigma\",!0),r(h,p,F,\"\\u03C6\",\"\\\\varphi\",!0),r(h,p,D,\"\\u2217\",\"*\",!0),r(h,p,D,\"+\",\"+\"),r(h,p,D,\"\\u2212\",\"-\",!0),r(h,p,D,\"\\u22C5\",\"\\\\cdot\",!0),r(h,p,D,\"\\u2218\",\"\\\\circ\",!0),r(h,p,D,\"\\xF7\",\"\\\\div\",!0),r(h,p,D,\"\\xB1\",\"\\\\pm\",!0),r(h,p,D,\"\\xD7\",\"\\\\times\",!0),r(h,p,D,\"\\u2229\",\"\\\\cap\",!0),r(h,p,D,\"\\u222A\",\"\\\\cup\",!0),r(h,p,D,\"\\u2216\",\"\\\\setminus\",!0),r(h,p,D,\"\\u2227\",\"\\\\land\"),r(h,p,D,\"\\u2228\",\"\\\\lor\"),r(h,p,D,\"\\u2227\",\"\\\\wedge\",!0),r(h,p,D,\"\\u2228\",\"\\\\vee\",!0),r(h,p,f,\"\\u221A\",\"\\\\surd\"),r(h,p,ue,\"\\u27E8\",\"\\\\langle\",!0),r(h,p,ue,\"\\u2223\",\"\\\\lvert\"),r(h,p,ue,\"\\u2225\",\"\\\\lVert\"),r(h,p,ce,\"?\",\"?\"),r(h,p,ce,\"!\",\"!\"),r(h,p,ce,\"\\u27E9\",\"\\\\rangle\",!0),r(h,p,ce,\"\\u2223\",\"\\\\rvert\"),r(h,p,ce,\"\\u2225\",\"\\\\rVert\"),r(h,p,v,\"=\",\"=\"),r(h,p,v,\":\",\":\"),r(h,p,v,\"\\u2248\",\"\\\\approx\",!0),r(h,p,v,\"\\u2245\",\"\\\\cong\",!0),r(h,p,v,\"\\u2265\",\"\\\\ge\"),r(h,p,v,\"\\u2265\",\"\\\\geq\",!0),r(h,p,v,\"\\u2190\",\"\\\\gets\"),r(h,p,v,\"\u003e\",\"\\\\gt\",!0),r(h,p,v,\"\\u2208\",\"\\\\in\",!0),r(h,p,v,\"\\uE020\",\"\\\\@not\"),r(h,p,v,\"\\u2282\",\"\\\\subset\",!0),r(h,p,v,\"\\u2283\",\"\\\\supset\",!0),r(h,p,v,\"\\u2286\",\"\\\\subseteq\",!0),r(h,p,v,\"\\u2287\",\"\\\\supseteq\",!0),r(h,N,v,\"\\u2288\",\"\\\\nsubseteq\",!0),r(h,N,v,\"\\u2289\",\"\\\\nsupseteq\",!0),r(h,p,v,\"\\u22A8\",\"\\\\models\"),r(h,p,v,\"\\u2190\",\"\\\\leftarrow\",!0),r(h,p,v,\"\\u2264\",\"\\\\le\"),r(h,p,v,\"\\u2264\",\"\\\\leq\",!0),r(h,p,v,\"\u003c\",\"\\\\lt\",!0),r(h,p,v,\"\\u2192\",\"\\\\rightarrow\",!0),r(h,p,v,\"\\u2192\",\"\\\\to\"),r(h,N,v,\"\\u2271\",\"\\\\ngeq\",!0),r(h,N,v,\"\\u2270\",\"\\\\nleq\",!0),r(h,p,Ee,\"\\xA0\",\"\\\\ \"),r(h,p,Ee,\"\\xA0\",\"\\\\space\"),r(h,p,Ee,\"\\xA0\",\"\\\\nobreakspace\"),r(M,p,Ee,\"\\xA0\",\"\\\\ \"),r(M,p,Ee,\"\\xA0\",\" \"),r(M,p,Ee,\"\\xA0\",\"\\\\space\"),r(M,p,Ee,\"\\xA0\",\"\\\\nobreakspace\"),r(h,p,Ee,null,\"\\\\nobreak\"),r(h,p,Ee,null,\"\\\\allowbreak\"),r(h,p,Ra,\",\",\",\"),r(h,p,Ra,\";\",\";\"),r(h,N,D,\"\\u22BC\",\"\\\\barwedge\",!0),r(h,N,D,\"\\u22BB\",\"\\\\veebar\",!0),r(h,p,D,\"\\u2299\",\"\\\\odot\",!0),r(h,p,D,\"\\u2295\",\"\\\\oplus\",!0),r(h,p,D,\"\\u2297\",\"\\\\otimes\",!0),r(h,p,f,\"\\u2202\",\"\\\\partial\",!0),r(h,p,D,\"\\u2298\",\"\\\\oslash\",!0),r(h,N,D,\"\\u229A\",\"\\\\circledcirc\",!0),r(h,N,D,\"\\u22A1\",\"\\\\boxdot\",!0),r(h,p,D,\"\\u25B3\",\"\\\\bigtriangleup\"),r(h,p,D,\"\\u25BD\",\"\\\\bigtriangledown\"),r(h,p,D,\"\\u2020\",\"\\\\dagger\"),r(h,p,D,\"\\u22C4\",\"\\\\diamond\"),r(h,p,D,\"\\u22C6\",\"\\\\star\"),r(h,p,D,\"\\u25C3\",\"\\\\triangleleft\"),r(h,p,D,\"\\u25B9\",\"\\\\triangleright\"),r(h,p,ue,\"{\",\"\\\\{\"),r(M,p,f,\"{\",\"\\\\{\"),r(M,p,f,\"{\",\"\\\\textbraceleft\"),r(h,p,ce,\"}\",\"\\\\}\"),r(M,p,f,\"}\",\"\\\\}\"),r(M,p,f,\"}\",\"\\\\textbraceright\"),r(h,p,ue,\"{\",\"\\\\lbrace\"),r(h,p,ce,\"}\",\"\\\\rbrace\"),r(h,p,ue,\"[\",\"\\\\lbrack\",!0),r(M,p,f,\"[\",\"\\\\lbrack\",!0),r(h,p,ce,\"]\",\"\\\\rbrack\",!0),r(M,p,f,\"]\",\"\\\\rbrack\",!0),r(h,p,ue,\"(\",\"\\\\lparen\",!0),r(h,p,ce,\")\",\"\\\\rparen\",!0),r(M,p,f,\"\u003c\",\"\\\\textless\",!0),r(M,p,f,\"\u003e\",\"\\\\textgreater\",!0),r(h,p,ue,\"\\u230A\",\"\\\\lfloor\",!0),r(h,p,ce,\"\\u230B\",\"\\\\rfloor\",!0),r(h,p,ue,\"\\u2308\",\"\\\\lceil\",!0),r(h,p,ce,\"\\u2309\",\"\\\\rceil\",!0),r(h,p,f,\"\\\\\",\"\\\\backslash\"),r(h,p,f,\"\\u2223\",\"|\"),r(h,p,f,\"\\u2223\",\"\\\\vert\"),r(M,p,f,\"|\",\"\\\\textbar\",!0),r(h,p,f,\"\\u2225\",\"\\\\|\"),r(h,p,f,\"\\u2225\",\"\\\\Vert\"),r(M,p,f,\"\\u2225\",\"\\\\textbardbl\"),r(M,p,f,\"~\",\"\\\\textasciitilde\"),r(M,p,f,\"\\\\\",\"\\\\textbackslash\"),r(M,p,f,\"^\",\"\\\\textasciicircum\"),r(h,p,v,\"\\u2191\",\"\\\\uparrow\",!0),r(h,p,v,\"\\u21D1\",\"\\\\Uparrow\",!0),r(h,p,v,\"\\u2193\",\"\\\\downarrow\",!0),r(h,p,v,\"\\u21D3\",\"\\\\Downarrow\",!0),r(h,p,v,\"\\u2195\",\"\\\\updownarrow\",!0),r(h,p,v,\"\\u21D5\",\"\\\\Updownarrow\",!0),r(h,p,te,\"\\u2210\",\"\\\\coprod\"),r(h,p,te,\"\\u22C1\",\"\\\\bigvee\"),r(h,p,te,\"\\u22C0\",\"\\\\bigwedge\"),r(h,p,te,\"\\u2A04\",\"\\\\biguplus\"),r(h,p,te,\"\\u22C2\",\"\\\\bigcap\"),r(h,p,te,\"\\u22C3\",\"\\\\bigcup\"),r(h,p,te,\"\\u222B\",\"\\\\int\"),r(h,p,te,\"\\u222B\",\"\\\\intop\"),r(h,p,te,\"\\u222C\",\"\\\\iint\"),r(h,p,te,\"\\u222D\",\"\\\\iiint\"),r(h,p,te,\"\\u220F\",\"\\\\prod\"),r(h,p,te,\"\\u2211\",\"\\\\sum\"),r(h,p,te,\"\\u2A02\",\"\\\\bigotimes\"),r(h,p,te,\"\\u2A01\",\"\\\\bigoplus\"),r(h,p,te,\"\\u2A00\",\"\\\\bigodot\"),r(h,p,te,\"\\u222E\",\"\\\\oint\"),r(h,p,te,\"\\u222F\",\"\\\\oiint\"),r(h,p,te,\"\\u2230\",\"\\\\oiiint\"),r(h,p,te,\"\\u2A06\",\"\\\\bigsqcup\"),r(h,p,te,\"\\u222B\",\"\\\\smallint\"),r(M,p,na,\"\\u2026\",\"\\\\textellipsis\"),r(h,p,na,\"\\u2026\",\"\\\\mathellipsis\"),r(M,p,na,\"\\u2026\",\"\\\\ldots\",!0),r(h,p,na,\"\\u2026\",\"\\\\ldots\",!0),r(h,p,na,\"\\u22EF\",\"\\\\@cdots\",!0),r(h,p,na,\"\\u22F1\",\"\\\\ddots\",!0),r(h,p,f,\"\\u22EE\",\"\\\\varvdots\"),r(h,p,$,\"\\u02CA\",\"\\\\acute\"),r(h,p,$,\"\\u02CB\",\"\\\\grave\"),r(h,p,$,\"\\xA8\",\"\\\\ddot\"),r(h,p,$,\"~\",\"\\\\tilde\"),r(h,p,$,\"\\u02C9\",\"\\\\bar\"),r(h,p,$,\"\\u02D8\",\"\\\\breve\"),r(h,p,$,\"\\u02C7\",\"\\\\check\"),r(h,p,$,\"^\",\"\\\\hat\"),r(h,p,$,\"\\u20D7\",\"\\\\vec\"),r(h,p,$,\"\\u02D9\",\"\\\\dot\"),r(h,p,$,\"\\u02DA\",\"\\\\mathring\"),r(h,p,F,\"\\uE131\",\"\\\\@imath\"),r(h,p,F,\"\\uE237\",\"\\\\@jmath\"),r(h,p,f,\"\\u0131\",\"\\u0131\"),r(h,p,f,\"\\u0237\",\"\\u0237\"),r(M,p,f,\"\\u0131\",\"\\\\i\",!0),r(M,p,f,\"\\u0237\",\"\\\\j\",!0),r(M,p,f,\"\\xDF\",\"\\\\ss\",!0),r(M,p,f,\"\\xE6\",\"\\\\ae\",!0),r(M,p,f,\"\\u0153\",\"\\\\oe\",!0),r(M,p,f,\"\\xF8\",\"\\\\o\",!0),r(M,p,f,\"\\xC6\",\"\\\\AE\",!0),r(M,p,f,\"\\u0152\",\"\\\\OE\",!0),r(M,p,f,\"\\xD8\",\"\\\\O\",!0),r(M,p,$,\"\\u02CA\",\"\\\\'\"),r(M,p,$,\"\\u02CB\",\"\\\\`\"),r(M,p,$,\"\\u02C6\",\"\\\\^\"),r(M,p,$,\"\\u02DC\",\"\\\\~\"),r(M,p,$,\"\\u02C9\",\"\\\\=\"),r(M,p,$,\"\\u02D8\",\"\\\\u\"),r(M,p,$,\"\\u02D9\",\"\\\\.\"),r(M,p,$,\"\\xB8\",\"\\\\c\"),r(M,p,$,\"\\u02DA\",\"\\\\r\"),r(M,p,$,\"\\u02C7\",\"\\\\v\"),r(M,p,$,\"\\xA8\",'\\\\\"'),r(M,p,$,\"\\u02DD\",\"\\\\H\"),r(M,p,$,\"\\u25EF\",\"\\\\textcircled\");var tt={\"--\":!0,\"---\":!0,\"``\":!0,\"''\":!0};r(M,p,f,\"\\u2013\",\"--\",!0),r(M,p,f,\"\\u2013\",\"\\\\textendash\"),r(M,p,f,\"\\u2014\",\"---\",!0),r(M,p,f,\"\\u2014\",\"\\\\textemdash\"),r(M,p,f,\"\\u2018\",\"`\",!0),r(M,p,f,\"\\u2018\",\"\\\\textquoteleft\"),r(M,p,f,\"\\u2019\",\"'\",!0),r(M,p,f,\"\\u2019\",\"\\\\textquoteright\"),r(M,p,f,\"\\u201C\",\"``\",!0),r(M,p,f,\"\\u201C\",\"\\\\textquotedblleft\"),r(M,p,f,\"\\u201D\",\"''\",!0),r(M,p,f,\"\\u201D\",\"\\\\textquotedblright\"),r(h,p,f,\"\\xB0\",\"\\\\degree\",!0),r(M,p,f,\"\\xB0\",\"\\\\degree\"),r(M,p,f,\"\\xB0\",\"\\\\textdegree\",!0),r(h,p,f,\"\\xA3\",\"\\\\pounds\"),r(h,p,f,\"\\xA3\",\"\\\\mathsterling\",!0),r(M,p,f,\"\\xA3\",\"\\\\pounds\"),r(M,p,f,\"\\xA3\",\"\\\\textsterling\",!0),r(h,N,f,\"\\u2720\",\"\\\\maltese\"),r(M,N,f,\"\\u2720\",\"\\\\maltese\");for(var nt='0123456789/@.\"',ls=0;ls\u003cnt.length;ls++){var lt=nt.charAt(ls);r(h,p,f,lt,lt)}for(var it='0123456789!@*()-=+\";:?/.,',is=0;is\u003cit.length;is++){var rt=it.charAt(is);r(M,p,f,rt,rt)}for(var Aa=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\",rs=0;rs\u003cAa.length;rs++){var Sa=Aa.charAt(rs);r(h,p,F,Sa,Sa),r(M,p,f,Sa,Sa)}r(h,N,f,\"C\",\"\\u2102\"),r(M,N,f,\"C\",\"\\u2102\"),r(h,N,f,\"H\",\"\\u210D\"),r(M,N,f,\"H\",\"\\u210D\"),r(h,N,f,\"N\",\"\\u2115\"),r(M,N,f,\"N\",\"\\u2115\"),r(h,N,f,\"P\",\"\\u2119\"),r(M,N,f,\"P\",\"\\u2119\"),r(h,N,f,\"Q\",\"\\u211A\"),r(M,N,f,\"Q\",\"\\u211A\"),r(h,N,f,\"R\",\"\\u211D\"),r(M,N,f,\"R\",\"\\u211D\"),r(h,N,f,\"Z\",\"\\u2124\"),r(M,N,f,\"Z\",\"\\u2124\"),r(h,p,F,\"h\",\"\\u210E\"),r(M,p,F,\"h\",\"\\u210E\");for(var H=\"\",de=0;de\u003cAa.length;de++){var ne=Aa.charAt(de);H=String.fromCharCode(55349,56320+de),r(h,p,F,ne,H),r(M,p,f,ne,H),H=String.fromCharCode(55349,56372+de),r(h,p,F,ne,H),r(M,p,f,ne,H),H=String.fromCharCode(55349,56424+de),r(h,p,F,ne,H),r(M,p,f,ne,H),H=String.fromCharCode(55349,56580+de),r(h,p,F,ne,H),r(M,p,f,ne,H),H=String.fromCharCode(55349,56736+de),r(h,p,F,ne,H),r(M,p,f,ne,H),H=String.fromCharCode(55349,56788+de),r(h,p,F,ne,H),r(M,p,f,ne,H),H=String.fromCharCode(55349,56840+de),r(h,p,F,ne,H),r(M,p,f,ne,H),H=String.fromCharCode(55349,56944+de),r(h,p,F,ne,H),r(M,p,f,ne,H),de\u003c26\u0026\u0026(H=String.fromCharCode(55349,56632+de),r(h,p,F,ne,H),r(M,p,f,ne,H),H=String.fromCharCode(55349,56476+de),r(h,p,F,ne,H),r(M,p,f,ne,H))}H=String.fromCharCode(55349,56668),r(h,p,F,\"k\",H),r(M,p,f,\"k\",H);for(var Je=0;Je\u003c10;Je++){var Ge=Je.toString();H=String.fromCharCode(55349,57294+Je),r(h,p,F,Ge,H),r(M,p,f,Ge,H),H=String.fromCharCode(55349,57314+Je),r(h,p,F,Ge,H),r(M,p,f,Ge,H),H=String.fromCharCode(55349,57324+Je),r(h,p,F,Ge,H),r(M,p,f,Ge,H),H=String.fromCharCode(55349,57334+Je),r(h,p,F,Ge,H),r(M,p,f,Ge,H)}for(var ms=\"\\xD0\\xDE\\xFE\",cs=0;cs\u003cms.length;cs++){var La=ms.charAt(cs);r(h,p,F,La,La),r(M,p,f,La,La)}var Ba=[[\"mathbf\",\"textbf\",\"Main-Bold\"],[\"mathbf\",\"textbf\",\"Main-Bold\"],[\"mathnormal\",\"textit\",\"Math-Italic\"],[\"mathnormal\",\"textit\",\"Math-Italic\"],[\"boldsymbol\",\"boldsymbol\",\"Main-BoldItalic\"],[\"boldsymbol\",\"boldsymbol\",\"Main-BoldItalic\"],[\"mathscr\",\"textscr\",\"Script-Regular\"],[\"\",\"\",\"\"],[\"\",\"\",\"\"],[\"\",\"\",\"\"],[\"mathfrak\",\"textfrak\",\"Fraktur-Regular\"],[\"mathfrak\",\"textfrak\",\"Fraktur-Regular\"],[\"mathbb\",\"textbb\",\"AMS-Regular\"],[\"mathbb\",\"textbb\",\"AMS-Regular\"],[\"\",\"\",\"\"],[\"\",\"\",\"\"],[\"mathsf\",\"textsf\",\"SansSerif-Regular\"],[\"mathsf\",\"textsf\",\"SansSerif-Regular\"],[\"mathboldsf\",\"textboldsf\",\"SansSerif-Bold\"],[\"mathboldsf\",\"textboldsf\",\"SansSerif-Bold\"],[\"mathitsf\",\"textitsf\",\"SansSerif-Italic\"],[\"mathitsf\",\"textitsf\",\"SansSerif-Italic\"],[\"\",\"\",\"\"],[\"\",\"\",\"\"],[\"mathtt\",\"texttt\",\"Typewriter-Regular\"],[\"mathtt\",\"texttt\",\"Typewriter-Regular\"]],mt=[[\"mathbf\",\"textbf\",\"Main-Bold\"],[\"\",\"\",\"\"],[\"mathsf\",\"textsf\",\"SansSerif-Regular\"],[\"mathboldsf\",\"textboldsf\",\"SansSerif-Bold\"],[\"mathtt\",\"texttt\",\"Typewriter-Regular\"]],yl=function(s,t){var n=s.charCodeAt(0),l=s.charCodeAt(1),i=(n-55296)*1024+(l-56320)+65536,c=t===\"math\"?0:1;if(119808\u003c=i\u0026\u0026i\u003c120484){var d=Math.floor((i-119808)/26);return[Ba[d][2],Ba[d][c]]}else if(120782\u003c=i\u0026\u0026i\u003c=120831){var o=Math.floor((i-120782)/10);return[mt[o][2],mt[o][c]]}else{if(i===120485||i===120486)return[Ba[0][2],Ba[0][c]];if(120486\u003ci\u0026\u0026i\u003c120782)return[\"\",\"\"];throw new A(\"Unsupported character: \"+s)}},Ta=function(s,t,n){return K[n][s]\u0026\u0026K[n][s].replace\u0026\u0026(s=K[n][s].replace),{value:s,metrics:es(s,t,n)}},we=function(s,t,n,l,i){var c=Ta(s,t,n),d=c.metrics;s=c.value;var o;if(d){var g=d.italic;(n===\"text\"||l\u0026\u0026l.font===\"mathit\")\u0026\u0026(g=0),o=new ve(s,d.height,d.depth,g,d.skew,d.width,i)}else typeof console\u003c\"u\"\u0026\u0026console.warn(\"No character metrics \"+(\"for '\"+s+\"' in style '\"+t+\"' and mode '\"+n+\"'\")),o=new ve(s,0,0,0,0,0,i);if(l){o.maxFontSize=l.sizeMultiplier,l.style.isTight()\u0026\u0026o.classes.push(\"mtight\");var y=l.getColor();y\u0026\u0026(o.style.color=y)}return o},fl=function(s,t,n,l){return l===void 0\u0026\u0026(l=[]),n.font===\"boldsymbol\"\u0026\u0026Ta(s,\"Main-Bold\",t).metrics?we(s,\"Main-Bold\",t,n,l.concat([\"mathbf\"])):s===\"\\\\\"||K[t][s].font===\"main\"?we(s,\"Main-Regular\",t,n,l):we(s,\"AMS-Regular\",t,n,l.concat([\"amsrm\"]))},bl=function(s,t,n,l,i){return i!==\"textord\"\u0026\u0026Ta(s,\"Math-BoldItalic\",t).metrics?{fontName:\"Math-BoldItalic\",fontClass:\"boldsymbol\"}:{fontName:\"Main-Bold\",fontClass:\"mathbf\"}},xl=function(s,t,n){var l=s.mode,i=s.text,c=[\"mord\"],d=l===\"math\"||l===\"text\"\u0026\u0026t.font,o=d?t.font:t.fontFamily;if(i.charCodeAt(0)===55349){var g=yl(i,l),y=g[0],x=g[1];return we(i,y,l,t,c.concat(x))}else if(o){var w,k;if(o===\"boldsymbol\"){var z=bl(i,l,t,c,n);w=z.fontName,k=[z.fontClass]}else d?(w=dt[o].fontName,k=[o]):(w=Da(o,t.fontWeight,t.fontShape),k=[o,t.fontWeight,t.fontShape]);if(Ta(i,w,l).metrics)return we(i,w,l,t,c.concat(k));if(tt.hasOwnProperty(i)\u0026\u0026w.slice(0,10)===\"Typewriter\"){for(var S=[],B=0;B\u003ci.length;B++)S.push(we(i[B],w,l,t,c.concat(k)));return ht(S)}}if(n===\"mathord\")return we(i,\"Math-Italic\",l,t,c.concat([\"mathnormal\"]));if(n===\"textord\"){var C=K[l][i]\u0026\u0026K[l][i].font;if(C===\"ams\"){var E=Da(\"amsrm\",t.fontWeight,t.fontShape);return we(i,E,l,t,c.concat(\"amsrm\",t.fontWeight,t.fontShape))}else if(C===\"main\"||!C){var q=Da(\"textrm\",t.fontWeight,t.fontShape);return we(i,q,l,t,c.concat(t.fontWeight,t.fontShape))}else{var Z=Da(C,t.fontWeight,t.fontShape);return we(i,Z,l,t,c.concat(Z,t.fontWeight,t.fontShape))}}else throw new Error(\"unexpected type: \"+n+\" in makeOrd\")},wl=function(s,t){if(Pe(s.classes)!==Pe(t.classes)||s.skew!==t.skew||s.maxFontSize!==t.maxFontSize)return!1;if(s.classes.length===1){var n=s.classes[0];if(n===\"mbin\"||n===\"mord\")return!1}for(var l in s.style)if(s.style.hasOwnProperty(l)\u0026\u0026s.style[l]!==t.style[l])return!1;for(var i in t.style)if(t.style.hasOwnProperty(i)\u0026\u0026s.style[i]!==t.style[i])return!1;return!0},kl=function(s){for(var t=0;t\u003cs.length-1;t++){var n=s[t],l=s[t+1];n instanceof ve\u0026\u0026l instanceof ve\u0026\u0026wl(n,l)\u0026\u0026(n.text+=l.text,n.height=Math.max(n.height,l.height),n.depth=Math.max(n.depth,l.depth),n.italic=l.italic,s.splice(t+1,1),t--)}return s},hs=function(s){for(var t=0,n=0,l=0,i=0;i\u003cs.children.length;i++){var c=s.children[i];c.height\u003et\u0026\u0026(t=c.height),c.depth\u003en\u0026\u0026(n=c.depth),c.maxFontSize\u003el\u0026\u0026(l=c.maxFontSize)}s.height=t,s.depth=n,s.maxFontSize=l},pe=function(s,t,n,l){var i=new ua(s,t,n,l);return hs(i),i},ct=function(s,t,n,l){return new ua(s,t,n,l)},zl=function(s,t,n){var l=pe([s],[],t);return l.height=Math.max(n||t.fontMetrics().defaultRuleThickness,t.minRuleThickness),l.style.borderBottomWidth=L(l.height),l.maxFontSize=1,l},Ml=function(s,t,n,l){var i=new ts(s,t,n,l);return hs(i),i},ht=function(s){var t=new oa(s);return hs(t),t},Rl=function(s,t){return s instanceof oa?pe([],[s],t):s},Al=function(s){if(s.positionType===\"individualShift\"){for(var t=s.children,n=[t[0]],l=-t[0].shift-t[0].elem.depth,i=l,c=1;c\u003ct.length;c++){var d=-t[c].shift-i-t[c].elem.depth,o=d-(t[c-1].elem.height+t[c-1].elem.depth);i=i+d,n.push({type:\"kern\",size:o}),n.push(t[c])}return{children:n,depth:l}}var g;if(s.positionType===\"top\"){for(var y=s.positionData,x=0;x\u003cs.children.length;x++){var w=s.children[x];y-=w.type===\"kern\"?w.size:w.elem.height+w.elem.depth}g=y}else if(s.positionType===\"bottom\")g=-s.positionData;else{var k=s.children[0];if(k.type!==\"elem\")throw new Error('First child must have type \"elem\".');if(s.positionType===\"shift\")g=-k.elem.depth-s.positionData;else if(s.positionType===\"firstBaseline\")g=-k.elem.depth;else throw new Error(\"Invalid positionType \"+s.positionType+\".\")}return{children:s.children,depth:g}},Sl=function(s,t){for(var n=Al(s),l=n.children,i=n.depth,c=0,d=0;d\u003cl.length;d++){var o=l[d];if(o.type===\"elem\"){var g=o.elem;c=Math.max(c,g.maxFontSize,g.height)}}c+=2;var y=pe([\"pstrut\"],[]);y.style.height=L(c);for(var x=[],w=i,k=i,z=i,S=0;S\u003cl.length;S++){var B=l[S];if(B.type===\"kern\")z+=B.size;else{var C=B.elem,E=B.wrapperClasses||[],q=B.wrapperStyle||{},Z=pe(E,[y,C],void 0,q);Z.style.top=L(-c-z-C.depth),B.marginLeft\u0026\u0026(Z.style.marginLeft=B.marginLeft),B.marginRight\u0026\u0026(Z.style.marginRight=B.marginRight),x.push(Z),z+=C.height+C.depth}w=Math.min(w,z),k=Math.max(k,z)}var j=pe([\"vlist\"],x);j.style.height=L(k);var U;if(w\u003c0){var V=pe([],[]),W=pe([\"vlist\"],[V]);W.style.height=L(-w);var Y=pe([\"vlist-s\"],[new ve(\"\\u200B\")]);U=[pe([\"vlist-r\"],[j,Y]),pe([\"vlist-r\"],[W])]}else U=[pe([\"vlist-r\"],[j])];var ie=pe([\"vlist-t\"],U);return U.length===2\u0026\u0026ie.classes.push(\"vlist-t2\"),ie.height=k,ie.depth=-w,ie},Ll=function(s,t){var n=pe([\"mspace\"],[],t),l=J(s,t);return n.style.marginRight=L(l),n},Da=function(s,t,n){var l=\"\";switch(s){case\"amsrm\":l=\"AMS\";break;case\"textrm\":l=\"Main\";break;case\"textsf\":l=\"SansSerif\";break;case\"texttt\":l=\"Typewriter\";break;default:l=s}var i;return t===\"textbf\"\u0026\u0026n===\"textit\"?i=\"BoldItalic\":t===\"textbf\"?i=\"Bold\":t===\"textit\"?i=\"Italic\":i=\"Regular\",l+\"-\"+i},dt={mathbf:{variant:\"bold\",fontName:\"Main-Bold\"},mathrm:{variant:\"normal\",fontName:\"Main-Regular\"},textit:{variant:\"italic\",fontName:\"Main-Italic\"},mathit:{variant:\"italic\",fontName:\"Main-Italic\"},mathnormal:{variant:\"italic\",fontName:\"Math-Italic\"},mathbb:{variant:\"double-struck\",fontName:\"AMS-Regular\"},mathcal:{variant:\"script\",fontName:\"Caligraphic-Regular\"},mathfrak:{variant:\"fraktur\",fontName:\"Fraktur-Regular\"},mathscr:{variant:\"script\",fontName:\"Script-Regular\"},mathsf:{variant:\"sans-serif\",fontName:\"SansSerif-Regular\"},mathtt:{variant:\"monospace\",fontName:\"Typewriter-Regular\"}},pt={vec:[\"vec\",.471,.714],oiintSize1:[\"oiintSize1\",.957,.499],oiintSize2:[\"oiintSize2\",1.472,.659],oiiintSize1:[\"oiiintSize1\",1.304,.499],oiiintSize2:[\"oiiintSize2\",1.98,.659]},Bl=function(s,t){var n=pt[s],l=n[0],i=n[1],c=n[2],d=new je(l),o=new Ce([d],{width:L(i),height:L(c),style:\"width:\"+L(i),viewBox:\"0 0 \"+1e3*i+\" \"+1e3*c,preserveAspectRatio:\"xMinYMin\"}),g=ct([\"overlay\"],[o],t);return g.height=c,g.style.height=L(c),g.style.width=L(i),g},b={fontMap:dt,makeSymbol:we,mathsym:fl,makeSpan:pe,makeSvgSpan:ct,makeLineSpan:zl,makeAnchor:Ml,makeFragment:ht,wrapFragment:Rl,makeVList:Sl,makeOrd:xl,makeGlue:Ll,staticSvg:Bl,svgData:pt,tryCombineChars:kl},Q={number:3,unit:\"mu\"},Ke={number:4,unit:\"mu\"},qe={number:5,unit:\"mu\"},Tl={mord:{mop:Q,mbin:Ke,mrel:qe,minner:Q},mop:{mord:Q,mop:Q,mrel:qe,minner:Q},mbin:{mord:Ke,mop:Ke,mopen:Ke,minner:Ke},mrel:{mord:qe,mop:qe,mopen:qe,minner:qe},mopen:{},mclose:{mop:Q,mbin:Ke,mrel:qe,minner:Q},mpunct:{mord:Q,mop:Q,mrel:qe,mopen:Q,mclose:Q,mpunct:Q,minner:Q},minner:{mord:Q,mop:Q,mbin:Ke,mrel:qe,mopen:Q,mpunct:Q,minner:Q}},Dl={mord:{mop:Q},mop:{mord:Q,mop:Q},mbin:{},mrel:{},mopen:{},mclose:{mop:Q},mpunct:{},minner:{mop:Q}},ot={},Ca={},Ea={};function T(m){for(var s=m.type,t=m.names,n=m.props,l=m.handler,i=m.htmlBuilder,c=m.mathmlBuilder,d={type:s,numArgs:n.numArgs,argTypes:n.argTypes,allowedInArgument:!!n.allowedInArgument,allowedInText:!!n.allowedInText,allowedInMath:n.allowedInMath===void 0?!0:n.allowedInMath,numOptionalArgs:n.numOptionalArgs||0,infix:!!n.infix,primitive:!!n.primitive,handler:l},o=0;o\u003ct.length;++o)ot[t[o]]=d;s\u0026\u0026(i\u0026\u0026(Ca[s]=i),c\u0026\u0026(Ea[s]=c))}function Qe(m){var s=m.type,t=m.htmlBuilder,n=m.mathmlBuilder;T({type:s,names:[],props:{numArgs:0},handler:function(){throw new Error(\"Should never be called.\")},htmlBuilder:t,mathmlBuilder:n})}var qa=function(s){return s.type===\"ordgroup\"\u0026\u0026s.body.length===1?s.body[0]:s},se=function(s){return s.type===\"ordgroup\"?s.body:[s]},Ie=b.makeSpan,Cl=[\"leftmost\",\"mbin\",\"mopen\",\"mrel\",\"mop\",\"mpunct\"],El=[\"rightmost\",\"mrel\",\"mclose\",\"mpunct\"],ql={display:I.DISPLAY,text:I.TEXT,script:I.SCRIPT,scriptscript:I.SCRIPTSCRIPT},Il={mord:\"mord\",mop:\"mop\",mbin:\"mbin\",mrel:\"mrel\",mopen:\"mopen\",mclose:\"mclose\",mpunct:\"mpunct\",minner:\"minner\"},le=function(s,t,n,l){l===void 0\u0026\u0026(l=[null,null]);for(var i=[],c=0;c\u003cs.length;c++){var d=_(s[c],t);if(d instanceof oa){var o=d.children;i.push.apply(i,o)}else i.push(d)}if(b.tryCombineChars(i),!n)return i;var g=t;if(s.length===1){var y=s[0];y.type===\"sizing\"?g=t.havingSize(y.size):y.type===\"styling\"\u0026\u0026(g=t.havingStyle(ql[y.style]))}var x=Ie([l[0]||\"leftmost\"],[],t),w=Ie([l[1]||\"rightmost\"],[],t),k=n===\"root\";return ut(i,function(z,S){var B=S.classes[0],C=z.classes[0];B===\"mbin\"\u0026\u0026O.contains(El,C)?S.classes[0]=\"mord\":C===\"mbin\"\u0026\u0026O.contains(Cl,B)\u0026\u0026(z.classes[0]=\"mord\")},{node:x},w,k),ut(i,function(z,S){var B=ds(S),C=ds(z),E=B\u0026\u0026C?z.hasClass(\"mtight\")?Dl[B][C]:Tl[B][C]:null;if(E)return b.makeGlue(E,g)},{node:x},w,k),i},ut=function m(s,t,n,l,i){l\u0026\u0026s.push(l);for(var c=0;c\u003cs.length;c++){var d=s[c],o=gt(d);if(o){m(o.children,t,n,null,i);continue}var g=!d.hasClass(\"mspace\");if(g){var y=t(d,n.node);y\u0026\u0026(n.insertAfter?n.insertAfter(y):(s.unshift(y),c++))}g?n.node=d:i\u0026\u0026d.hasClass(\"newline\")\u0026\u0026(n.node=Ie([\"leftmost\"])),n.insertAfter=function(x){return function(w){s.splice(x+1,0,w),c++}}(c)}l\u0026\u0026s.pop()},gt=function(s){return s instanceof oa||s instanceof ts||s instanceof ua\u0026\u0026s.hasClass(\"enclosing\")?s:null},Fl=function m(s,t){var n=gt(s);if(n){var l=n.children;if(l.length){if(t===\"right\")return m(l[l.length-1],\"right\");if(t===\"left\")return m(l[0],\"left\")}}return s},ds=function(s,t){return s?(t\u0026\u0026(s=Fl(s,t)),Il[s.classes[0]]||null):null},ga=function(s,t){var n=[\"nulldelimiter\"].concat(s.baseSizingClasses());return Ie(t.concat(n))},_=function(s,t,n){if(!s)return Ie();if(Ca[s.type]){var l=Ca[s.type](s,t);if(n\u0026\u0026t.size!==n.size){l=Ie(t.sizingClasses(n),[l],t);var i=t.sizeMultiplier/n.sizeMultiplier;l.height*=i,l.depth*=i}return l}else throw new A(\"Got group of unknown type: '\"+s.type+\"'\")};function Ia(m,s){var t=Ie([\"base\"],m,s),n=Ie([\"strut\"]);return n.style.height=L(t.height+t.depth),t.depth\u0026\u0026(n.style.verticalAlign=L(-t.depth)),t.children.unshift(n),t}function ps(m,s){var t=null;m.length===1\u0026\u0026m[0].type===\"tag\"\u0026\u0026(t=m[0].tag,m=m[0].body);var n=le(m,s,\"root\"),l;n.length===2\u0026\u0026n[1].hasClass(\"tag\")\u0026\u0026(l=n.pop());for(var i=[],c=[],d=0;d\u003cn.length;d++)if(c.push(n[d]),n[d].hasClass(\"mbin\")||n[d].hasClass(\"mrel\")||n[d].hasClass(\"allowbreak\")){for(var o=!1;d\u003cn.length-1\u0026\u0026n[d+1].hasClass(\"mspace\")\u0026\u0026!n[d+1].hasClass(\"newline\");)d++,c.push(n[d]),n[d].hasClass(\"nobreak\")\u0026\u0026(o=!0);o||(i.push(Ia(c,s)),c=[])}else n[d].hasClass(\"newline\")\u0026\u0026(c.pop(),c.length\u003e0\u0026\u0026(i.push(Ia(c,s)),c=[]),i.push(n[d]));c.length\u003e0\u0026\u0026i.push(Ia(c,s));var g;t?(g=Ia(le(t,s,!0)),g.classes=[\"tag\"],i.push(g)):l\u0026\u0026i.push(l);var y=Ie([\"katex-html\"],i);if(y.setAttribute(\"aria-hidden\",\"true\"),g){var x=g.children[0];x.style.height=L(y.height+y.depth),y.depth\u0026\u0026(x.style.verticalAlign=L(-y.depth))}return y}function Nt(m){return new oa(m)}var ye=function(){function m(t,n,l){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=t,this.attributes={},this.children=n||[],this.classes=l||[]}var s=m.prototype;return s.setAttribute=function(n,l){this.attributes[n]=l},s.getAttribute=function(n){return this.attributes[n]},s.toNode=function(){var n=document.createElementNS(\"http://www.w3.org/1998/Math/MathML\",this.type);for(var l in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,l)\u0026\u0026n.setAttribute(l,this.attributes[l]);this.classes.length\u003e0\u0026\u0026(n.className=Pe(this.classes));for(var i=0;i\u003cthis.children.length;i++)n.appendChild(this.children[i].toNode());return n},s.toMarkup=function(){var n=\"\u003c\"+this.type;for(var l in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,l)\u0026\u0026(n+=\" \"+l+'=\"',n+=O.escape(this.attributes[l]),n+='\"');this.classes.length\u003e0\u0026\u0026(n+=' class =\"'+O.escape(Pe(this.classes))+'\"'),n+=\"\u003e\";for(var i=0;i\u003cthis.children.length;i++)n+=this.children[i].toMarkup();return n+=\"\u003c/\"+this.type+\"\u003e\",n},s.toText=function(){return this.children.map(function(n){return n.toText()}).join(\"\")},m}(),Na=function(){function m(t){this.text=void 0,this.text=t}var s=m.prototype;return s.toNode=function(){return document.createTextNode(this.text)},s.toMarkup=function(){return O.escape(this.toText())},s.toText=function(){return this.text},m}(),Ol=function(){function m(t){this.width=void 0,this.character=void 0,this.width=t,t\u003e=.05555\u0026\u0026t\u003c=.05556?this.character=\"\\u200A\":t\u003e=.1666\u0026\u0026t\u003c=.1667?this.character=\"\\u2009\":t\u003e=.2222\u0026\u0026t\u003c=.2223?this.character=\"\\u2005\":t\u003e=.2777\u0026\u0026t\u003c=.2778?this.character=\"\\u2005\\u200A\":t\u003e=-.05556\u0026\u0026t\u003c=-.05555?this.character=\"\\u200A\\u2063\":t\u003e=-.1667\u0026\u0026t\u003c=-.1666?this.character=\"\\u2009\\u2063\":t\u003e=-.2223\u0026\u0026t\u003c=-.2222?this.character=\"\\u205F\\u2063\":t\u003e=-.2778\u0026\u0026t\u003c=-.2777?this.character=\"\\u2005\\u2063\":this.character=null}var s=m.prototype;return s.toNode=function(){if(this.character)return document.createTextNode(this.character);var n=document.createElementNS(\"http://www.w3.org/1998/Math/MathML\",\"mspace\");return n.setAttribute(\"width\",L(this.width)),n},s.toMarkup=function(){return this.character?\"\u003cmtext\u003e\"+this.character+\"\u003c/mtext\u003e\":'\u003cmspace width=\"'+L(this.width)+'\"/\u003e'},s.toText=function(){return this.character?this.character:\" \"},m}(),R={MathNode:ye,TextNode:Na,SpaceNode:Ol,newDocumentFragment:Nt},fe=function(s,t,n){return K[t][s]\u0026\u0026K[t][s].replace\u0026\u0026s.charCodeAt(0)!==55349\u0026\u0026!(tt.hasOwnProperty(s)\u0026\u0026n\u0026\u0026(n.fontFamily\u0026\u0026n.fontFamily.slice(4,6)===\"tt\"||n.font\u0026\u0026n.font.slice(4,6)===\"tt\"))\u0026\u0026(s=K[t][s].replace),new R.TextNode(s)},os=function(s){return s.length===1?s[0]:new R.MathNode(\"mrow\",s)},us=function(s,t){if(t.fontFamily===\"texttt\")return\"monospace\";if(t.fontFamily===\"textsf\")return t.fontShape===\"textit\"\u0026\u0026t.fontWeight===\"textbf\"?\"sans-serif-bold-italic\":t.fontShape===\"textit\"?\"sans-serif-italic\":t.fontWeight===\"textbf\"?\"bold-sans-serif\":\"sans-serif\";if(t.fontShape===\"textit\"\u0026\u0026t.fontWeight===\"textbf\")return\"bold-italic\";if(t.fontShape===\"textit\")return\"italic\";if(t.fontWeight===\"textbf\")return\"bold\";var n=t.font;if(!n||n===\"mathnormal\")return null;var l=s.mode;if(n===\"mathit\")return\"italic\";if(n===\"boldsymbol\")return s.type===\"textord\"?\"bold\":\"bold-italic\";if(n===\"mathbf\")return\"bold\";if(n===\"mathbb\")return\"double-struck\";if(n===\"mathfrak\")return\"fraktur\";if(n===\"mathscr\"||n===\"mathcal\")return\"script\";if(n===\"mathsf\")return\"sans-serif\";if(n===\"mathtt\")return\"monospace\";var i=s.text;if(O.contains([\"\\\\imath\",\"\\\\jmath\"],i))return null;K[l][i]\u0026\u0026K[l][i].replace\u0026\u0026(i=K[l][i].replace);var c=b.fontMap[n].fontName;return es(i,c,l)?b.fontMap[n].variant:null},oe=function(s,t,n){if(s.length===1){var l=X(s[0],t);return n\u0026\u0026l instanceof ye\u0026\u0026l.type===\"mo\"\u0026\u0026(l.setAttribute(\"lspace\",\"0em\"),l.setAttribute(\"rspace\",\"0em\")),[l]}for(var i=[],c,d=0;d\u003cs.length;d++){var o=X(s[d],t);if(o instanceof ye\u0026\u0026c instanceof ye){if(o.type===\"mtext\"\u0026\u0026c.type===\"mtext\"\u0026\u0026o.getAttribute(\"mathvariant\")===c.getAttribute(\"mathvariant\")){var g;(g=c.children).push.apply(g,o.children);continue}else if(o.type===\"mn\"\u0026\u0026c.type===\"mn\"){var y;(y=c.children).push.apply(y,o.children);continue}else if(o.type===\"mi\"\u0026\u0026o.children.length===1\u0026\u0026c.type===\"mn\"){var x=o.children[0];if(x instanceof Na\u0026\u0026x.text===\".\"){var w;(w=c.children).push.apply(w,o.children);continue}}else if(c.type===\"mi\"\u0026\u0026c.children.length===1){var k=c.children[0];if(k instanceof Na\u0026\u0026k.text===\"\\u0338\"\u0026\u0026(o.type===\"mo\"||o.type===\"mi\"||o.type===\"mn\")){var z=o.children[0];z instanceof Na\u0026\u0026z.text.length\u003e0\u0026\u0026(z.text=z.text.slice(0,1)+\"\\u0338\"+z.text.slice(1),i.pop())}}}i.push(o),c=o}return i},_e=function(s,t,n){return os(oe(s,t,n))},X=function(s,t){if(!s)return new R.MathNode(\"mrow\");if(Ea[s.type]){var n=Ea[s.type](s,t);return n}else throw new A(\"Got group of unknown type: '\"+s.type+\"'\")};function vt(m,s,t,n,l){var i=oe(m,t),c;i.length===1\u0026\u0026i[0]instanceof ye\u0026\u0026O.contains([\"mrow\",\"mtable\"],i[0].type)?c=i[0]:c=new R.MathNode(\"mrow\",i);var d=new R.MathNode(\"annotation\",[new R.TextNode(s)]);d.setAttribute(\"encoding\",\"application/x-tex\");var o=new R.MathNode(\"semantics\",[c,d]),g=new R.MathNode(\"math\",[o]);g.setAttribute(\"xmlns\",\"http://www.w3.org/1998/Math/MathML\"),n\u0026\u0026g.setAttribute(\"display\",\"block\");var y=l?\"katex\":\"katex-mathml\";return b.makeSpan([y],[g])}var yt=function(s){return new dl({style:s.displayMode?I.DISPLAY:I.TEXT,maxSize:s.maxSize,minRuleThickness:s.minRuleThickness})},ft=function(s,t){if(t.displayMode){var n=[\"katex-display\"];t.leqno\u0026\u0026n.push(\"leqno\"),t.fleqn\u0026\u0026n.push(\"fleqn\"),s=b.makeSpan(n,[s])}return s},Hl=function(s,t,n){var l=yt(n),i;if(n.output===\"mathml\")return vt(s,t,l,n.displayMode,!0);if(n.output===\"html\"){var c=ps(s,l);i=b.makeSpan([\"katex\"],[c])}else{var d=vt(s,t,l,n.displayMode,!1),o=ps(s,l);i=b.makeSpan([\"katex\"],[d,o])}return ft(i,n)},Pl=function(s,t,n){var l=yt(n),i=ps(s,l),c=b.makeSpan([\"katex\"],[i]);return ft(c,n)},er=null,jl={widehat:\"^\",widecheck:\"\\u02C7\",widetilde:\"~\",utilde:\"~\",overleftarrow:\"\\u2190\",underleftarrow:\"\\u2190\",xleftarrow:\"\\u2190\",overrightarrow:\"\\u2192\",underrightarrow:\"\\u2192\",xrightarrow:\"\\u2192\",underbrace:\"\\u23DF\",overbrace:\"\\u23DE\",overgroup:\"\\u23E0\",undergroup:\"\\u23E1\",overleftrightarrow:\"\\u2194\",underleftrightarrow:\"\\u2194\",xleftrightarrow:\"\\u2194\",Overrightarrow:\"\\u21D2\",xRightarrow:\"\\u21D2\",overleftharpoon:\"\\u21BC\",xleftharpoonup:\"\\u21BC\",overrightharpoon:\"\\u21C0\",xrightharpoonup:\"\\u21C0\",xLeftarrow:\"\\u21D0\",xLeftrightarrow:\"\\u21D4\",xhookleftarrow:\"\\u21A9\",xhookrightarrow:\"\\u21AA\",xmapsto:\"\\u21A6\",xrightharpoondown:\"\\u21C1\",xleftharpoondown:\"\\u21BD\",xrightleftharpoons:\"\\u21CC\",xleftrightharpoons:\"\\u21CB\",xtwoheadleftarrow:\"\\u219E\",xtwoheadrightarrow:\"\\u21A0\",xlongequal:\"=\",xtofrom:\"\\u21C4\",xrightleftarrows:\"\\u21C4\",xrightequilibrium:\"\\u21CC\",xleftequilibrium:\"\\u21CB\",\"\\\\cdrightarrow\":\"\\u2192\",\"\\\\cdleftarrow\":\"\\u2190\",\"\\\\cdlongequal\":\"=\"},Gl=function(s){var t=new R.MathNode(\"mo\",[new R.TextNode(jl[s.replace(/^\\\\/,\"\")])]);return t.setAttribute(\"stretchy\",\"true\"),t},_l={overrightarrow:[[\"rightarrow\"],.888,522,\"xMaxYMin\"],overleftarrow:[[\"leftarrow\"],.888,522,\"xMinYMin\"],underrightarrow:[[\"rightarrow\"],.888,522,\"xMaxYMin\"],underleftarrow:[[\"leftarrow\"],.888,522,\"xMinYMin\"],xrightarrow:[[\"rightarrow\"],1.469,522,\"xMaxYMin\"],\"\\\\cdrightarrow\":[[\"rightarrow\"],3,522,\"xMaxYMin\"],xleftarrow:[[\"leftarrow\"],1.469,522,\"xMinYMin\"],\"\\\\cdleftarrow\":[[\"leftarrow\"],3,522,\"xMinYMin\"],Overrightarrow:[[\"doublerightarrow\"],.888,560,\"xMaxYMin\"],xRightarrow:[[\"doublerightarrow\"],1.526,560,\"xMaxYMin\"],xLeftarrow:[[\"doubleleftarrow\"],1.526,560,\"xMinYMin\"],overleftharpoon:[[\"leftharpoon\"],.888,522,\"xMinYMin\"],xleftharpoonup:[[\"leftharpoon\"],.888,522,\"xMinYMin\"],xleftharpoondown:[[\"leftharpoondown\"],.888,522,\"xMinYMin\"],overrightharpoon:[[\"rightharpoon\"],.888,522,\"xMaxYMin\"],xrightharpoonup:[[\"rightharpoon\"],.888,522,\"xMaxYMin\"],xrightharpoondown:[[\"rightharpoondown\"],.888,522,\"xMaxYMin\"],xlongequal:[[\"longequal\"],.888,334,\"xMinYMin\"],\"\\\\cdlongequal\":[[\"longequal\"],3,334,\"xMinYMin\"],xtwoheadleftarrow:[[\"twoheadleftarrow\"],.888,334,\"xMinYMin\"],xtwoheadrightarrow:[[\"twoheadrightarrow\"],.888,334,\"xMaxYMin\"],overleftrightarrow:[[\"leftarrow\",\"rightarrow\"],.888,522],overbrace:[[\"leftbrace\",\"midbrace\",\"rightbrace\"],1.6,548],underbrace:[[\"leftbraceunder\",\"midbraceunder\",\"rightbraceunder\"],1.6,548],underleftrightarrow:[[\"leftarrow\",\"rightarrow\"],.888,522],xleftrightarrow:[[\"leftarrow\",\"rightarrow\"],1.75,522],xLeftrightarrow:[[\"doubleleftarrow\",\"doublerightarrow\"],1.75,560],xrightleftharpoons:[[\"leftharpoondownplus\",\"rightharpoonplus\"],1.75,716],xleftrightharpoons:[[\"leftharpoonplus\",\"rightharpoondownplus\"],1.75,716],xhookleftarrow:[[\"leftarrow\",\"righthook\"],1.08,522],xhookrightarrow:[[\"lefthook\",\"rightarrow\"],1.08,522],overlinesegment:[[\"leftlinesegment\",\"rightlinesegment\"],.888,522],underlinesegment:[[\"leftlinesegment\",\"rightlinesegment\"],.888,522],overgroup:[[\"leftgroup\",\"rightgroup\"],.888,342],undergroup:[[\"leftgroupunder\",\"rightgroupunder\"],.888,342],xmapsto:[[\"leftmapsto\",\"rightarrow\"],1.5,522],xtofrom:[[\"leftToFrom\",\"rightToFrom\"],1.75,528],xrightleftarrows:[[\"baraboveleftarrow\",\"rightarrowabovebar\"],1.75,901],xrightequilibrium:[[\"baraboveshortleftharpoon\",\"rightharpoonaboveshortbar\"],1.75,716],xleftequilibrium:[[\"shortbaraboveleftharpoon\",\"shortrightharpoonabovebar\"],1.75,716]},Vl=function(s){return s.type===\"ordgroup\"?s.body.length:1},Zl=function(s,t){function n(){var o=4e5,g=s.label.slice(1);if(O.contains([\"widehat\",\"widecheck\",\"widetilde\",\"utilde\"],g)){var y=s,x=Vl(y.base),w,k,z;if(x\u003e5)g===\"widehat\"||g===\"widecheck\"?(w=420,o=2364,z=.42,k=g+\"4\"):(w=312,o=2340,z=.34,k=\"tilde4\");else{var S=[1,1,2,2,3,3][x];g===\"widehat\"||g===\"widecheck\"?(o=[0,1062,2364,2364,2364][S],w=[0,239,300,360,420][S],z=[0,.24,.3,.3,.36,.42][S],k=g+S):(o=[0,600,1033,2339,2340][S],w=[0,260,286,306,312][S],z=[0,.26,.286,.3,.306,.34][S],k=\"tilde\"+S)}var B=new je(k),C=new Ce([B],{width:\"100%\",height:L(z),viewBox:\"0 0 \"+o+\" \"+w,preserveAspectRatio:\"none\"});return{span:b.makeSvgSpan([],[C],t),minWidth:0,height:z}}else{var E=[],q=_l[g],Z=q[0],j=q[1],U=q[2],V=U/1e3,W=Z.length,Y,ie;if(W===1){var ge=q[3];Y=[\"hide-tail\"],ie=[ge]}else if(W===2)Y=[\"halfarrow-left\",\"halfarrow-right\"],ie=[\"xMinYMin\",\"xMaxYMin\"];else if(W===3)Y=[\"brace-left\",\"brace-center\",\"brace-right\"],ie=[\"xMinYMin\",\"xMidYMin\",\"xMaxYMin\"];else throw new Error(`Correct katexImagesData or update code here to support\n                    `+W+\" children.\");for(var ee=0;ee\u003cW;ee++){var ea=new je(Z[ee]),be=new Ce([ea],{width:\"400em\",height:L(V),viewBox:\"0 0 \"+o+\" \"+U,preserveAspectRatio:ie[ee]+\" slice\"}),he=b.makeSvgSpan([Y[ee]],[be],t);if(W===1)return{span:he,minWidth:j,height:V};he.style.height=L(V),E.push(he)}return{span:b.makeSpan([\"stretchy\"],E,t),minWidth:j,height:V}}}var l=n(),i=l.span,c=l.minWidth,d=l.height;return i.height=d,i.style.height=L(d),c\u003e0\u0026\u0026(i.style.minWidth=L(c)),i},Ul=function(s,t,n,l,i){var c,d=s.height+s.depth+n+l;if(/fbox|color|angl/.test(t)){if(c=b.makeSpan([\"stretchy\",t],[],i),t===\"fbox\"){var o=i.color\u0026\u0026i.getColor();o\u0026\u0026(c.style.borderColor=o)}}else{var g=[];/^[bx]cancel$/.test(t)\u0026\u0026g.push(new ns({x1:\"0\",y1:\"0\",x2:\"100%\",y2:\"100%\",\"stroke-width\":\"0.046em\"})),/^x?cancel$/.test(t)\u0026\u0026g.push(new ns({x1:\"0\",y1:\"100%\",x2:\"100%\",y2:\"0\",\"stroke-width\":\"0.046em\"}));var y=new Ce(g,{width:\"100%\",height:L(d)});c=b.makeSvgSpan([],[y],i)}return c.height=d,c.style.height=L(d),c},Fe={encloseSpan:Ul,mathMLnode:Gl,svgSpan:Zl};function P(m,s){if(!m||m.type!==s)throw new Error(\"Expected node of type \"+s+\", but got \"+(m?\"node of type \"+m.type:String(m)));return m}function gs(m){var s=Fa(m);if(!s)throw new Error(\"Expected node of symbol group type, but got \"+(m?\"node of type \"+m.type:String(m)));return s}function Fa(m){return m\u0026\u0026(m.type===\"atom\"||vl.hasOwnProperty(m.type))?m:null}var Ns=function(s,t){var n,l,i;s\u0026\u0026s.type===\"supsub\"?(l=P(s.base,\"accent\"),n=l.base,s.base=n,i=gl(_(s,t)),s.base=l):(l=P(s,\"accent\"),n=l.base);var c=_(n,t.havingCrampedStyle()),d=l.isShifty\u0026\u0026O.isCharacterBox(n),o=0;if(d){var g=O.getBaseElem(n),y=_(g,t.havingCrampedStyle());o=st(y).skew}var x=l.label===\"\\\\c\",w=x?c.height+c.depth:Math.min(c.height,t.fontMetrics().xHeight),k;if(l.isStretchy)k=Fe.svgSpan(l,t),k=b.makeVList({positionType:\"firstBaseline\",children:[{type:\"elem\",elem:c},{type:\"elem\",elem:k,wrapperClasses:[\"svg-align\"],wrapperStyle:o\u003e0?{width:\"calc(100% - \"+L(2*o)+\")\",marginLeft:L(2*o)}:void 0}]},t);else{var z,S;l.label===\"\\\\vec\"?(z=b.staticSvg(\"vec\",t),S=b.svgData.vec[1]):(z=b.makeOrd({mode:l.mode,text:l.label},t,\"textord\"),z=st(z),z.italic=0,S=z.width,x\u0026\u0026(w+=z.depth)),k=b.makeSpan([\"accent-body\"],[z]);var B=l.label===\"\\\\textcircled\";B\u0026\u0026(k.classes.push(\"accent-full\"),w=c.height);var C=o;B||(C-=S/2),k.style.left=L(C),l.label===\"\\\\textcircled\"\u0026\u0026(k.style.top=\".2em\"),k=b.makeVList({positionType:\"firstBaseline\",children:[{type:\"elem\",elem:c},{type:\"kern\",size:-w},{type:\"elem\",elem:k}]},t)}var E=b.makeSpan([\"mord\",\"accent\"],[k],t);return i?(i.children[0]=E,i.height=Math.max(E.height,i.height),i.classes[0]=\"mord\",i):E},bt=function(s,t){var n=s.isStretchy?Fe.mathMLnode(s.label):new R.MathNode(\"mo\",[fe(s.label,s.mode)]),l=new R.MathNode(\"mover\",[X(s.base,t),n]);return l.setAttribute(\"accent\",\"true\"),l},Wl=new RegExp([\"\\\\acute\",\"\\\\grave\",\"\\\\ddot\",\"\\\\tilde\",\"\\\\bar\",\"\\\\breve\",\"\\\\check\",\"\\\\hat\",\"\\\\vec\",\"\\\\dot\",\"\\\\mathring\"].map(function(m){return\"\\\\\"+m}).join(\"|\"));T({type:\"accent\",names:[\"\\\\acute\",\"\\\\grave\",\"\\\\ddot\",\"\\\\tilde\",\"\\\\bar\",\"\\\\breve\",\"\\\\check\",\"\\\\hat\",\"\\\\vec\",\"\\\\dot\",\"\\\\mathring\",\"\\\\widecheck\",\"\\\\widehat\",\"\\\\widetilde\",\"\\\\overrightarrow\",\"\\\\overleftarrow\",\"\\\\Overrightarrow\",\"\\\\overleftrightarrow\",\"\\\\overgroup\",\"\\\\overlinesegment\",\"\\\\overleftharpoon\",\"\\\\overrightharpoon\"],props:{numArgs:1},handler:function(s,t){var n=qa(t[0]),l=!Wl.test(s.funcName),i=!l||s.funcName===\"\\\\widehat\"||s.funcName===\"\\\\widetilde\"||s.funcName===\"\\\\widecheck\";return{type:\"accent\",mode:s.parser.mode,label:s.funcName,isStretchy:l,isShifty:i,base:n}},htmlBuilder:Ns,mathmlBuilder:bt}),T({type:\"accent\",names:[\"\\\\'\",\"\\\\`\",\"\\\\^\",\"\\\\~\",\"\\\\=\",\"\\\\u\",\"\\\\.\",'\\\\\"',\"\\\\c\",\"\\\\r\",\"\\\\H\",\"\\\\v\",\"\\\\textcircled\"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:[\"primitive\"]},handler:function(s,t){var n=t[0],l=s.parser.mode;return l===\"math\"\u0026\u0026(s.parser.settings.reportNonstrict(\"mathVsTextAccents\",\"LaTeX's accent \"+s.funcName+\" works only in text mode\"),l=\"text\"),{type:\"accent\",mode:l,label:s.funcName,isStretchy:!1,isShifty:!0,base:n}},htmlBuilder:Ns,mathmlBuilder:bt}),T({type:\"accentUnder\",names:[\"\\\\underleftarrow\",\"\\\\underrightarrow\",\"\\\\underleftrightarrow\",\"\\\\undergroup\",\"\\\\underlinesegment\",\"\\\\utilde\"],props:{numArgs:1},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0];return{type:\"accentUnder\",mode:n.mode,label:l,base:i}},htmlBuilder:function(s,t){var n=_(s.base,t),l=Fe.svgSpan(s,t),i=s.label===\"\\\\utilde\"?.12:0,c=b.makeVList({positionType:\"top\",positionData:n.height,children:[{type:\"elem\",elem:l,wrapperClasses:[\"svg-align\"]},{type:\"kern\",size:i},{type:\"elem\",elem:n}]},t);return b.makeSpan([\"mord\",\"accentunder\"],[c],t)},mathmlBuilder:function(s,t){var n=Fe.mathMLnode(s.label),l=new R.MathNode(\"munder\",[X(s.base,t),n]);return l.setAttribute(\"accentunder\",\"true\"),l}});var Oa=function(s){var t=new R.MathNode(\"mpadded\",s?[s]:[]);return t.setAttribute(\"width\",\"+0.6em\"),t.setAttribute(\"lspace\",\"0.3em\"),t};T({type:\"xArrow\",names:[\"\\\\xleftarrow\",\"\\\\xrightarrow\",\"\\\\xLeftarrow\",\"\\\\xRightarrow\",\"\\\\xleftrightarrow\",\"\\\\xLeftrightarrow\",\"\\\\xhookleftarrow\",\"\\\\xhookrightarrow\",\"\\\\xmapsto\",\"\\\\xrightharpoondown\",\"\\\\xrightharpoonup\",\"\\\\xleftharpoondown\",\"\\\\xleftharpoonup\",\"\\\\xrightleftharpoons\",\"\\\\xleftrightharpoons\",\"\\\\xlongequal\",\"\\\\xtwoheadrightarrow\",\"\\\\xtwoheadleftarrow\",\"\\\\xtofrom\",\"\\\\xrightleftarrows\",\"\\\\xrightequilibrium\",\"\\\\xleftequilibrium\",\"\\\\\\\\cdrightarrow\",\"\\\\\\\\cdleftarrow\",\"\\\\\\\\cdlongequal\"],props:{numArgs:1,numOptionalArgs:1},handler:function(s,t,n){var l=s.parser,i=s.funcName;return{type:\"xArrow\",mode:l.mode,label:i,body:t[0],below:n[0]}},htmlBuilder:function(s,t){var n=t.style,l=t.havingStyle(n.sup()),i=b.wrapFragment(_(s.body,l,t),t),c=s.label.slice(0,2)===\"\\\\x\"?\"x\":\"cd\";i.classes.push(c+\"-arrow-pad\");var d;s.below\u0026\u0026(l=t.havingStyle(n.sub()),d=b.wrapFragment(_(s.below,l,t),t),d.classes.push(c+\"-arrow-pad\"));var o=Fe.svgSpan(s,t),g=-t.fontMetrics().axisHeight+.5*o.height,y=-t.fontMetrics().axisHeight-.5*o.height-.111;(i.depth\u003e.25||s.label===\"\\\\xleftequilibrium\")\u0026\u0026(y-=i.depth);var x;if(d){var w=-t.fontMetrics().axisHeight+d.height+.5*o.height+.111;x=b.makeVList({positionType:\"individualShift\",children:[{type:\"elem\",elem:i,shift:y},{type:\"elem\",elem:o,shift:g},{type:\"elem\",elem:d,shift:w}]},t)}else x=b.makeVList({positionType:\"individualShift\",children:[{type:\"elem\",elem:i,shift:y},{type:\"elem\",elem:o,shift:g}]},t);return x.children[0].children[0].children[1].classes.push(\"svg-align\"),b.makeSpan([\"mrel\",\"x-arrow\"],[x],t)},mathmlBuilder:function(s,t){var n=Fe.mathMLnode(s.label);n.setAttribute(\"minsize\",s.label.charAt(0)===\"x\"?\"1.75em\":\"3.0em\");var l;if(s.body){var i=Oa(X(s.body,t));if(s.below){var c=Oa(X(s.below,t));l=new R.MathNode(\"munderover\",[n,c,i])}else l=new R.MathNode(\"mover\",[n,i])}else if(s.below){var d=Oa(X(s.below,t));l=new R.MathNode(\"munder\",[n,d])}else l=Oa(),l=new R.MathNode(\"mover\",[n,l]);return l}});var Xl=b.makeSpan;function xt(m,s){var t=le(m.body,s,!0);return Xl([m.mclass],t,s)}function wt(m,s){var t,n=oe(m.body,s);return m.mclass===\"minner\"?t=new R.MathNode(\"mpadded\",n):m.mclass===\"mord\"?m.isCharacterBox?(t=n[0],t.type=\"mi\"):t=new R.MathNode(\"mi\",n):(m.isCharacterBox?(t=n[0],t.type=\"mo\"):t=new R.MathNode(\"mo\",n),m.mclass===\"mbin\"?(t.attributes.lspace=\"0.22em\",t.attributes.rspace=\"0.22em\"):m.mclass===\"mpunct\"?(t.attributes.lspace=\"0em\",t.attributes.rspace=\"0.17em\"):m.mclass===\"mopen\"||m.mclass===\"mclose\"?(t.attributes.lspace=\"0em\",t.attributes.rspace=\"0em\"):m.mclass===\"minner\"\u0026\u0026(t.attributes.lspace=\"0.0556em\",t.attributes.width=\"+0.1111em\")),t}T({type:\"mclass\",names:[\"\\\\mathord\",\"\\\\mathbin\",\"\\\\mathrel\",\"\\\\mathopen\",\"\\\\mathclose\",\"\\\\mathpunct\",\"\\\\mathinner\"],props:{numArgs:1,primitive:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0];return{type:\"mclass\",mode:n.mode,mclass:\"m\"+l.slice(5),body:se(i),isCharacterBox:O.isCharacterBox(i)}},htmlBuilder:xt,mathmlBuilder:wt});var Ha=function(s){var t=s.type===\"ordgroup\"\u0026\u0026s.body.length?s.body[0]:s;return t.type===\"atom\"\u0026\u0026(t.family===\"bin\"||t.family===\"rel\")?\"m\"+t.family:\"mord\"};T({type:\"mclass\",names:[\"\\\\@binrel\"],props:{numArgs:2},handler:function(s,t){var n=s.parser;return{type:\"mclass\",mode:n.mode,mclass:Ha(t[0]),body:se(t[1]),isCharacterBox:O.isCharacterBox(t[1])}}}),T({type:\"mclass\",names:[\"\\\\stackrel\",\"\\\\overset\",\"\\\\underset\"],props:{numArgs:2},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[1],c=t[0],d;l!==\"\\\\stackrel\"?d=Ha(i):d=\"mrel\";var o={type:\"op\",mode:i.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:l!==\"\\\\stackrel\",body:se(i)},g={type:\"supsub\",mode:c.mode,base:o,sup:l===\"\\\\underset\"?null:c,sub:l===\"\\\\underset\"?c:null};return{type:\"mclass\",mode:n.mode,mclass:d,body:[g],isCharacterBox:O.isCharacterBox(g)}},htmlBuilder:xt,mathmlBuilder:wt}),T({type:\"pmb\",names:[\"\\\\pmb\"],props:{numArgs:1,allowedInText:!0},handler:function(s,t){var n=s.parser;return{type:\"pmb\",mode:n.mode,mclass:Ha(t[0]),body:se(t[0])}},htmlBuilder:function(s,t){var n=le(s.body,t,!0),l=b.makeSpan([s.mclass],n,t);return l.style.textShadow=\"0.02em 0.01em 0.04px\",l},mathmlBuilder:function(s,t){var n=oe(s.body,t),l=new R.MathNode(\"mstyle\",n);return l.setAttribute(\"style\",\"text-shadow: 0.02em 0.01em 0.04px\"),l}});var Yl={\"\u003e\":\"\\\\\\\\cdrightarrow\",\"\u003c\":\"\\\\\\\\cdleftarrow\",\"=\":\"\\\\\\\\cdlongequal\",A:\"\\\\uparrow\",V:\"\\\\downarrow\",\"|\":\"\\\\Vert\",\".\":\"no arrow\"},kt=function(){return{type:\"styling\",body:[],mode:\"math\",style:\"display\"}},zt=function(s){return s.type===\"textord\"\u0026\u0026s.text===\"@\"},$l=function(s,t){return(s.type===\"mathord\"||s.type===\"atom\")\u0026\u0026s.text===t};function Jl(m,s,t){var n=Yl[m];switch(n){case\"\\\\\\\\cdrightarrow\":case\"\\\\\\\\cdleftarrow\":return t.callFunction(n,[s[0]],[s[1]]);case\"\\\\uparrow\":case\"\\\\downarrow\":{var l=t.callFunction(\"\\\\\\\\cdleft\",[s[0]],[]),i={type:\"atom\",text:n,mode:\"math\",family:\"rel\"},c=t.callFunction(\"\\\\Big\",[i],[]),d=t.callFunction(\"\\\\\\\\cdright\",[s[1]],[]),o={type:\"ordgroup\",mode:\"math\",body:[l,c,d]};return t.callFunction(\"\\\\\\\\cdparent\",[o],[])}case\"\\\\\\\\cdlongequal\":return t.callFunction(\"\\\\\\\\cdlongequal\",[],[]);case\"\\\\Vert\":{var g={type:\"textord\",text:\"\\\\Vert\",mode:\"math\"};return t.callFunction(\"\\\\Big\",[g],[])}default:return{type:\"textord\",text:\" \",mode:\"math\"}}}function Kl(m){var s=[];for(m.gullet.beginGroup(),m.gullet.macros.set(\"\\\\cr\",\"\\\\\\\\\\\\relax\"),m.gullet.beginGroup();;){s.push(m.parseExpression(!1,\"\\\\\\\\\")),m.gullet.endGroup(),m.gullet.beginGroup();var t=m.fetch().text;if(t===\"\u0026\"||t===\"\\\\\\\\\")m.consume();else if(t===\"\\\\end\"){s[s.length-1].length===0\u0026\u0026s.pop();break}else throw new A(\"Expected \\\\\\\\ or \\\\cr or \\\\end\",m.nextToken)}for(var n=[],l=[n],i=0;i\u003cs.length;i++){for(var c=s[i],d=kt(),o=0;o\u003cc.length;o++)if(!zt(c[o]))d.body.push(c[o]);else{n.push(d),o+=1;var g=gs(c[o]).text,y=new Array(2);if(y[0]={type:\"ordgroup\",mode:\"math\",body:[]},y[1]={type:\"ordgroup\",mode:\"math\",body:[]},!(\"=|.\".indexOf(g)\u003e-1))if(\"\u003c\u003eAV\".indexOf(g)\u003e-1)for(var x=0;x\u003c2;x++){for(var w=!0,k=o+1;k\u003cc.length;k++){if($l(c[k],g)){w=!1,o=k;break}if(zt(c[k]))throw new A(\"Missing a \"+g+\" character to complete a CD arrow.\",c[k]);y[x].body.push(c[k])}if(w)throw new A(\"Missing a \"+g+\" character to complete a CD arrow.\",c[o])}else throw new A('Expected one of \"\u003c\u003eAV=|.\" after @',c[o]);var z=Jl(g,y,m),S={type:\"styling\",body:[z],mode:\"math\",style:\"display\"};n.push(S),d=kt()}i%2===0?n.push(d):n.shift(),n=[],l.push(n)}m.gullet.endGroup(),m.gullet.endGroup();var B=new Array(l[0].length).fill({type:\"align\",align:\"c\",pregap:.25,postgap:.25});return{type:\"array\",mode:\"math\",body:l,arraystretch:1,addJot:!0,rowGaps:[null],cols:B,colSeparationType:\"CD\",hLinesBeforeRow:new Array(l.length+1).fill([])}}T({type:\"cdlabel\",names:[\"\\\\\\\\cdleft\",\"\\\\\\\\cdright\"],props:{numArgs:1},handler:function(s,t){var n=s.parser,l=s.funcName;return{type:\"cdlabel\",mode:n.mode,side:l.slice(4),label:t[0]}},htmlBuilder:function(s,t){var n=t.havingStyle(t.style.sup()),l=b.wrapFragment(_(s.label,n,t),t);return l.classes.push(\"cd-label-\"+s.side),l.style.bottom=L(.8-l.depth),l.height=0,l.depth=0,l},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mrow\",[X(s.label,t)]);return n=new R.MathNode(\"mpadded\",[n]),n.setAttribute(\"width\",\"0\"),s.side===\"left\"\u0026\u0026n.setAttribute(\"lspace\",\"-1width\"),n.setAttribute(\"voffset\",\"0.7em\"),n=new R.MathNode(\"mstyle\",[n]),n.setAttribute(\"displaystyle\",\"false\"),n.setAttribute(\"scriptlevel\",\"1\"),n}}),T({type:\"cdlabelparent\",names:[\"\\\\\\\\cdparent\"],props:{numArgs:1},handler:function(s,t){var n=s.parser;return{type:\"cdlabelparent\",mode:n.mode,fragment:t[0]}},htmlBuilder:function(s,t){var n=b.wrapFragment(_(s.fragment,t),t);return n.classes.push(\"cd-vert-arrow\"),n},mathmlBuilder:function(s,t){return new R.MathNode(\"mrow\",[X(s.fragment,t)])}}),T({type:\"textord\",names:[\"\\\\@char\"],props:{numArgs:1,allowedInText:!0},handler:function(s,t){for(var n=s.parser,l=P(t[0],\"ordgroup\"),i=l.body,c=\"\",d=0;d\u003ci.length;d++){var o=P(i[d],\"textord\");c+=o.text}var g=parseInt(c),y;if(isNaN(g))throw new A(\"\\\\@char has non-numeric argument \"+c);if(g\u003c0||g\u003e=1114111)throw new A(\"\\\\@char with invalid code point \"+c);return g\u003c=65535?y=String.fromCharCode(g):(g-=65536,y=String.fromCharCode((g\u003e\u003e10)+55296,(g\u00261023)+56320)),{type:\"textord\",mode:n.mode,text:y}}});var Mt=function(s,t){var n=le(s.body,t.withColor(s.color),!1);return b.makeFragment(n)},Rt=function(s,t){var n=oe(s.body,t.withColor(s.color)),l=new R.MathNode(\"mstyle\",n);return l.setAttribute(\"mathcolor\",s.color),l};T({type:\"color\",names:[\"\\\\textcolor\"],props:{numArgs:2,allowedInText:!0,argTypes:[\"color\",\"original\"]},handler:function(s,t){var n=s.parser,l=P(t[0],\"color-token\").color,i=t[1];return{type:\"color\",mode:n.mode,color:l,body:se(i)}},htmlBuilder:Mt,mathmlBuilder:Rt}),T({type:\"color\",names:[\"\\\\color\"],props:{numArgs:1,allowedInText:!0,argTypes:[\"color\"]},handler:function(s,t){var n=s.parser,l=s.breakOnTokenText,i=P(t[0],\"color-token\").color;n.gullet.macros.set(\"\\\\current@color\",i);var c=n.parseExpression(!0,l);return{type:\"color\",mode:n.mode,color:i,body:c}},htmlBuilder:Mt,mathmlBuilder:Rt}),T({type:\"cr\",names:[\"\\\\\\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler:function(s,t,n){var l=s.parser,i=l.gullet.future().text===\"[\"?l.parseSizeGroup(!0):null,c=!l.settings.displayMode||!l.settings.useStrictBehavior(\"newLineInDisplayMode\",\"In LaTeX, \\\\\\\\ or \\\\newline does nothing in display mode\");return{type:\"cr\",mode:l.mode,newLine:c,size:i\u0026\u0026P(i,\"size\").value}},htmlBuilder:function(s,t){var n=b.makeSpan([\"mspace\"],[],t);return s.newLine\u0026\u0026(n.classes.push(\"newline\"),s.size\u0026\u0026(n.style.marginTop=L(J(s.size,t)))),n},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mspace\");return s.newLine\u0026\u0026(n.setAttribute(\"linebreak\",\"newline\"),s.size\u0026\u0026n.setAttribute(\"height\",L(J(s.size,t)))),n}});var vs={\"\\\\global\":\"\\\\global\",\"\\\\long\":\"\\\\\\\\globallong\",\"\\\\\\\\globallong\":\"\\\\\\\\globallong\",\"\\\\def\":\"\\\\gdef\",\"\\\\gdef\":\"\\\\gdef\",\"\\\\edef\":\"\\\\xdef\",\"\\\\xdef\":\"\\\\xdef\",\"\\\\let\":\"\\\\\\\\globallet\",\"\\\\futurelet\":\"\\\\\\\\globalfuture\"},At=function(s){var t=s.text;if(/^(?:[\\\\{}$\u0026#^_]|EOF)$/.test(t))throw new A(\"Expected a control sequence\",s);return t},Ql=function(s){var t=s.gullet.popToken();return t.text===\"=\"\u0026\u0026(t=s.gullet.popToken(),t.text===\" \"\u0026\u0026(t=s.gullet.popToken())),t},St=function(s,t,n,l){var i=s.gullet.macros.get(n.text);i==null\u0026\u0026(n.noexpand=!0,i={tokens:[n],numArgs:0,unexpandable:!s.gullet.isExpandable(n.text)}),s.gullet.macros.set(t,i,l)};T({type:\"internal\",names:[\"\\\\global\",\"\\\\long\",\"\\\\\\\\globallong\"],props:{numArgs:0,allowedInText:!0},handler:function(s){var t=s.parser,n=s.funcName;t.consumeSpaces();var l=t.fetch();if(vs[l.text])return(n===\"\\\\global\"||n===\"\\\\\\\\globallong\")\u0026\u0026(l.text=vs[l.text]),P(t.parseFunction(),\"internal\");throw new A(\"Invalid token after macro prefix\",l)}}),T({type:\"internal\",names:[\"\\\\def\",\"\\\\gdef\",\"\\\\edef\",\"\\\\xdef\"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler:function(s){var t=s.parser,n=s.funcName,l=t.gullet.popToken(),i=l.text;if(/^(?:[\\\\{}$\u0026#^_]|EOF)$/.test(i))throw new A(\"Expected a control sequence\",l);for(var c=0,d,o=[[]];t.gullet.future().text!==\"{\";)if(l=t.gullet.popToken(),l.text===\"#\"){if(t.gullet.future().text===\"{\"){d=t.gullet.future(),o[c].push(\"{\");break}if(l=t.gullet.popToken(),!/^[1-9]$/.test(l.text))throw new A('Invalid argument number \"'+l.text+'\"');if(parseInt(l.text)!==c+1)throw new A('Argument number \"'+l.text+'\" out of order');c++,o.push([])}else{if(l.text===\"EOF\")throw new A(\"Expected a macro definition\");o[c].push(l.text)}var g=t.gullet.consumeArg(),y=g.tokens;return d\u0026\u0026y.unshift(d),(n===\"\\\\edef\"||n===\"\\\\xdef\")\u0026\u0026(y=t.gullet.expandTokens(y),y.reverse()),t.gullet.macros.set(i,{tokens:y,numArgs:c,delimiters:o},n===vs[n]),{type:\"internal\",mode:t.mode}}}),T({type:\"internal\",names:[\"\\\\let\",\"\\\\\\\\globallet\"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler:function(s){var t=s.parser,n=s.funcName,l=At(t.gullet.popToken());t.gullet.consumeSpaces();var i=Ql(t);return St(t,l,i,n===\"\\\\\\\\globallet\"),{type:\"internal\",mode:t.mode}}}),T({type:\"internal\",names:[\"\\\\futurelet\",\"\\\\\\\\globalfuture\"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler:function(s){var t=s.parser,n=s.funcName,l=At(t.gullet.popToken()),i=t.gullet.popToken(),c=t.gullet.popToken();return St(t,l,c,n===\"\\\\\\\\globalfuture\"),t.gullet.pushToken(c),t.gullet.pushToken(i),{type:\"internal\",mode:t.mode}}});var va=function(s,t,n){var l=K.math[s]\u0026\u0026K.math[s].replace,i=es(l||s,t,n);if(!i)throw new Error(\"Unsupported symbol \"+s+\" and font size \"+t+\".\");return i},ys=function(s,t,n,l){var i=n.havingBaseStyle(t),c=b.makeSpan(l.concat(i.sizingClasses(n)),[s],n),d=i.sizeMultiplier/n.sizeMultiplier;return c.height*=d,c.depth*=d,c.maxFontSize=i.sizeMultiplier,c},Lt=function(s,t,n){var l=t.havingBaseStyle(n),i=(1-t.sizeMultiplier/l.sizeMultiplier)*t.fontMetrics().axisHeight;s.classes.push(\"delimcenter\"),s.style.top=L(i),s.height-=i,s.depth+=i},ei=function(s,t,n,l,i,c){var d=b.makeSymbol(s,\"Main-Regular\",i,l),o=ys(d,t,l,c);return n\u0026\u0026Lt(o,l,t),o},ai=function(s,t,n,l){return b.makeSymbol(s,\"Size\"+t+\"-Regular\",n,l)},Bt=function(s,t,n,l,i,c){var d=ai(s,t,i,l),o=ys(b.makeSpan([\"delimsizing\",\"size\"+t],[d],l),I.TEXT,l,c);return n\u0026\u0026Lt(o,l,I.TEXT),o},fs=function(s,t,n){var l;t===\"Size1-Regular\"?l=\"delim-size1\":l=\"delim-size4\";var i=b.makeSpan([\"delimsizinginner\",l],[b.makeSpan([],[b.makeSymbol(s,t,n)])]);return{type:\"elem\",elem:i}},bs=function(s,t,n){var l=Ae[\"Size4-Regular\"][s.charCodeAt(0)]?Ae[\"Size4-Regular\"][s.charCodeAt(0)][4]:Ae[\"Size1-Regular\"][s.charCodeAt(0)][4],i=new je(\"inner\",il(s,Math.round(1e3*t))),c=new Ce([i],{width:L(l),height:L(t),style:\"width:\"+L(l),viewBox:\"0 0 \"+1e3*l+\" \"+Math.round(1e3*t),preserveAspectRatio:\"xMinYMin\"}),d=b.makeSvgSpan([],[c],n);return d.height=t,d.style.height=L(t),d.style.width=L(l),{type:\"elem\",elem:d}},xs=.008,Pa={type:\"kern\",size:-1*xs},si=[\"|\",\"\\\\lvert\",\"\\\\rvert\",\"\\\\vert\"],ti=[\"\\\\|\",\"\\\\lVert\",\"\\\\rVert\",\"\\\\Vert\"],Tt=function(s,t,n,l,i,c){var d,o,g,y,x=\"\",w=0;d=g=y=s,o=null;var k=\"Size1-Regular\";s===\"\\\\uparrow\"?g=y=\"\\u23D0\":s===\"\\\\Uparrow\"?g=y=\"\\u2016\":s===\"\\\\downarrow\"?d=g=\"\\u23D0\":s===\"\\\\Downarrow\"?d=g=\"\\u2016\":s===\"\\\\updownarrow\"?(d=\"\\\\uparrow\",g=\"\\u23D0\",y=\"\\\\downarrow\"):s===\"\\\\Updownarrow\"?(d=\"\\\\Uparrow\",g=\"\\u2016\",y=\"\\\\Downarrow\"):O.contains(si,s)?(g=\"\\u2223\",x=\"vert\",w=333):O.contains(ti,s)?(g=\"\\u2225\",x=\"doublevert\",w=556):s===\"[\"||s===\"\\\\lbrack\"?(d=\"\\u23A1\",g=\"\\u23A2\",y=\"\\u23A3\",k=\"Size4-Regular\",x=\"lbrack\",w=667):s===\"]\"||s===\"\\\\rbrack\"?(d=\"\\u23A4\",g=\"\\u23A5\",y=\"\\u23A6\",k=\"Size4-Regular\",x=\"rbrack\",w=667):s===\"\\\\lfloor\"||s===\"\\u230A\"?(g=d=\"\\u23A2\",y=\"\\u23A3\",k=\"Size4-Regular\",x=\"lfloor\",w=667):s===\"\\\\lceil\"||s===\"\\u2308\"?(d=\"\\u23A1\",g=y=\"\\u23A2\",k=\"Size4-Regular\",x=\"lceil\",w=667):s===\"\\\\rfloor\"||s===\"\\u230B\"?(g=d=\"\\u23A5\",y=\"\\u23A6\",k=\"Size4-Regular\",x=\"rfloor\",w=667):s===\"\\\\rceil\"||s===\"\\u2309\"?(d=\"\\u23A4\",g=y=\"\\u23A5\",k=\"Size4-Regular\",x=\"rceil\",w=667):s===\"(\"||s===\"\\\\lparen\"?(d=\"\\u239B\",g=\"\\u239C\",y=\"\\u239D\",k=\"Size4-Regular\",x=\"lparen\",w=875):s===\")\"||s===\"\\\\rparen\"?(d=\"\\u239E\",g=\"\\u239F\",y=\"\\u23A0\",k=\"Size4-Regular\",x=\"rparen\",w=875):s===\"\\\\{\"||s===\"\\\\lbrace\"?(d=\"\\u23A7\",o=\"\\u23A8\",y=\"\\u23A9\",g=\"\\u23AA\",k=\"Size4-Regular\"):s===\"\\\\}\"||s===\"\\\\rbrace\"?(d=\"\\u23AB\",o=\"\\u23AC\",y=\"\\u23AD\",g=\"\\u23AA\",k=\"Size4-Regular\"):s===\"\\\\lgroup\"||s===\"\\u27EE\"?(d=\"\\u23A7\",y=\"\\u23A9\",g=\"\\u23AA\",k=\"Size4-Regular\"):s===\"\\\\rgroup\"||s===\"\\u27EF\"?(d=\"\\u23AB\",y=\"\\u23AD\",g=\"\\u23AA\",k=\"Size4-Regular\"):s===\"\\\\lmoustache\"||s===\"\\u23B0\"?(d=\"\\u23A7\",y=\"\\u23AD\",g=\"\\u23AA\",k=\"Size4-Regular\"):(s===\"\\\\rmoustache\"||s===\"\\u23B1\")\u0026\u0026(d=\"\\u23AB\",y=\"\\u23A9\",g=\"\\u23AA\",k=\"Size4-Regular\");var z=va(d,k,i),S=z.height+z.depth,B=va(g,k,i),C=B.height+B.depth,E=va(y,k,i),q=E.height+E.depth,Z=0,j=1;if(o!==null){var U=va(o,k,i);Z=U.height+U.depth,j=2}var V=S+q+Z,W=Math.max(0,Math.ceil((t-V)/(j*C))),Y=V+W*j*C,ie=l.fontMetrics().axisHeight;n\u0026\u0026(ie*=l.sizeMultiplier);var ge=Y/2-ie,ee=[];if(x.length\u003e0){var ea=Y-S-q,be=Math.round(Y*1e3),he=rl(x,Math.round(ea*1e3)),We=new je(x,he),ia=(w/1e3).toFixed(3)+\"em\",ra=(be/1e3).toFixed(3)+\"em\",Ps=new Ce([We],{width:ia,height:ra,viewBox:\"0 0 \"+w+\" \"+be}),Xe=b.makeSvgSpan([],[Ps],l);Xe.height=be/1e3,Xe.style.width=ia,Xe.style.height=ra,ee.push({type:\"elem\",elem:Xe})}else{if(ee.push(fs(y,k,i)),ee.push(Pa),o===null){var Ye=Y-S-q+2*xs;ee.push(bs(g,Ye,l))}else{var xe=(Y-S-q-Z)/2+2*xs;ee.push(bs(g,xe,l)),ee.push(Pa),ee.push(fs(o,k,i)),ee.push(Pa),ee.push(bs(g,xe,l))}ee.push(Pa),ee.push(fs(d,k,i))}var ba=l.havingBaseStyle(I.TEXT),js=b.makeVList({positionType:\"bottom\",positionData:ge,children:ee},ba);return ys(b.makeSpan([\"delimsizing\",\"mult\"],[js],ba),I.TEXT,l,c)},ws=80,ks=.08,zs=function(s,t,n,l,i){var c=ll(s,l,n),d=new je(s,c),o=new Ce([d],{width:\"400em\",height:L(t),viewBox:\"0 0 400000 \"+n,preserveAspectRatio:\"xMinYMin slice\"});return b.makeSvgSpan([\"hide-tail\"],[o],i)},ni=function(s,t){var n=t.havingBaseSizing(),l=qt(\"\\\\surd\",s*n.sizeMultiplier,Et,n),i=n.sizeMultiplier,c=Math.max(0,t.minRuleThickness-t.fontMetrics().sqrtRuleThickness),d,o=0,g=0,y=0,x;return l.type===\"small\"?(y=1e3+1e3*c+ws,s\u003c1?i=1:s\u003c1.4\u0026\u0026(i=.7),o=(1+c+ks)/i,g=(1+c)/i,d=zs(\"sqrtMain\",o,y,c,t),d.style.minWidth=\"0.853em\",x=.833/i):l.type===\"large\"?(y=(1e3+ws)*ya[l.size],g=(ya[l.size]+c)/i,o=(ya[l.size]+c+ks)/i,d=zs(\"sqrtSize\"+l.size,o,y,c,t),d.style.minWidth=\"1.02em\",x=1/i):(o=s+c+ks,g=s+c,y=Math.floor(1e3*s+c)+ws,d=zs(\"sqrtTall\",o,y,c,t),d.style.minWidth=\"0.742em\",x=1.056),d.height=g,d.style.height=L(o),{span:d,advanceWidth:x,ruleWidth:(t.fontMetrics().sqrtRuleThickness+c)*i}},Dt=[\"(\",\"\\\\lparen\",\")\",\"\\\\rparen\",\"[\",\"\\\\lbrack\",\"]\",\"\\\\rbrack\",\"\\\\{\",\"\\\\lbrace\",\"\\\\}\",\"\\\\rbrace\",\"\\\\lfloor\",\"\\\\rfloor\",\"\\u230A\",\"\\u230B\",\"\\\\lceil\",\"\\\\rceil\",\"\\u2308\",\"\\u2309\",\"\\\\surd\"],li=[\"\\\\uparrow\",\"\\\\downarrow\",\"\\\\updownarrow\",\"\\\\Uparrow\",\"\\\\Downarrow\",\"\\\\Updownarrow\",\"|\",\"\\\\|\",\"\\\\vert\",\"\\\\Vert\",\"\\\\lvert\",\"\\\\rvert\",\"\\\\lVert\",\"\\\\rVert\",\"\\\\lgroup\",\"\\\\rgroup\",\"\\u27EE\",\"\\u27EF\",\"\\\\lmoustache\",\"\\\\rmoustache\",\"\\u23B0\",\"\\u23B1\"],Ct=[\"\u003c\",\"\u003e\",\"\\\\langle\",\"\\\\rangle\",\"/\",\"\\\\backslash\",\"\\\\lt\",\"\\\\gt\"],ya=[0,1.2,1.8,2.4,3],ii=function(s,t,n,l,i){if(s===\"\u003c\"||s===\"\\\\lt\"||s===\"\\u27E8\"?s=\"\\\\langle\":(s===\"\u003e\"||s===\"\\\\gt\"||s===\"\\u27E9\")\u0026\u0026(s=\"\\\\rangle\"),O.contains(Dt,s)||O.contains(Ct,s))return Bt(s,t,!1,n,l,i);if(O.contains(li,s))return Tt(s,ya[t],!1,n,l,i);throw new A(\"Illegal delimiter: '\"+s+\"'\")},ri=[{type:\"small\",style:I.SCRIPTSCRIPT},{type:\"small\",style:I.SCRIPT},{type:\"small\",style:I.TEXT},{type:\"large\",size:1},{type:\"large\",size:2},{type:\"large\",size:3},{type:\"large\",size:4}],mi=[{type:\"small\",style:I.SCRIPTSCRIPT},{type:\"small\",style:I.SCRIPT},{type:\"small\",style:I.TEXT},{type:\"stack\"}],Et=[{type:\"small\",style:I.SCRIPTSCRIPT},{type:\"small\",style:I.SCRIPT},{type:\"small\",style:I.TEXT},{type:\"large\",size:1},{type:\"large\",size:2},{type:\"large\",size:3},{type:\"large\",size:4},{type:\"stack\"}],ci=function(s){if(s.type===\"small\")return\"Main-Regular\";if(s.type===\"large\")return\"Size\"+s.size+\"-Regular\";if(s.type===\"stack\")return\"Size4-Regular\";throw new Error(\"Add support for delim type '\"+s.type+\"' here.\")},qt=function(s,t,n,l){for(var i=Math.min(2,3-l.style.size),c=i;c\u003cn.length\u0026\u0026n[c].type!==\"stack\";c++){var d=va(s,ci(n[c]),\"math\"),o=d.height+d.depth;if(n[c].type===\"small\"){var g=l.havingBaseStyle(n[c].style);o*=g.sizeMultiplier}if(o\u003et)return n[c]}return n[n.length-1]},It=function(s,t,n,l,i,c){s===\"\u003c\"||s===\"\\\\lt\"||s===\"\\u27E8\"?s=\"\\\\langle\":(s===\"\u003e\"||s===\"\\\\gt\"||s===\"\\u27E9\")\u0026\u0026(s=\"\\\\rangle\");var d;O.contains(Ct,s)?d=ri:O.contains(Dt,s)?d=Et:d=mi;var o=qt(s,t,d,l);return o.type===\"small\"?ei(s,o.style,n,l,i,c):o.type===\"large\"?Bt(s,o.size,n,l,i,c):Tt(s,t,n,l,i,c)},hi=function(s,t,n,l,i,c){var d=l.fontMetrics().axisHeight*l.sizeMultiplier,o=901,g=5/l.fontMetrics().ptPerEm,y=Math.max(t-d,n+d),x=Math.max(y/500*o,2*y-g);return It(s,x,!0,l,i,c)},Oe={sqrtImage:ni,sizedDelim:ii,sizeToMaxHeight:ya,customSizedDelim:It,leftRightDelim:hi},Ft={\"\\\\bigl\":{mclass:\"mopen\",size:1},\"\\\\Bigl\":{mclass:\"mopen\",size:2},\"\\\\biggl\":{mclass:\"mopen\",size:3},\"\\\\Biggl\":{mclass:\"mopen\",size:4},\"\\\\bigr\":{mclass:\"mclose\",size:1},\"\\\\Bigr\":{mclass:\"mclose\",size:2},\"\\\\biggr\":{mclass:\"mclose\",size:3},\"\\\\Biggr\":{mclass:\"mclose\",size:4},\"\\\\bigm\":{mclass:\"mrel\",size:1},\"\\\\Bigm\":{mclass:\"mrel\",size:2},\"\\\\biggm\":{mclass:\"mrel\",size:3},\"\\\\Biggm\":{mclass:\"mrel\",size:4},\"\\\\big\":{mclass:\"mord\",size:1},\"\\\\Big\":{mclass:\"mord\",size:2},\"\\\\bigg\":{mclass:\"mord\",size:3},\"\\\\Bigg\":{mclass:\"mord\",size:4}},di=[\"(\",\"\\\\lparen\",\")\",\"\\\\rparen\",\"[\",\"\\\\lbrack\",\"]\",\"\\\\rbrack\",\"\\\\{\",\"\\\\lbrace\",\"\\\\}\",\"\\\\rbrace\",\"\\\\lfloor\",\"\\\\rfloor\",\"\\u230A\",\"\\u230B\",\"\\\\lceil\",\"\\\\rceil\",\"\\u2308\",\"\\u2309\",\"\u003c\",\"\u003e\",\"\\\\langle\",\"\\u27E8\",\"\\\\rangle\",\"\\u27E9\",\"\\\\lt\",\"\\\\gt\",\"\\\\lvert\",\"\\\\rvert\",\"\\\\lVert\",\"\\\\rVert\",\"\\\\lgroup\",\"\\\\rgroup\",\"\\u27EE\",\"\\u27EF\",\"\\\\lmoustache\",\"\\\\rmoustache\",\"\\u23B0\",\"\\u23B1\",\"/\",\"\\\\backslash\",\"|\",\"\\\\vert\",\"\\\\|\",\"\\\\Vert\",\"\\\\uparrow\",\"\\\\Uparrow\",\"\\\\downarrow\",\"\\\\Downarrow\",\"\\\\updownarrow\",\"\\\\Updownarrow\",\".\"];function ja(m,s){var t=Fa(m);if(t\u0026\u0026O.contains(di,t.text))return t;throw t?new A(\"Invalid delimiter '\"+t.text+\"' after '\"+s.funcName+\"'\",m):new A(\"Invalid delimiter type '\"+m.type+\"'\",m)}T({type:\"delimsizing\",names:[\"\\\\bigl\",\"\\\\Bigl\",\"\\\\biggl\",\"\\\\Biggl\",\"\\\\bigr\",\"\\\\Bigr\",\"\\\\biggr\",\"\\\\Biggr\",\"\\\\bigm\",\"\\\\Bigm\",\"\\\\biggm\",\"\\\\Biggm\",\"\\\\big\",\"\\\\Big\",\"\\\\bigg\",\"\\\\Bigg\"],props:{numArgs:1,argTypes:[\"primitive\"]},handler:function(s,t){var n=ja(t[0],s);return{type:\"delimsizing\",mode:s.parser.mode,size:Ft[s.funcName].size,mclass:Ft[s.funcName].mclass,delim:n.text}},htmlBuilder:function(s,t){return s.delim===\".\"?b.makeSpan([s.mclass]):Oe.sizedDelim(s.delim,s.size,t,s.mode,[s.mclass])},mathmlBuilder:function(s){var t=[];s.delim!==\".\"\u0026\u0026t.push(fe(s.delim,s.mode));var n=new R.MathNode(\"mo\",t);s.mclass===\"mopen\"||s.mclass===\"mclose\"?n.setAttribute(\"fence\",\"true\"):n.setAttribute(\"fence\",\"false\"),n.setAttribute(\"stretchy\",\"true\");var l=L(Oe.sizeToMaxHeight[s.size]);return n.setAttribute(\"minsize\",l),n.setAttribute(\"maxsize\",l),n}});function Ot(m){if(!m.body)throw new Error(\"Bug: The leftright ParseNode wasn't fully parsed.\")}T({type:\"leftright-right\",names:[\"\\\\right\"],props:{numArgs:1,primitive:!0},handler:function(s,t){var n=s.parser.gullet.macros.get(\"\\\\current@color\");if(n\u0026\u0026typeof n!=\"string\")throw new A(\"\\\\current@color set to non-string in \\\\right\");return{type:\"leftright-right\",mode:s.parser.mode,delim:ja(t[0],s).text,color:n}}}),T({type:\"leftright\",names:[\"\\\\left\"],props:{numArgs:1,primitive:!0},handler:function(s,t){var n=ja(t[0],s),l=s.parser;++l.leftrightDepth;var i=l.parseExpression(!1);--l.leftrightDepth,l.expect(\"\\\\right\",!1);var c=P(l.parseFunction(),\"leftright-right\");return{type:\"leftright\",mode:l.mode,body:i,left:n.text,right:c.delim,rightColor:c.color}},htmlBuilder:function(s,t){Ot(s);for(var n=le(s.body,t,!0,[\"mopen\",\"mclose\"]),l=0,i=0,c=!1,d=0;d\u003cn.length;d++)n[d].isMiddle?c=!0:(l=Math.max(n[d].height,l),i=Math.max(n[d].depth,i));l*=t.sizeMultiplier,i*=t.sizeMultiplier;var o;if(s.left===\".\"?o=ga(t,[\"mopen\"]):o=Oe.leftRightDelim(s.left,l,i,t,s.mode,[\"mopen\"]),n.unshift(o),c)for(var g=1;g\u003cn.length;g++){var y=n[g],x=y.isMiddle;x\u0026\u0026(n[g]=Oe.leftRightDelim(x.delim,l,i,x.options,s.mode,[]))}var w;if(s.right===\".\")w=ga(t,[\"mclose\"]);else{var k=s.rightColor?t.withColor(s.rightColor):t;w=Oe.leftRightDelim(s.right,l,i,k,s.mode,[\"mclose\"])}return n.push(w),b.makeSpan([\"minner\"],n,t)},mathmlBuilder:function(s,t){Ot(s);var n=oe(s.body,t);if(s.left!==\".\"){var l=new R.MathNode(\"mo\",[fe(s.left,s.mode)]);l.setAttribute(\"fence\",\"true\"),n.unshift(l)}if(s.right!==\".\"){var i=new R.MathNode(\"mo\",[fe(s.right,s.mode)]);i.setAttribute(\"fence\",\"true\"),s.rightColor\u0026\u0026i.setAttribute(\"mathcolor\",s.rightColor),n.push(i)}return os(n)}}),T({type:\"middle\",names:[\"\\\\middle\"],props:{numArgs:1,primitive:!0},handler:function(s,t){var n=ja(t[0],s);if(!s.parser.leftrightDepth)throw new A(\"\\\\middle without preceding \\\\left\",n);return{type:\"middle\",mode:s.parser.mode,delim:n.text}},htmlBuilder:function(s,t){var n;if(s.delim===\".\")n=ga(t,[]);else{n=Oe.sizedDelim(s.delim,1,t,s.mode,[]);var l={delim:s.delim,options:t};n.isMiddle=l}return n},mathmlBuilder:function(s,t){var n=s.delim===\"\\\\vert\"||s.delim===\"|\"?fe(\"|\",\"text\"):fe(s.delim,s.mode),l=new R.MathNode(\"mo\",[n]);return l.setAttribute(\"fence\",\"true\"),l.setAttribute(\"lspace\",\"0.05em\"),l.setAttribute(\"rspace\",\"0.05em\"),l}});var Ms=function(s,t){var n=b.wrapFragment(_(s.body,t),t),l=s.label.slice(1),i=t.sizeMultiplier,c,d=0,o=O.isCharacterBox(s.body);if(l===\"sout\")c=b.makeSpan([\"stretchy\",\"sout\"]),c.height=t.fontMetrics().defaultRuleThickness/i,d=-.5*t.fontMetrics().xHeight;else if(l===\"phase\"){var g=J({number:.6,unit:\"pt\"},t),y=J({number:.35,unit:\"ex\"},t),x=t.havingBaseSizing();i=i/x.sizeMultiplier;var w=n.height+n.depth+g+y;n.style.paddingLeft=L(w/2+g);var k=Math.floor(1e3*w*i),z=tl(k),S=new Ce([new je(\"phase\",z)],{width:\"400em\",height:L(k/1e3),viewBox:\"0 0 400000 \"+k,preserveAspectRatio:\"xMinYMin slice\"});c=b.makeSvgSpan([\"hide-tail\"],[S],t),c.style.height=L(w),d=n.depth+g+y}else{/cancel/.test(l)?o||n.classes.push(\"cancel-pad\"):l===\"angl\"?n.classes.push(\"anglpad\"):n.classes.push(\"boxpad\");var B=0,C=0,E=0;/box/.test(l)?(E=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness),B=t.fontMetrics().fboxsep+(l===\"colorbox\"?0:E),C=B):l===\"angl\"?(E=Math.max(t.fontMetrics().defaultRuleThickness,t.minRuleThickness),B=4*E,C=Math.max(0,.25-n.depth)):(B=o?.2:0,C=B),c=Fe.encloseSpan(n,l,B,C,t),/fbox|boxed|fcolorbox/.test(l)?(c.style.borderStyle=\"solid\",c.style.borderWidth=L(E)):l===\"angl\"\u0026\u0026E!==.049\u0026\u0026(c.style.borderTopWidth=L(E),c.style.borderRightWidth=L(E)),d=n.depth+C,s.backgroundColor\u0026\u0026(c.style.backgroundColor=s.backgroundColor,s.borderColor\u0026\u0026(c.style.borderColor=s.borderColor))}var q;if(s.backgroundColor)q=b.makeVList({positionType:\"individualShift\",children:[{type:\"elem\",elem:c,shift:d},{type:\"elem\",elem:n,shift:0}]},t);else{var Z=/cancel|phase/.test(l)?[\"svg-align\"]:[];q=b.makeVList({positionType:\"individualShift\",children:[{type:\"elem\",elem:n,shift:0},{type:\"elem\",elem:c,shift:d,wrapperClasses:Z}]},t)}return/cancel/.test(l)\u0026\u0026(q.height=n.height,q.depth=n.depth),/cancel/.test(l)\u0026\u0026!o?b.makeSpan([\"mord\",\"cancel-lap\"],[q],t):b.makeSpan([\"mord\"],[q],t)},Rs=function(s,t){var n=0,l=new R.MathNode(s.label.indexOf(\"colorbox\")\u003e-1?\"mpadded\":\"menclose\",[X(s.body,t)]);switch(s.label){case\"\\\\cancel\":l.setAttribute(\"notation\",\"updiagonalstrike\");break;case\"\\\\bcancel\":l.setAttribute(\"notation\",\"downdiagonalstrike\");break;case\"\\\\phase\":l.setAttribute(\"notation\",\"phasorangle\");break;case\"\\\\sout\":l.setAttribute(\"notation\",\"horizontalstrike\");break;case\"\\\\fbox\":l.setAttribute(\"notation\",\"box\");break;case\"\\\\angl\":l.setAttribute(\"notation\",\"actuarial\");break;case\"\\\\fcolorbox\":case\"\\\\colorbox\":if(n=t.fontMetrics().fboxsep*t.fontMetrics().ptPerEm,l.setAttribute(\"width\",\"+\"+2*n+\"pt\"),l.setAttribute(\"height\",\"+\"+2*n+\"pt\"),l.setAttribute(\"lspace\",n+\"pt\"),l.setAttribute(\"voffset\",n+\"pt\"),s.label===\"\\\\fcolorbox\"){var i=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness);l.setAttribute(\"style\",\"border: \"+i+\"em solid \"+String(s.borderColor))}break;case\"\\\\xcancel\":l.setAttribute(\"notation\",\"updiagonalstrike downdiagonalstrike\");break}return s.backgroundColor\u0026\u0026l.setAttribute(\"mathbackground\",s.backgroundColor),l};T({type:\"enclose\",names:[\"\\\\colorbox\"],props:{numArgs:2,allowedInText:!0,argTypes:[\"color\",\"text\"]},handler:function(s,t,n){var l=s.parser,i=s.funcName,c=P(t[0],\"color-token\").color,d=t[1];return{type:\"enclose\",mode:l.mode,label:i,backgroundColor:c,body:d}},htmlBuilder:Ms,mathmlBuilder:Rs}),T({type:\"enclose\",names:[\"\\\\fcolorbox\"],props:{numArgs:3,allowedInText:!0,argTypes:[\"color\",\"color\",\"text\"]},handler:function(s,t,n){var l=s.parser,i=s.funcName,c=P(t[0],\"color-token\").color,d=P(t[1],\"color-token\").color,o=t[2];return{type:\"enclose\",mode:l.mode,label:i,backgroundColor:d,borderColor:c,body:o}},htmlBuilder:Ms,mathmlBuilder:Rs}),T({type:\"enclose\",names:[\"\\\\fbox\"],props:{numArgs:1,argTypes:[\"hbox\"],allowedInText:!0},handler:function(s,t){var n=s.parser;return{type:\"enclose\",mode:n.mode,label:\"\\\\fbox\",body:t[0]}}}),T({type:\"enclose\",names:[\"\\\\cancel\",\"\\\\bcancel\",\"\\\\xcancel\",\"\\\\sout\",\"\\\\phase\"],props:{numArgs:1},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0];return{type:\"enclose\",mode:n.mode,label:l,body:i}},htmlBuilder:Ms,mathmlBuilder:Rs}),T({type:\"enclose\",names:[\"\\\\angl\"],props:{numArgs:1,argTypes:[\"hbox\"],allowedInText:!1},handler:function(s,t){var n=s.parser;return{type:\"enclose\",mode:n.mode,label:\"\\\\angl\",body:t[0]}}});var Ht={};function Se(m){for(var s=m.type,t=m.names,n=m.props,l=m.handler,i=m.htmlBuilder,c=m.mathmlBuilder,d={type:s,numArgs:n.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:l},o=0;o\u003ct.length;++o)Ht[t[o]]=d;i\u0026\u0026(Ca[s]=i),c\u0026\u0026(Ea[s]=c)}var Pt={};function u(m,s){Pt[m]=s}var ke=function(){function m(s,t,n){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=s,this.start=t,this.end=n}return m.range=function(t,n){return n?!t||!t.loc||!n.loc||t.loc.lexer!==n.loc.lexer?null:new m(t.loc.lexer,t.loc.start,n.loc.end):t\u0026\u0026t.loc},m}(),Ve=function(){function m(t,n){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=t,this.loc=n}var s=m.prototype;return s.range=function(n,l){return new m(l,ke.range(this,n))},m}();function jt(m){var s=[];m.consumeSpaces();var t=m.fetch().text;for(t===\"\\\\relax\"\u0026\u0026(m.consume(),m.consumeSpaces(),t=m.fetch().text);t===\"\\\\hline\"||t===\"\\\\hdashline\";)m.consume(),s.push(t===\"\\\\hdashline\"),m.consumeSpaces(),t=m.fetch().text;return s}var Ga=function(s){var t=s.parser.settings;if(!t.displayMode)throw new A(\"{\"+s.envName+\"} can be used only in display mode.\")};function As(m){if(m.indexOf(\"ed\")===-1)return m.indexOf(\"*\")===-1}function Ze(m,s,t){var n=s.hskipBeforeAndAfter,l=s.addJot,i=s.cols,c=s.arraystretch,d=s.colSeparationType,o=s.autoTag,g=s.singleRow,y=s.emptySingleRow,x=s.maxNumCols,w=s.leqno;if(m.gullet.beginGroup(),g||m.gullet.macros.set(\"\\\\cr\",\"\\\\\\\\\\\\relax\"),!c){var k=m.gullet.expandMacroAsText(\"\\\\arraystretch\");if(k==null)c=1;else if(c=parseFloat(k),!c||c\u003c0)throw new A(\"Invalid \\\\arraystretch: \"+k)}m.gullet.beginGroup();var z=[],S=[z],B=[],C=[],E=o!=null?[]:void 0;function q(){o\u0026\u0026m.gullet.macros.set(\"\\\\@eqnsw\",\"1\",!0)}function Z(){E\u0026\u0026(m.gullet.macros.get(\"\\\\df@tag\")?(E.push(m.subparse([new Ve(\"\\\\df@tag\")])),m.gullet.macros.set(\"\\\\df@tag\",void 0,!0)):E.push(Boolean(o)\u0026\u0026m.gullet.macros.get(\"\\\\@eqnsw\")===\"1\"))}for(q(),C.push(jt(m));;){var j=m.parseExpression(!1,g?\"\\\\end\":\"\\\\\\\\\");m.gullet.endGroup(),m.gullet.beginGroup(),j={type:\"ordgroup\",mode:m.mode,body:j},t\u0026\u0026(j={type:\"styling\",mode:m.mode,style:t,body:[j]}),z.push(j);var U=m.fetch().text;if(U===\"\u0026\"){if(x\u0026\u0026z.length===x){if(g||d)throw new A(\"Too many tab characters: \u0026\",m.nextToken);m.settings.reportNonstrict(\"textEnv\",\"Too few columns specified in the {array} column argument.\")}m.consume()}else if(U===\"\\\\end\"){Z(),z.length===1\u0026\u0026j.type===\"styling\"\u0026\u0026j.body[0].body.length===0\u0026\u0026(S.length\u003e1||!y)\u0026\u0026S.pop(),C.length\u003cS.length+1\u0026\u0026C.push([]);break}else if(U===\"\\\\\\\\\"){m.consume();var V=void 0;m.gullet.future().text!==\" \"\u0026\u0026(V=m.parseSizeGroup(!0)),B.push(V?V.value:null),Z(),C.push(jt(m)),z=[],S.push(z),q()}else throw new A(\"Expected \u0026 or \\\\\\\\ or \\\\cr or \\\\end\",m.nextToken)}return m.gullet.endGroup(),m.gullet.endGroup(),{type:\"array\",mode:m.mode,addJot:l,arraystretch:c,body:S,cols:i,rowGaps:B,hskipBeforeAndAfter:n,hLinesBeforeRow:C,colSeparationType:d,tags:E,leqno:w}}function Ss(m){return m.slice(0,1)===\"d\"?\"display\":\"text\"}var Le=function(s,t){var n,l,i=s.body.length,c=s.hLinesBeforeRow,d=0,o=new Array(i),g=[],y=Math.max(t.fontMetrics().arrayRuleWidth,t.minRuleThickness),x=1/t.fontMetrics().ptPerEm,w=5*x;if(s.colSeparationType\u0026\u0026s.colSeparationType===\"small\"){var k=t.havingStyle(I.SCRIPT).sizeMultiplier;w=.2778*(k/t.sizeMultiplier)}var z=s.colSeparationType===\"CD\"?J({number:3,unit:\"ex\"},t):12*x,S=3*x,B=s.arraystretch*z,C=.7*B,E=.3*B,q=0;function Z(Ua){for(var Wa=0;Wa\u003cUa.length;++Wa)Wa\u003e0\u0026\u0026(q+=.25),g.push({pos:q,isDashed:Ua[Wa]})}for(Z(c[0]),n=0;n\u003cs.body.length;++n){var j=s.body[n],U=C,V=E;d\u003cj.length\u0026\u0026(d=j.length);var W=new Array(j.length);for(l=0;l\u003cj.length;++l){var Y=_(j[l],t);V\u003cY.depth\u0026\u0026(V=Y.depth),U\u003cY.height\u0026\u0026(U=Y.height),W[l]=Y}var ie=s.rowGaps[n],ge=0;ie\u0026\u0026(ge=J(ie,t),ge\u003e0\u0026\u0026(ge+=E,V\u003cge\u0026\u0026(V=ge),ge=0)),s.addJot\u0026\u0026(V+=S),W.height=U,W.depth=V,q+=U,W.pos=q,q+=V+ge,o[n]=W,Z(c[n+1])}var ee=q/2+t.fontMetrics().axisHeight,ea=s.cols||[],be=[],he,We,ia=[];if(s.tags\u0026\u0026s.tags.some(function(Ua){return Ua}))for(n=0;n\u003ci;++n){var ra=o[n],Ps=ra.pos-ee,Xe=s.tags[n],Ye=void 0;Xe===!0?Ye=b.makeSpan([\"eqn-num\"],[],t):Xe===!1?Ye=b.makeSpan([],[],t):Ye=b.makeSpan([],le(Xe,t,!0),t),Ye.depth=ra.depth,Ye.height=ra.height,ia.push({type:\"elem\",elem:Ye,shift:Ps})}for(l=0,We=0;l\u003cd||We\u003cea.length;++l,++We){for(var xe=ea[We]||{},ba=!0;xe.type===\"separator\";){if(ba||(he=b.makeSpan([\"arraycolsep\"],[]),he.style.width=L(t.fontMetrics().doubleRuleSep),be.push(he)),xe.separator===\"|\"||xe.separator===\":\"){var js=xe.separator===\"|\"?\"solid\":\"dashed\",ma=b.makeSpan([\"vertical-separator\"],[],t);ma.style.height=L(q),ma.style.borderRightWidth=L(y),ma.style.borderRightStyle=js,ma.style.margin=\"0 \"+L(-y/2);var kn=q-ee;kn\u0026\u0026(ma.style.verticalAlign=L(-kn)),be.push(ma)}else throw new A(\"Invalid separator type: \"+xe.separator);We++,xe=ea[We]||{},ba=!1}if(!(l\u003e=d)){var ca=void 0;(l\u003e0||s.hskipBeforeAndAfter)\u0026\u0026(ca=O.deflt(xe.pregap,w),ca!==0\u0026\u0026(he=b.makeSpan([\"arraycolsep\"],[]),he.style.width=L(ca),be.push(he)));var ha=[];for(n=0;n\u003ci;++n){var Va=o[n],Za=Va[l];if(!!Za){var Oi=Va.pos-ee;Za.depth=Va.depth,Za.height=Va.height,ha.push({type:\"elem\",elem:Za,shift:Oi})}}ha=b.makeVList({positionType:\"individualShift\",children:ha},t),ha=b.makeSpan([\"col-align-\"+(xe.align||\"c\")],[ha]),be.push(ha),(l\u003cd-1||s.hskipBeforeAndAfter)\u0026\u0026(ca=O.deflt(xe.postgap,w),ca!==0\u0026\u0026(he=b.makeSpan([\"arraycolsep\"],[]),he.style.width=L(ca),be.push(he)))}}if(o=b.makeSpan([\"mtable\"],be),g.length\u003e0){for(var Hi=b.makeLineSpan(\"hline\",t,y),Pi=b.makeLineSpan(\"hdashline\",t,y),Gs=[{type:\"elem\",elem:o,shift:0}];g.length\u003e0;){var zn=g.pop(),Mn=zn.pos-ee;zn.isDashed?Gs.push({type:\"elem\",elem:Pi,shift:Mn}):Gs.push({type:\"elem\",elem:Hi,shift:Mn})}o=b.makeVList({positionType:\"individualShift\",children:Gs},t)}if(ia.length===0)return b.makeSpan([\"mord\"],[o],t);var _s=b.makeVList({positionType:\"individualShift\",children:ia},t);return _s=b.makeSpan([\"tag\"],[_s],t),b.makeFragment([o,_s])},pi={c:\"center \",l:\"left \",r:\"right \"},Be=function(s,t){for(var n=[],l=new R.MathNode(\"mtd\",[],[\"mtr-glue\"]),i=new R.MathNode(\"mtd\",[],[\"mml-eqn-num\"]),c=0;c\u003cs.body.length;c++){for(var d=s.body[c],o=[],g=0;g\u003cd.length;g++)o.push(new R.MathNode(\"mtd\",[X(d[g],t)]));s.tags\u0026\u0026s.tags[c]\u0026\u0026(o.unshift(l),o.push(l),s.leqno?o.unshift(i):o.push(i)),n.push(new R.MathNode(\"mtr\",o))}var y=new R.MathNode(\"mtable\",n),x=s.arraystretch===.5?.1:.16+s.arraystretch-1+(s.addJot?.09:0);y.setAttribute(\"rowspacing\",L(x));var w=\"\",k=\"\";if(s.cols\u0026\u0026s.cols.length\u003e0){var z=s.cols,S=\"\",B=!1,C=0,E=z.length;z[0].type===\"separator\"\u0026\u0026(w+=\"top \",C=1),z[z.length-1].type===\"separator\"\u0026\u0026(w+=\"bottom \",E-=1);for(var q=C;q\u003cE;q++)z[q].type===\"align\"?(k+=pi[z[q].align],B\u0026\u0026(S+=\"none \"),B=!0):z[q].type===\"separator\"\u0026\u0026B\u0026\u0026(S+=z[q].separator===\"|\"?\"solid \":\"dashed \",B=!1);y.setAttribute(\"columnalign\",k.trim()),/[sd]/.test(S)\u0026\u0026y.setAttribute(\"columnlines\",S.trim())}if(s.colSeparationType===\"align\"){for(var Z=s.cols||[],j=\"\",U=1;U\u003cZ.length;U++)j+=U%2?\"0em \":\"1em \";y.setAttribute(\"columnspacing\",j.trim())}else s.colSeparationType===\"alignat\"||s.colSeparationType===\"gather\"?y.setAttribute(\"columnspacing\",\"0em\"):s.colSeparationType===\"small\"?y.setAttribute(\"columnspacing\",\"0.2778em\"):s.colSeparationType===\"CD\"?y.setAttribute(\"columnspacing\",\"0.5em\"):y.setAttribute(\"columnspacing\",\"1em\");var V=\"\",W=s.hLinesBeforeRow;w+=W[0].length\u003e0?\"left \":\"\",w+=W[W.length-1].length\u003e0?\"right \":\"\";for(var Y=1;Y\u003cW.length-1;Y++)V+=W[Y].length===0?\"none \":W[Y][0]?\"dashed \":\"solid \";return/[sd]/.test(V)\u0026\u0026y.setAttribute(\"rowlines\",V.trim()),w!==\"\"\u0026\u0026(y=new R.MathNode(\"menclose\",[y]),y.setAttribute(\"notation\",w.trim())),s.arraystretch\u0026\u0026s.arraystretch\u003c1\u0026\u0026(y=new R.MathNode(\"mstyle\",[y]),y.setAttribute(\"scriptlevel\",\"1\")),y},Gt=function(s,t){s.envName.indexOf(\"ed\")===-1\u0026\u0026Ga(s);var n=[],l=s.envName.indexOf(\"at\")\u003e-1?\"alignat\":\"align\",i=s.envName===\"split\",c=Ze(s.parser,{cols:n,addJot:!0,autoTag:i?void 0:As(s.envName),emptySingleRow:!0,colSeparationType:l,maxNumCols:i?2:void 0,leqno:s.parser.settings.leqno},\"display\"),d,o=0,g={type:\"ordgroup\",mode:s.mode,body:[]};if(t[0]\u0026\u0026t[0].type===\"ordgroup\"){for(var y=\"\",x=0;x\u003ct[0].body.length;x++){var w=P(t[0].body[x],\"textord\");y+=w.text}d=Number(y),o=d*2}var k=!o;c.body.forEach(function(C){for(var E=1;E\u003cC.length;E+=2){var q=P(C[E],\"styling\"),Z=P(q.body[0],\"ordgroup\");Z.body.unshift(g)}if(k)o\u003cC.length\u0026\u0026(o=C.length);else{var j=C.length/2;if(d\u003cj)throw new A(\"Too many math in a row: \"+(\"expected \"+d+\", but got \"+j),C[0])}});for(var z=0;z\u003co;++z){var S=\"r\",B=0;z%2===1?S=\"l\":z\u003e0\u0026\u0026k\u0026\u0026(B=1),n[z]={type:\"align\",align:S,pregap:B,postgap:0}}return c.colSeparationType=k?\"align\":\"alignat\",c};Se({type:\"array\",names:[\"array\",\"darray\"],props:{numArgs:1},handler:function(s,t){var n=Fa(t[0]),l=n?[t[0]]:P(t[0],\"ordgroup\").body,i=l.map(function(d){var o=gs(d),g=o.text;if(\"lcr\".indexOf(g)!==-1)return{type:\"align\",align:g};if(g===\"|\")return{type:\"separator\",separator:\"|\"};if(g===\":\")return{type:\"separator\",separator:\":\"};throw new A(\"Unknown column alignment: \"+g,d)}),c={cols:i,hskipBeforeAndAfter:!0,maxNumCols:i.length};return Ze(s.parser,c,Ss(s.envName))},htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"matrix\",\"pmatrix\",\"bmatrix\",\"Bmatrix\",\"vmatrix\",\"Vmatrix\",\"matrix*\",\"pmatrix*\",\"bmatrix*\",\"Bmatrix*\",\"vmatrix*\",\"Vmatrix*\"],props:{numArgs:0},handler:function(s){var t={matrix:null,pmatrix:[\"(\",\")\"],bmatrix:[\"[\",\"]\"],Bmatrix:[\"\\\\{\",\"\\\\}\"],vmatrix:[\"|\",\"|\"],Vmatrix:[\"\\\\Vert\",\"\\\\Vert\"]}[s.envName.replace(\"*\",\"\")],n=\"c\",l={hskipBeforeAndAfter:!1,cols:[{type:\"align\",align:n}]};if(s.envName.charAt(s.envName.length-1)===\"*\"){var i=s.parser;if(i.consumeSpaces(),i.fetch().text===\"[\"){if(i.consume(),i.consumeSpaces(),n=i.fetch().text,\"lcr\".indexOf(n)===-1)throw new A(\"Expected l or c or r\",i.nextToken);i.consume(),i.consumeSpaces(),i.expect(\"]\"),i.consume(),l.cols=[{type:\"align\",align:n}]}}var c=Ze(s.parser,l,Ss(s.envName)),d=Math.max.apply(Math,[0].concat(c.body.map(function(o){return o.length})));return c.cols=new Array(d).fill({type:\"align\",align:n}),t?{type:\"leftright\",mode:s.mode,body:[c],left:t[0],right:t[1],rightColor:void 0}:c},htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"smallmatrix\"],props:{numArgs:0},handler:function(s){var t={arraystretch:.5},n=Ze(s.parser,t,\"script\");return n.colSeparationType=\"small\",n},htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"subarray\"],props:{numArgs:1},handler:function(s,t){var n=Fa(t[0]),l=n?[t[0]]:P(t[0],\"ordgroup\").body,i=l.map(function(d){var o=gs(d),g=o.text;if(\"lc\".indexOf(g)!==-1)return{type:\"align\",align:g};throw new A(\"Unknown column alignment: \"+g,d)});if(i.length\u003e1)throw new A(\"{subarray} can contain only one column\");var c={cols:i,hskipBeforeAndAfter:!1,arraystretch:.5};if(c=Ze(s.parser,c,\"script\"),c.body.length\u003e0\u0026\u0026c.body[0].length\u003e1)throw new A(\"{subarray} can contain only one column\");return c},htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"cases\",\"dcases\",\"rcases\",\"drcases\"],props:{numArgs:0},handler:function(s){var t={arraystretch:1.2,cols:[{type:\"align\",align:\"l\",pregap:0,postgap:1},{type:\"align\",align:\"l\",pregap:0,postgap:0}]},n=Ze(s.parser,t,Ss(s.envName));return{type:\"leftright\",mode:s.mode,body:[n],left:s.envName.indexOf(\"r\")\u003e-1?\".\":\"\\\\{\",right:s.envName.indexOf(\"r\")\u003e-1?\"\\\\}\":\".\",rightColor:void 0}},htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"align\",\"align*\",\"aligned\",\"split\"],props:{numArgs:0},handler:Gt,htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"gathered\",\"gather\",\"gather*\"],props:{numArgs:0},handler:function(s){O.contains([\"gather\",\"gather*\"],s.envName)\u0026\u0026Ga(s);var t={cols:[{type:\"align\",align:\"c\"}],addJot:!0,colSeparationType:\"gather\",autoTag:As(s.envName),emptySingleRow:!0,leqno:s.parser.settings.leqno};return Ze(s.parser,t,\"display\")},htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"alignat\",\"alignat*\",\"alignedat\"],props:{numArgs:1},handler:Gt,htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"equation\",\"equation*\"],props:{numArgs:0},handler:function(s){Ga(s);var t={autoTag:As(s.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:s.parser.settings.leqno};return Ze(s.parser,t,\"display\")},htmlBuilder:Le,mathmlBuilder:Be}),Se({type:\"array\",names:[\"CD\"],props:{numArgs:0},handler:function(s){return Ga(s),Kl(s.parser)},htmlBuilder:Le,mathmlBuilder:Be}),u(\"\\\\nonumber\",\"\\\\gdef\\\\@eqnsw{0}\"),u(\"\\\\notag\",\"\\\\nonumber\"),T({type:\"text\",names:[\"\\\\hline\",\"\\\\hdashline\"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler:function(s,t){throw new A(s.funcName+\" valid only within array environment\")}});var oi=Ht,_t=oi;T({type:\"environment\",names:[\"\\\\begin\",\"\\\\end\"],props:{numArgs:1,argTypes:[\"text\"]},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0];if(i.type!==\"ordgroup\")throw new A(\"Invalid environment name\",i);for(var c=\"\",d=0;d\u003ci.body.length;++d)c+=P(i.body[d],\"textord\").text;if(l===\"\\\\begin\"){if(!_t.hasOwnProperty(c))throw new A(\"No such environment: \"+c,i);var o=_t[c],g=n.parseArguments(\"\\\\begin{\"+c+\"}\",o),y=g.args,x=g.optArgs,w={mode:n.mode,envName:c,parser:n},k=o.handler(w,y,x);n.expect(\"\\\\end\",!1);var z=n.nextToken,S=P(n.parseFunction(),\"environment\");if(S.name!==c)throw new A(\"Mismatch: \\\\begin{\"+c+\"} matched by \\\\end{\"+S.name+\"}\",z);return k}return{type:\"environment\",mode:n.mode,name:c,nameGroup:i}}});var Vt=function(s,t){var n=s.font,l=t.withFont(n);return _(s.body,l)},Zt=function(s,t){var n=s.font,l=t.withFont(n);return X(s.body,l)},Ut={\"\\\\Bbb\":\"\\\\mathbb\",\"\\\\bold\":\"\\\\mathbf\",\"\\\\frak\":\"\\\\mathfrak\",\"\\\\bm\":\"\\\\boldsymbol\"};T({type:\"font\",names:[\"\\\\mathrm\",\"\\\\mathit\",\"\\\\mathbf\",\"\\\\mathnormal\",\"\\\\mathbb\",\"\\\\mathcal\",\"\\\\mathfrak\",\"\\\\mathscr\",\"\\\\mathsf\",\"\\\\mathtt\",\"\\\\Bbb\",\"\\\\bold\",\"\\\\frak\"],props:{numArgs:1,allowedInArgument:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=qa(t[0]),c=l;return c in Ut\u0026\u0026(c=Ut[c]),{type:\"font\",mode:n.mode,font:c.slice(1),body:i}},htmlBuilder:Vt,mathmlBuilder:Zt}),T({type:\"mclass\",names:[\"\\\\boldsymbol\",\"\\\\bm\"],props:{numArgs:1},handler:function(s,t){var n=s.parser,l=t[0],i=O.isCharacterBox(l);return{type:\"mclass\",mode:n.mode,mclass:Ha(l),body:[{type:\"font\",mode:n.mode,font:\"boldsymbol\",body:l}],isCharacterBox:i}}}),T({type:\"font\",names:[\"\\\\rm\",\"\\\\sf\",\"\\\\tt\",\"\\\\bf\",\"\\\\it\",\"\\\\cal\"],props:{numArgs:0,allowedInText:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=s.breakOnTokenText,c=n.mode,d=n.parseExpression(!0,i),o=\"math\"+l.slice(1);return{type:\"font\",mode:c,font:o,body:{type:\"ordgroup\",mode:n.mode,body:d}}},htmlBuilder:Vt,mathmlBuilder:Zt});var Wt=function(s,t){var n=t;return s===\"display\"?n=n.id\u003e=I.SCRIPT.id?n.text():I.DISPLAY:s===\"text\"\u0026\u0026n.size===I.DISPLAY.size?n=I.TEXT:s===\"script\"?n=I.SCRIPT:s===\"scriptscript\"\u0026\u0026(n=I.SCRIPTSCRIPT),n},Ls=function(s,t){var n=Wt(s.size,t.style),l=n.fracNum(),i=n.fracDen(),c;c=t.havingStyle(l);var d=_(s.numer,c,t);if(s.continued){var o=8.5/t.fontMetrics().ptPerEm,g=3.5/t.fontMetrics().ptPerEm;d.height=d.height\u003co?o:d.height,d.depth=d.depth\u003cg?g:d.depth}c=t.havingStyle(i);var y=_(s.denom,c,t),x,w,k;s.hasBarLine?(s.barSize?(w=J(s.barSize,t),x=b.makeLineSpan(\"frac-line\",t,w)):x=b.makeLineSpan(\"frac-line\",t),w=x.height,k=x.height):(x=null,w=0,k=t.fontMetrics().defaultRuleThickness);var z,S,B;n.size===I.DISPLAY.size||s.size===\"display\"?(z=t.fontMetrics().num1,w\u003e0?S=3*k:S=7*k,B=t.fontMetrics().denom1):(w\u003e0?(z=t.fontMetrics().num2,S=k):(z=t.fontMetrics().num3,S=3*k),B=t.fontMetrics().denom2);var C;if(x){var q=t.fontMetrics().axisHeight;z-d.depth-(q+.5*w)\u003cS\u0026\u0026(z+=S-(z-d.depth-(q+.5*w))),q-.5*w-(y.height-B)\u003cS\u0026\u0026(B+=S-(q-.5*w-(y.height-B)));var Z=-(q-.5*w);C=b.makeVList({positionType:\"individualShift\",children:[{type:\"elem\",elem:y,shift:B},{type:\"elem\",elem:x,shift:Z},{type:\"elem\",elem:d,shift:-z}]},t)}else{var E=z-d.depth-(y.height-B);E\u003cS\u0026\u0026(z+=.5*(S-E),B+=.5*(S-E)),C=b.makeVList({positionType:\"individualShift\",children:[{type:\"elem\",elem:y,shift:B},{type:\"elem\",elem:d,shift:-z}]},t)}c=t.havingStyle(n),C.height*=c.sizeMultiplier/t.sizeMultiplier,C.depth*=c.sizeMultiplier/t.sizeMultiplier;var j;n.size===I.DISPLAY.size?j=t.fontMetrics().delim1:n.size===I.SCRIPTSCRIPT.size?j=t.havingStyle(I.SCRIPT).fontMetrics().delim2:j=t.fontMetrics().delim2;var U,V;return s.leftDelim==null?U=ga(t,[\"mopen\"]):U=Oe.customSizedDelim(s.leftDelim,j,!0,t.havingStyle(n),s.mode,[\"mopen\"]),s.continued?V=b.makeSpan([]):s.rightDelim==null?V=ga(t,[\"mclose\"]):V=Oe.customSizedDelim(s.rightDelim,j,!0,t.havingStyle(n),s.mode,[\"mclose\"]),b.makeSpan([\"mord\"].concat(c.sizingClasses(t)),[U,b.makeSpan([\"mfrac\"],[C]),V],t)},Bs=function(s,t){var n=new R.MathNode(\"mfrac\",[X(s.numer,t),X(s.denom,t)]);if(!s.hasBarLine)n.setAttribute(\"linethickness\",\"0px\");else if(s.barSize){var l=J(s.barSize,t);n.setAttribute(\"linethickness\",L(l))}var i=Wt(s.size,t.style);if(i.size!==t.style.size){n=new R.MathNode(\"mstyle\",[n]);var c=i.size===I.DISPLAY.size?\"true\":\"false\";n.setAttribute(\"displaystyle\",c),n.setAttribute(\"scriptlevel\",\"0\")}if(s.leftDelim!=null||s.rightDelim!=null){var d=[];if(s.leftDelim!=null){var o=new R.MathNode(\"mo\",[new R.TextNode(s.leftDelim.replace(\"\\\\\",\"\"))]);o.setAttribute(\"fence\",\"true\"),d.push(o)}if(d.push(n),s.rightDelim!=null){var g=new R.MathNode(\"mo\",[new R.TextNode(s.rightDelim.replace(\"\\\\\",\"\"))]);g.setAttribute(\"fence\",\"true\"),d.push(g)}return os(d)}return n};T({type:\"genfrac\",names:[\"\\\\dfrac\",\"\\\\frac\",\"\\\\tfrac\",\"\\\\dbinom\",\"\\\\binom\",\"\\\\tbinom\",\"\\\\\\\\atopfrac\",\"\\\\\\\\bracefrac\",\"\\\\\\\\brackfrac\"],props:{numArgs:2,allowedInArgument:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0],c=t[1],d,o=null,g=null,y=\"auto\";switch(l){case\"\\\\dfrac\":case\"\\\\frac\":case\"\\\\tfrac\":d=!0;break;case\"\\\\\\\\atopfrac\":d=!1;break;case\"\\\\dbinom\":case\"\\\\binom\":case\"\\\\tbinom\":d=!1,o=\"(\",g=\")\";break;case\"\\\\\\\\bracefrac\":d=!1,o=\"\\\\{\",g=\"\\\\}\";break;case\"\\\\\\\\brackfrac\":d=!1,o=\"[\",g=\"]\";break;default:throw new Error(\"Unrecognized genfrac command\")}switch(l){case\"\\\\dfrac\":case\"\\\\dbinom\":y=\"display\";break;case\"\\\\tfrac\":case\"\\\\tbinom\":y=\"text\";break}return{type:\"genfrac\",mode:n.mode,continued:!1,numer:i,denom:c,hasBarLine:d,leftDelim:o,rightDelim:g,size:y,barSize:null}},htmlBuilder:Ls,mathmlBuilder:Bs}),T({type:\"genfrac\",names:[\"\\\\cfrac\"],props:{numArgs:2},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0],c=t[1];return{type:\"genfrac\",mode:n.mode,continued:!0,numer:i,denom:c,hasBarLine:!0,leftDelim:null,rightDelim:null,size:\"display\",barSize:null}}}),T({type:\"infix\",names:[\"\\\\over\",\"\\\\choose\",\"\\\\atop\",\"\\\\brace\",\"\\\\brack\"],props:{numArgs:0,infix:!0},handler:function(s){var t=s.parser,n=s.funcName,l=s.token,i;switch(n){case\"\\\\over\":i=\"\\\\frac\";break;case\"\\\\choose\":i=\"\\\\binom\";break;case\"\\\\atop\":i=\"\\\\\\\\atopfrac\";break;case\"\\\\brace\":i=\"\\\\\\\\bracefrac\";break;case\"\\\\brack\":i=\"\\\\\\\\brackfrac\";break;default:throw new Error(\"Unrecognized infix genfrac command\")}return{type:\"infix\",mode:t.mode,replaceWith:i,token:l}}});var Xt=[\"display\",\"text\",\"script\",\"scriptscript\"],Yt=function(s){var t=null;return s.length\u003e0\u0026\u0026(t=s,t=t===\".\"?null:t),t};T({type:\"genfrac\",names:[\"\\\\genfrac\"],props:{numArgs:6,allowedInArgument:!0,argTypes:[\"math\",\"math\",\"size\",\"text\",\"math\",\"math\"]},handler:function(s,t){var n=s.parser,l=t[4],i=t[5],c=qa(t[0]),d=c.type===\"atom\"\u0026\u0026c.family===\"open\"?Yt(c.text):null,o=qa(t[1]),g=o.type===\"atom\"\u0026\u0026o.family===\"close\"?Yt(o.text):null,y=P(t[2],\"size\"),x,w=null;y.isBlank?x=!0:(w=y.value,x=w.number\u003e0);var k=\"auto\",z=t[3];if(z.type===\"ordgroup\"){if(z.body.length\u003e0){var S=P(z.body[0],\"textord\");k=Xt[Number(S.text)]}}else z=P(z,\"textord\"),k=Xt[Number(z.text)];return{type:\"genfrac\",mode:n.mode,numer:l,denom:i,continued:!1,hasBarLine:x,barSize:w,leftDelim:d,rightDelim:g,size:k}},htmlBuilder:Ls,mathmlBuilder:Bs}),T({type:\"infix\",names:[\"\\\\above\"],props:{numArgs:1,argTypes:[\"size\"],infix:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=s.token;return{type:\"infix\",mode:n.mode,replaceWith:\"\\\\\\\\abovefrac\",size:P(t[0],\"size\").value,token:i}}}),T({type:\"genfrac\",names:[\"\\\\\\\\abovefrac\"],props:{numArgs:3,argTypes:[\"math\",\"size\",\"math\"]},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0],c=Gn(P(t[1],\"infix\").size),d=t[2],o=c.number\u003e0;return{type:\"genfrac\",mode:n.mode,numer:i,denom:d,continued:!1,hasBarLine:o,barSize:c,leftDelim:null,rightDelim:null,size:\"auto\"}},htmlBuilder:Ls,mathmlBuilder:Bs});var $t=function(s,t){var n=t.style,l,i;s.type===\"supsub\"?(l=s.sup?_(s.sup,t.havingStyle(n.sup()),t):_(s.sub,t.havingStyle(n.sub()),t),i=P(s.base,\"horizBrace\")):i=P(s,\"horizBrace\");var c=_(i.base,t.havingBaseStyle(I.DISPLAY)),d=Fe.svgSpan(i,t),o;if(i.isOver?(o=b.makeVList({positionType:\"firstBaseline\",children:[{type:\"elem\",elem:c},{type:\"kern\",size:.1},{type:\"elem\",elem:d}]},t),o.children[0].children[0].children[1].classes.push(\"svg-align\")):(o=b.makeVList({positionType:\"bottom\",positionData:c.depth+.1+d.height,children:[{type:\"elem\",elem:d},{type:\"kern\",size:.1},{type:\"elem\",elem:c}]},t),o.children[0].children[0].children[0].classes.push(\"svg-align\")),l){var g=b.makeSpan([\"mord\",i.isOver?\"mover\":\"munder\"],[o],t);i.isOver?o=b.makeVList({positionType:\"firstBaseline\",children:[{type:\"elem\",elem:g},{type:\"kern\",size:.2},{type:\"elem\",elem:l}]},t):o=b.makeVList({positionType:\"bottom\",positionData:g.depth+.2+l.height+l.depth,children:[{type:\"elem\",elem:l},{type:\"kern\",size:.2},{type:\"elem\",elem:g}]},t)}return b.makeSpan([\"mord\",i.isOver?\"mover\":\"munder\"],[o],t)},ui=function(s,t){var n=Fe.mathMLnode(s.label);return new R.MathNode(s.isOver?\"mover\":\"munder\",[X(s.base,t),n])};T({type:\"horizBrace\",names:[\"\\\\overbrace\",\"\\\\underbrace\"],props:{numArgs:1},handler:function(s,t){var n=s.parser,l=s.funcName;return{type:\"horizBrace\",mode:n.mode,label:l,isOver:/^\\\\over/.test(l),base:t[0]}},htmlBuilder:$t,mathmlBuilder:ui}),T({type:\"href\",names:[\"\\\\href\"],props:{numArgs:2,argTypes:[\"url\",\"original\"],allowedInText:!0},handler:function(s,t){var n=s.parser,l=t[1],i=P(t[0],\"url\").url;return n.settings.isTrusted({command:\"\\\\href\",url:i})?{type:\"href\",mode:n.mode,href:i,body:se(l)}:n.formatUnsupportedCmd(\"\\\\href\")},htmlBuilder:function(s,t){var n=le(s.body,t,!1);return b.makeAnchor(s.href,[],n,t)},mathmlBuilder:function(s,t){var n=_e(s.body,t);return n instanceof ye||(n=new ye(\"mrow\",[n])),n.setAttribute(\"href\",s.href),n}}),T({type:\"href\",names:[\"\\\\url\"],props:{numArgs:1,argTypes:[\"url\"],allowedInText:!0},handler:function(s,t){var n=s.parser,l=P(t[0],\"url\").url;if(!n.settings.isTrusted({command:\"\\\\url\",url:l}))return n.formatUnsupportedCmd(\"\\\\url\");for(var i=[],c=0;c\u003cl.length;c++){var d=l[c];d===\"~\"\u0026\u0026(d=\"\\\\textasciitilde\"),i.push({type:\"textord\",mode:\"text\",text:d})}var o={type:\"text\",mode:n.mode,font:\"\\\\texttt\",body:i};return{type:\"href\",mode:n.mode,href:l,body:se(o)}}}),T({type:\"hbox\",names:[\"\\\\hbox\"],props:{numArgs:1,argTypes:[\"text\"],allowedInText:!0,primitive:!0},handler:function(s,t){var n=s.parser;return{type:\"hbox\",mode:n.mode,body:se(t[0])}},htmlBuilder:function(s,t){var n=le(s.body,t,!1);return b.makeFragment(n)},mathmlBuilder:function(s,t){return new R.MathNode(\"mrow\",oe(s.body,t))}}),T({type:\"html\",names:[\"\\\\htmlClass\",\"\\\\htmlId\",\"\\\\htmlStyle\",\"\\\\htmlData\"],props:{numArgs:2,argTypes:[\"raw\",\"original\"],allowedInText:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=s.token,c=P(t[0],\"raw\").string,d=t[1];n.settings.strict\u0026\u0026n.settings.reportNonstrict(\"htmlExtension\",\"HTML extension is disabled on strict mode\");var o,g={};switch(l){case\"\\\\htmlClass\":g.class=c,o={command:\"\\\\htmlClass\",class:c};break;case\"\\\\htmlId\":g.id=c,o={command:\"\\\\htmlId\",id:c};break;case\"\\\\htmlStyle\":g.style=c,o={command:\"\\\\htmlStyle\",style:c};break;case\"\\\\htmlData\":{for(var y=c.split(\",\"),x=0;x\u003cy.length;x++){var w=y[x].split(\"=\");if(w.length!==2)throw new A(\"Error parsing key-value for \\\\htmlData\");g[\"data-\"+w[0].trim()]=w[1].trim()}o={command:\"\\\\htmlData\",attributes:g};break}default:throw new Error(\"Unrecognized html command\")}return n.settings.isTrusted(o)?{type:\"html\",mode:n.mode,attributes:g,body:se(d)}:n.formatUnsupportedCmd(l)},htmlBuilder:function(s,t){var n=le(s.body,t,!1),l=[\"enclosing\"];s.attributes.class\u0026\u0026l.push.apply(l,s.attributes.class.trim().split(/\\s+/));var i=b.makeSpan(l,n,t);for(var c in s.attributes)c!==\"class\"\u0026\u0026s.attributes.hasOwnProperty(c)\u0026\u0026i.setAttribute(c,s.attributes[c]);return i},mathmlBuilder:function(s,t){return _e(s.body,t)}}),T({type:\"htmlmathml\",names:[\"\\\\html@mathml\"],props:{numArgs:2,allowedInText:!0},handler:function(s,t){var n=s.parser;return{type:\"htmlmathml\",mode:n.mode,html:se(t[0]),mathml:se(t[1])}},htmlBuilder:function(s,t){var n=le(s.html,t,!1);return b.makeFragment(n)},mathmlBuilder:function(s,t){return _e(s.mathml,t)}});var Ts=function(s){if(/^[-+]? *(\\d+(\\.\\d*)?|\\.\\d+)$/.test(s))return{number:+s,unit:\"bp\"};var t=/([-+]?) *(\\d+(?:\\.\\d*)?|\\.\\d+) *([a-z]{2})/.exec(s);if(!t)throw new A(\"Invalid size: '\"+s+\"' in \\\\includegraphics\");var n={number:+(t[1]+t[2]),unit:t[3]};if(!Ks(n))throw new A(\"Invalid unit: '\"+n.unit+\"' in \\\\includegraphics.\");return n};T({type:\"includegraphics\",names:[\"\\\\includegraphics\"],props:{numArgs:1,numOptionalArgs:1,argTypes:[\"raw\",\"url\"],allowedInText:!1},handler:function(s,t,n){var l=s.parser,i={number:0,unit:\"em\"},c={number:.9,unit:\"em\"},d={number:0,unit:\"em\"},o=\"\";if(n[0])for(var g=P(n[0],\"raw\").string,y=g.split(\",\"),x=0;x\u003cy.length;x++){var w=y[x].split(\"=\");if(w.length===2){var k=w[1].trim();switch(w[0].trim()){case\"alt\":o=k;break;case\"width\":i=Ts(k);break;case\"height\":c=Ts(k);break;case\"totalheight\":d=Ts(k);break;default:throw new A(\"Invalid key: '\"+w[0]+\"' in \\\\includegraphics.\")}}}var z=P(t[0],\"url\").url;return o===\"\"\u0026\u0026(o=z,o=o.replace(/^.*[\\\\/]/,\"\"),o=o.substring(0,o.lastIndexOf(\".\"))),l.settings.isTrusted({command:\"\\\\includegraphics\",url:z})?{type:\"includegraphics\",mode:l.mode,alt:o,width:i,height:c,totalheight:d,src:z}:l.formatUnsupportedCmd(\"\\\\includegraphics\")},htmlBuilder:function(s,t){var n=J(s.height,t),l=0;s.totalheight.number\u003e0\u0026\u0026(l=J(s.totalheight,t)-n);var i=0;s.width.number\u003e0\u0026\u0026(i=J(s.width,t));var c={height:L(n+l)};i\u003e0\u0026\u0026(c.width=L(i)),l\u003e0\u0026\u0026(c.verticalAlign=L(-l));var d=new ol(s.src,s.alt,c);return d.height=n,d.depth=l,d},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mglyph\",[]);n.setAttribute(\"alt\",s.alt);var l=J(s.height,t),i=0;if(s.totalheight.number\u003e0\u0026\u0026(i=J(s.totalheight,t)-l,n.setAttribute(\"valign\",L(-i))),n.setAttribute(\"height\",L(l+i)),s.width.number\u003e0){var c=J(s.width,t);n.setAttribute(\"width\",L(c))}return n.setAttribute(\"src\",s.src),n}}),T({type:\"kern\",names:[\"\\\\kern\",\"\\\\mkern\",\"\\\\hskip\",\"\\\\mskip\"],props:{numArgs:1,argTypes:[\"size\"],primitive:!0,allowedInText:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=P(t[0],\"size\");if(n.settings.strict){var c=l[1]===\"m\",d=i.value.unit===\"mu\";c?(d||n.settings.reportNonstrict(\"mathVsTextUnits\",\"LaTeX's \"+l+\" supports only mu units, \"+(\"not \"+i.value.unit+\" units\")),n.mode!==\"math\"\u0026\u0026n.settings.reportNonstrict(\"mathVsTextUnits\",\"LaTeX's \"+l+\" works only in math mode\")):d\u0026\u0026n.settings.reportNonstrict(\"mathVsTextUnits\",\"LaTeX's \"+l+\" doesn't support mu units\")}return{type:\"kern\",mode:n.mode,dimension:i.value}},htmlBuilder:function(s,t){return b.makeGlue(s.dimension,t)},mathmlBuilder:function(s,t){var n=J(s.dimension,t);return new R.SpaceNode(n)}}),T({type:\"lap\",names:[\"\\\\mathllap\",\"\\\\mathrlap\",\"\\\\mathclap\"],props:{numArgs:1,allowedInText:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0];return{type:\"lap\",mode:n.mode,alignment:l.slice(5),body:i}},htmlBuilder:function(s,t){var n;s.alignment===\"clap\"?(n=b.makeSpan([],[_(s.body,t)]),n=b.makeSpan([\"inner\"],[n],t)):n=b.makeSpan([\"inner\"],[_(s.body,t)]);var l=b.makeSpan([\"fix\"],[]),i=b.makeSpan([s.alignment],[n,l],t),c=b.makeSpan([\"strut\"]);return c.style.height=L(i.height+i.depth),i.depth\u0026\u0026(c.style.verticalAlign=L(-i.depth)),i.children.unshift(c),i=b.makeSpan([\"thinbox\"],[i],t),b.makeSpan([\"mord\",\"vbox\"],[i],t)},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mpadded\",[X(s.body,t)]);if(s.alignment!==\"rlap\"){var l=s.alignment===\"llap\"?\"-1\":\"-0.5\";n.setAttribute(\"lspace\",l+\"width\")}return n.setAttribute(\"width\",\"0px\"),n}}),T({type:\"styling\",names:[\"\\\\(\",\"$\"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler:function(s,t){var n=s.funcName,l=s.parser,i=l.mode;l.switchMode(\"math\");var c=n===\"\\\\(\"?\"\\\\)\":\"$\",d=l.parseExpression(!1,c);return l.expect(c),l.switchMode(i),{type:\"styling\",mode:l.mode,style:\"text\",body:d}}}),T({type:\"text\",names:[\"\\\\)\",\"\\\\]\"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler:function(s,t){throw new A(\"Mismatched \"+s.funcName)}});var Jt=function(s,t){switch(t.style.size){case I.DISPLAY.size:return s.display;case I.TEXT.size:return s.text;case I.SCRIPT.size:return s.script;case I.SCRIPTSCRIPT.size:return s.scriptscript;default:return s.text}};T({type:\"mathchoice\",names:[\"\\\\mathchoice\"],props:{numArgs:4,primitive:!0},handler:function(s,t){var n=s.parser;return{type:\"mathchoice\",mode:n.mode,display:se(t[0]),text:se(t[1]),script:se(t[2]),scriptscript:se(t[3])}},htmlBuilder:function(s,t){var n=Jt(s,t),l=le(n,t,!1);return b.makeFragment(l)},mathmlBuilder:function(s,t){var n=Jt(s,t);return _e(n,t)}});var Kt=function(s,t,n,l,i,c,d){s=b.makeSpan([],[s]);var o=n\u0026\u0026O.isCharacterBox(n),g,y;if(t){var x=_(t,l.havingStyle(i.sup()),l);y={elem:x,kern:Math.max(l.fontMetrics().bigOpSpacing1,l.fontMetrics().bigOpSpacing3-x.depth)}}if(n){var w=_(n,l.havingStyle(i.sub()),l);g={elem:w,kern:Math.max(l.fontMetrics().bigOpSpacing2,l.fontMetrics().bigOpSpacing4-w.height)}}var k;if(y\u0026\u0026g){var z=l.fontMetrics().bigOpSpacing5+g.elem.height+g.elem.depth+g.kern+s.depth+d;k=b.makeVList({positionType:\"bottom\",positionData:z,children:[{type:\"kern\",size:l.fontMetrics().bigOpSpacing5},{type:\"elem\",elem:g.elem,marginLeft:L(-c)},{type:\"kern\",size:g.kern},{type:\"elem\",elem:s},{type:\"kern\",size:y.kern},{type:\"elem\",elem:y.elem,marginLeft:L(c)},{type:\"kern\",size:l.fontMetrics().bigOpSpacing5}]},l)}else if(g){var S=s.height-d;k=b.makeVList({positionType:\"top\",positionData:S,children:[{type:\"kern\",size:l.fontMetrics().bigOpSpacing5},{type:\"elem\",elem:g.elem,marginLeft:L(-c)},{type:\"kern\",size:g.kern},{type:\"elem\",elem:s}]},l)}else if(y){var B=s.depth+d;k=b.makeVList({positionType:\"bottom\",positionData:B,children:[{type:\"elem\",elem:s},{type:\"kern\",size:y.kern},{type:\"elem\",elem:y.elem,marginLeft:L(c)},{type:\"kern\",size:l.fontMetrics().bigOpSpacing5}]},l)}else return s;var C=[k];if(g\u0026\u0026c!==0\u0026\u0026!o){var E=b.makeSpan([\"mspace\"],[],l);E.style.marginRight=L(c),C.unshift(E)}return b.makeSpan([\"mop\",\"op-limits\"],C,l)},Qt=[\"\\\\smallint\"],la=function(s,t){var n,l,i=!1,c;s.type===\"supsub\"?(n=s.sup,l=s.sub,c=P(s.base,\"op\"),i=!0):c=P(s,\"op\");var d=t.style,o=!1;d.size===I.DISPLAY.size\u0026\u0026c.symbol\u0026\u0026!O.contains(Qt,c.name)\u0026\u0026(o=!0);var g;if(c.symbol){var y=o?\"Size2-Regular\":\"Size1-Regular\",x=\"\";if((c.name===\"\\\\oiint\"||c.name===\"\\\\oiiint\")\u0026\u0026(x=c.name.slice(1),c.name=x===\"oiint\"?\"\\\\iint\":\"\\\\iiint\"),g=b.makeSymbol(c.name,y,\"math\",t,[\"mop\",\"op-symbol\",o?\"large-op\":\"small-op\"]),x.length\u003e0){var w=g.italic,k=b.staticSvg(x+\"Size\"+(o?\"2\":\"1\"),t);g=b.makeVList({positionType:\"individualShift\",children:[{type:\"elem\",elem:g,shift:0},{type:\"elem\",elem:k,shift:o?.08:0}]},t),c.name=\"\\\\\"+x,g.classes.unshift(\"mop\"),g.italic=w}}else if(c.body){var z=le(c.body,t,!0);z.length===1\u0026\u0026z[0]instanceof ve?(g=z[0],g.classes[0]=\"mop\"):g=b.makeSpan([\"mop\"],z,t)}else{for(var S=[],B=1;B\u003cc.name.length;B++)S.push(b.mathsym(c.name[B],c.mode,t));g=b.makeSpan([\"mop\"],S,t)}var C=0,E=0;return(g instanceof ve||c.name===\"\\\\oiint\"||c.name===\"\\\\oiiint\")\u0026\u0026!c.suppressBaseShift\u0026\u0026(C=(g.height-g.depth)/2-t.fontMetrics().axisHeight,E=g.italic),i?Kt(g,n,l,t,d,E,C):(C\u0026\u0026(g.style.position=\"relative\",g.style.top=L(C)),g)},fa=function(s,t){var n;if(s.symbol)n=new ye(\"mo\",[fe(s.name,s.mode)]),O.contains(Qt,s.name)\u0026\u0026n.setAttribute(\"largeop\",\"false\");else if(s.body)n=new ye(\"mo\",oe(s.body,t));else{n=new ye(\"mi\",[new Na(s.name.slice(1))]);var l=new ye(\"mo\",[fe(\"\\u2061\",\"text\")]);s.parentIsSupSub?n=new ye(\"mrow\",[n,l]):n=Nt([n,l])}return n},gi={\"\\u220F\":\"\\\\prod\",\"\\u2210\":\"\\\\coprod\",\"\\u2211\":\"\\\\sum\",\"\\u22C0\":\"\\\\bigwedge\",\"\\u22C1\":\"\\\\bigvee\",\"\\u22C2\":\"\\\\bigcap\",\"\\u22C3\":\"\\\\bigcup\",\"\\u2A00\":\"\\\\bigodot\",\"\\u2A01\":\"\\\\bigoplus\",\"\\u2A02\":\"\\\\bigotimes\",\"\\u2A04\":\"\\\\biguplus\",\"\\u2A06\":\"\\\\bigsqcup\"};T({type:\"op\",names:[\"\\\\coprod\",\"\\\\bigvee\",\"\\\\bigwedge\",\"\\\\biguplus\",\"\\\\bigcap\",\"\\\\bigcup\",\"\\\\intop\",\"\\\\prod\",\"\\\\sum\",\"\\\\bigotimes\",\"\\\\bigoplus\",\"\\\\bigodot\",\"\\\\bigsqcup\",\"\\\\smallint\",\"\\u220F\",\"\\u2210\",\"\\u2211\",\"\\u22C0\",\"\\u22C1\",\"\\u22C2\",\"\\u22C3\",\"\\u2A00\",\"\\u2A01\",\"\\u2A02\",\"\\u2A04\",\"\\u2A06\"],props:{numArgs:0},handler:function(s,t){var n=s.parser,l=s.funcName,i=l;return i.length===1\u0026\u0026(i=gi[i]),{type:\"op\",mode:n.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:i}},htmlBuilder:la,mathmlBuilder:fa}),T({type:\"op\",names:[\"\\\\mathop\"],props:{numArgs:1,primitive:!0},handler:function(s,t){var n=s.parser,l=t[0];return{type:\"op\",mode:n.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:se(l)}},htmlBuilder:la,mathmlBuilder:fa});var Ni={\"\\u222B\":\"\\\\int\",\"\\u222C\":\"\\\\iint\",\"\\u222D\":\"\\\\iiint\",\"\\u222E\":\"\\\\oint\",\"\\u222F\":\"\\\\oiint\",\"\\u2230\":\"\\\\oiiint\"};T({type:\"op\",names:[\"\\\\arcsin\",\"\\\\arccos\",\"\\\\arctan\",\"\\\\arctg\",\"\\\\arcctg\",\"\\\\arg\",\"\\\\ch\",\"\\\\cos\",\"\\\\cosec\",\"\\\\cosh\",\"\\\\cot\",\"\\\\cotg\",\"\\\\coth\",\"\\\\csc\",\"\\\\ctg\",\"\\\\cth\",\"\\\\deg\",\"\\\\dim\",\"\\\\exp\",\"\\\\hom\",\"\\\\ker\",\"\\\\lg\",\"\\\\ln\",\"\\\\log\",\"\\\\sec\",\"\\\\sin\",\"\\\\sinh\",\"\\\\sh\",\"\\\\tan\",\"\\\\tanh\",\"\\\\tg\",\"\\\\th\"],props:{numArgs:0},handler:function(s){var t=s.parser,n=s.funcName;return{type:\"op\",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:n}},htmlBuilder:la,mathmlBuilder:fa}),T({type:\"op\",names:[\"\\\\det\",\"\\\\gcd\",\"\\\\inf\",\"\\\\lim\",\"\\\\max\",\"\\\\min\",\"\\\\Pr\",\"\\\\sup\"],props:{numArgs:0},handler:function(s){var t=s.parser,n=s.funcName;return{type:\"op\",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:n}},htmlBuilder:la,mathmlBuilder:fa}),T({type:\"op\",names:[\"\\\\int\",\"\\\\iint\",\"\\\\iiint\",\"\\\\oint\",\"\\\\oiint\",\"\\\\oiiint\",\"\\u222B\",\"\\u222C\",\"\\u222D\",\"\\u222E\",\"\\u222F\",\"\\u2230\"],props:{numArgs:0},handler:function(s){var t=s.parser,n=s.funcName,l=n;return l.length===1\u0026\u0026(l=Ni[l]),{type:\"op\",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:l}},htmlBuilder:la,mathmlBuilder:fa});var en=function(s,t){var n,l,i=!1,c;s.type===\"supsub\"?(n=s.sup,l=s.sub,c=P(s.base,\"operatorname\"),i=!0):c=P(s,\"operatorname\");var d;if(c.body.length\u003e0){for(var o=c.body.map(function(w){var k=w.text;return typeof k==\"string\"?{type:\"textord\",mode:w.mode,text:k}:w}),g=le(o,t.withFont(\"mathrm\"),!0),y=0;y\u003cg.length;y++){var x=g[y];x instanceof ve\u0026\u0026(x.text=x.text.replace(/\\u2212/,\"-\").replace(/\\u2217/,\"*\"))}d=b.makeSpan([\"mop\"],g,t)}else d=b.makeSpan([\"mop\"],[],t);return i?Kt(d,n,l,t,t.style,0,0):d},vi=function(s,t){for(var n=oe(s.body,t.withFont(\"mathrm\")),l=!0,i=0;i\u003cn.length;i++){var c=n[i];if(!(c instanceof R.SpaceNode))if(c instanceof R.MathNode)switch(c.type){case\"mi\":case\"mn\":case\"ms\":case\"mspace\":case\"mtext\":break;case\"mo\":{var d=c.children[0];c.children.length===1\u0026\u0026d instanceof R.TextNode?d.text=d.text.replace(/\\u2212/,\"-\").replace(/\\u2217/,\"*\"):l=!1;break}default:l=!1}else l=!1}if(l){var o=n.map(function(x){return x.toText()}).join(\"\");n=[new R.TextNode(o)]}var g=new R.MathNode(\"mi\",n);g.setAttribute(\"mathvariant\",\"normal\");var y=new R.MathNode(\"mo\",[fe(\"\\u2061\",\"text\")]);return s.parentIsSupSub?new R.MathNode(\"mrow\",[g,y]):R.newDocumentFragment([g,y])};T({type:\"operatorname\",names:[\"\\\\operatorname@\",\"\\\\operatornamewithlimits\"],props:{numArgs:1},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0];return{type:\"operatorname\",mode:n.mode,body:se(i),alwaysHandleSupSub:l===\"\\\\operatornamewithlimits\",limits:!1,parentIsSupSub:!1}},htmlBuilder:en,mathmlBuilder:vi}),u(\"\\\\operatorname\",\"\\\\@ifstar\\\\operatornamewithlimits\\\\operatorname@\"),Qe({type:\"ordgroup\",htmlBuilder:function(s,t){return s.semisimple?b.makeFragment(le(s.body,t,!1)):b.makeSpan([\"mord\"],le(s.body,t,!0),t)},mathmlBuilder:function(s,t){return _e(s.body,t,!0)}}),T({type:\"overline\",names:[\"\\\\overline\"],props:{numArgs:1},handler:function(s,t){var n=s.parser,l=t[0];return{type:\"overline\",mode:n.mode,body:l}},htmlBuilder:function(s,t){var n=_(s.body,t.havingCrampedStyle()),l=b.makeLineSpan(\"overline-line\",t),i=t.fontMetrics().defaultRuleThickness,c=b.makeVList({positionType:\"firstBaseline\",children:[{type:\"elem\",elem:n},{type:\"kern\",size:3*i},{type:\"elem\",elem:l},{type:\"kern\",size:i}]},t);return b.makeSpan([\"mord\",\"overline\"],[c],t)},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mo\",[new R.TextNode(\"\\u203E\")]);n.setAttribute(\"stretchy\",\"true\");var l=new R.MathNode(\"mover\",[X(s.body,t),n]);return l.setAttribute(\"accent\",\"true\"),l}}),T({type:\"phantom\",names:[\"\\\\phantom\"],props:{numArgs:1,allowedInText:!0},handler:function(s,t){var n=s.parser,l=t[0];return{type:\"phantom\",mode:n.mode,body:se(l)}},htmlBuilder:function(s,t){var n=le(s.body,t.withPhantom(),!1);return b.makeFragment(n)},mathmlBuilder:function(s,t){var n=oe(s.body,t);return new R.MathNode(\"mphantom\",n)}}),T({type:\"hphantom\",names:[\"\\\\hphantom\"],props:{numArgs:1,allowedInText:!0},handler:function(s,t){var n=s.parser,l=t[0];return{type:\"hphantom\",mode:n.mode,body:l}},htmlBuilder:function(s,t){var n=b.makeSpan([],[_(s.body,t.withPhantom())]);if(n.height=0,n.depth=0,n.children)for(var l=0;l\u003cn.children.length;l++)n.children[l].height=0,n.children[l].depth=0;return n=b.makeVList({positionType:\"firstBaseline\",children:[{type:\"elem\",elem:n}]},t),b.makeSpan([\"mord\"],[n],t)},mathmlBuilder:function(s,t){var n=oe(se(s.body),t),l=new R.MathNode(\"mphantom\",n),i=new R.MathNode(\"mpadded\",[l]);return i.setAttribute(\"height\",\"0px\"),i.setAttribute(\"depth\",\"0px\"),i}}),T({type:\"vphantom\",names:[\"\\\\vphantom\"],props:{numArgs:1,allowedInText:!0},handler:function(s,t){var n=s.parser,l=t[0];return{type:\"vphantom\",mode:n.mode,body:l}},htmlBuilder:function(s,t){var n=b.makeSpan([\"inner\"],[_(s.body,t.withPhantom())]),l=b.makeSpan([\"fix\"],[]);return b.makeSpan([\"mord\",\"rlap\"],[n,l],t)},mathmlBuilder:function(s,t){var n=oe(se(s.body),t),l=new R.MathNode(\"mphantom\",n),i=new R.MathNode(\"mpadded\",[l]);return i.setAttribute(\"width\",\"0px\"),i}}),T({type:\"raisebox\",names:[\"\\\\raisebox\"],props:{numArgs:2,argTypes:[\"size\",\"hbox\"],allowedInText:!0},handler:function(s,t){var n=s.parser,l=P(t[0],\"size\").value,i=t[1];return{type:\"raisebox\",mode:n.mode,dy:l,body:i}},htmlBuilder:function(s,t){var n=_(s.body,t),l=J(s.dy,t);return b.makeVList({positionType:\"shift\",positionData:-l,children:[{type:\"elem\",elem:n}]},t)},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mpadded\",[X(s.body,t)]),l=s.dy.number+s.dy.unit;return n.setAttribute(\"voffset\",l),n}}),T({type:\"internal\",names:[\"\\\\relax\"],props:{numArgs:0,allowedInText:!0},handler:function(s){var t=s.parser;return{type:\"internal\",mode:t.mode}}}),T({type:\"rule\",names:[\"\\\\rule\"],props:{numArgs:2,numOptionalArgs:1,argTypes:[\"size\",\"size\",\"size\"]},handler:function(s,t,n){var l=s.parser,i=n[0],c=P(t[0],\"size\"),d=P(t[1],\"size\");return{type:\"rule\",mode:l.mode,shift:i\u0026\u0026P(i,\"size\").value,width:c.value,height:d.value}},htmlBuilder:function(s,t){var n=b.makeSpan([\"mord\",\"rule\"],[],t),l=J(s.width,t),i=J(s.height,t),c=s.shift?J(s.shift,t):0;return n.style.borderRightWidth=L(l),n.style.borderTopWidth=L(i),n.style.bottom=L(c),n.width=l,n.height=i+c,n.depth=-c,n.maxFontSize=i*1.125*t.sizeMultiplier,n},mathmlBuilder:function(s,t){var n=J(s.width,t),l=J(s.height,t),i=s.shift?J(s.shift,t):0,c=t.color\u0026\u0026t.getColor()||\"black\",d=new R.MathNode(\"mspace\");d.setAttribute(\"mathbackground\",c),d.setAttribute(\"width\",L(n)),d.setAttribute(\"height\",L(l));var o=new R.MathNode(\"mpadded\",[d]);return i\u003e=0?o.setAttribute(\"height\",L(i)):(o.setAttribute(\"height\",L(i)),o.setAttribute(\"depth\",L(-i))),o.setAttribute(\"voffset\",L(i)),o}});function an(m,s,t){for(var n=le(m,s,!1),l=s.sizeMultiplier/t.sizeMultiplier,i=0;i\u003cn.length;i++){var c=n[i].classes.indexOf(\"sizing\");c\u003c0?Array.prototype.push.apply(n[i].classes,s.sizingClasses(t)):n[i].classes[c+1]===\"reset-size\"+s.size\u0026\u0026(n[i].classes[c+1]=\"reset-size\"+t.size),n[i].height*=l,n[i].depth*=l}return b.makeFragment(n)}var sn=[\"\\\\tiny\",\"\\\\sixptsize\",\"\\\\scriptsize\",\"\\\\footnotesize\",\"\\\\small\",\"\\\\normalsize\",\"\\\\large\",\"\\\\Large\",\"\\\\LARGE\",\"\\\\huge\",\"\\\\Huge\"],yi=function(s,t){var n=t.havingSize(s.size);return an(s.body,n,t)};T({type:\"sizing\",names:sn,props:{numArgs:0,allowedInText:!0},handler:function(s,t){var n=s.breakOnTokenText,l=s.funcName,i=s.parser,c=i.parseExpression(!1,n);return{type:\"sizing\",mode:i.mode,size:sn.indexOf(l)+1,body:c}},htmlBuilder:yi,mathmlBuilder:function(s,t){var n=t.havingSize(s.size),l=oe(s.body,n),i=new R.MathNode(\"mstyle\",l);return i.setAttribute(\"mathsize\",L(n.sizeMultiplier)),i}}),T({type:\"smash\",names:[\"\\\\smash\"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:function(s,t,n){var l=s.parser,i=!1,c=!1,d=n[0]\u0026\u0026P(n[0],\"ordgroup\");if(d)for(var o=\"\",g=0;g\u003cd.body.length;++g){var y=d.body[g];if(o=y.text,o===\"t\")i=!0;else if(o===\"b\")c=!0;else{i=!1,c=!1;break}}else i=!0,c=!0;var x=t[0];return{type:\"smash\",mode:l.mode,body:x,smashHeight:i,smashDepth:c}},htmlBuilder:function(s,t){var n=b.makeSpan([],[_(s.body,t)]);if(!s.smashHeight\u0026\u0026!s.smashDepth)return n;if(s.smashHeight\u0026\u0026(n.height=0,n.children))for(var l=0;l\u003cn.children.length;l++)n.children[l].height=0;if(s.smashDepth\u0026\u0026(n.depth=0,n.children))for(var i=0;i\u003cn.children.length;i++)n.children[i].depth=0;var c=b.makeVList({positionType:\"firstBaseline\",children:[{type:\"elem\",elem:n}]},t);return b.makeSpan([\"mord\"],[c],t)},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mpadded\",[X(s.body,t)]);return s.smashHeight\u0026\u0026n.setAttribute(\"height\",\"0px\"),s.smashDepth\u0026\u0026n.setAttribute(\"depth\",\"0px\"),n}}),T({type:\"sqrt\",names:[\"\\\\sqrt\"],props:{numArgs:1,numOptionalArgs:1},handler:function(s,t,n){var l=s.parser,i=n[0],c=t[0];return{type:\"sqrt\",mode:l.mode,body:c,index:i}},htmlBuilder:function(s,t){var n=_(s.body,t.havingCrampedStyle());n.height===0\u0026\u0026(n.height=t.fontMetrics().xHeight),n=b.wrapFragment(n,t);var l=t.fontMetrics(),i=l.defaultRuleThickness,c=i;t.style.id\u003cI.TEXT.id\u0026\u0026(c=t.fontMetrics().xHeight);var d=i+c/4,o=n.height+n.depth+d+i,g=Oe.sqrtImage(o,t),y=g.span,x=g.ruleWidth,w=g.advanceWidth,k=y.height-x;k\u003en.height+n.depth+d\u0026\u0026(d=(d+k-n.height-n.depth)/2);var z=y.height-n.height-d-x;n.style.paddingLeft=L(w);var S=b.makeVList({positionType:\"firstBaseline\",children:[{type:\"elem\",elem:n,wrapperClasses:[\"svg-align\"]},{type:\"kern\",size:-(n.height+z)},{type:\"elem\",elem:y},{type:\"kern\",size:x}]},t);if(s.index){var B=t.havingStyle(I.SCRIPTSCRIPT),C=_(s.index,B,t),E=.6*(S.height-S.depth),q=b.makeVList({positionType:\"shift\",positionData:-E,children:[{type:\"elem\",elem:C}]},t),Z=b.makeSpan([\"root\"],[q]);return b.makeSpan([\"mord\",\"sqrt\"],[Z,S],t)}else return b.makeSpan([\"mord\",\"sqrt\"],[S],t)},mathmlBuilder:function(s,t){var n=s.body,l=s.index;return l?new R.MathNode(\"mroot\",[X(n,t),X(l,t)]):new R.MathNode(\"msqrt\",[X(n,t)])}});var tn={display:I.DISPLAY,text:I.TEXT,script:I.SCRIPT,scriptscript:I.SCRIPTSCRIPT};T({type:\"styling\",names:[\"\\\\displaystyle\",\"\\\\textstyle\",\"\\\\scriptstyle\",\"\\\\scriptscriptstyle\"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler:function(s,t){var n=s.breakOnTokenText,l=s.funcName,i=s.parser,c=i.parseExpression(!0,n),d=l.slice(1,l.length-5);return{type:\"styling\",mode:i.mode,style:d,body:c}},htmlBuilder:function(s,t){var n=tn[s.style],l=t.havingStyle(n).withFont(\"\");return an(s.body,l,t)},mathmlBuilder:function(s,t){var n=tn[s.style],l=t.havingStyle(n),i=oe(s.body,l),c=new R.MathNode(\"mstyle\",i),d={display:[\"0\",\"true\"],text:[\"0\",\"false\"],script:[\"1\",\"false\"],scriptscript:[\"2\",\"false\"]},o=d[s.style];return c.setAttribute(\"scriptlevel\",o[0]),c.setAttribute(\"displaystyle\",o[1]),c}});var fi=function(s,t){var n=s.base;if(n)if(n.type===\"op\"){var l=n.limits\u0026\u0026(t.style.size===I.DISPLAY.size||n.alwaysHandleSupSub);return l?la:null}else if(n.type===\"operatorname\"){var i=n.alwaysHandleSupSub\u0026\u0026(t.style.size===I.DISPLAY.size||n.limits);return i?en:null}else{if(n.type===\"accent\")return O.isCharacterBox(n.base)?Ns:null;if(n.type===\"horizBrace\"){var c=!s.sub;return c===n.isOver?$t:null}else return null}else return null};Qe({type:\"supsub\",htmlBuilder:function(s,t){var n=fi(s,t);if(n)return n(s,t);var l=s.base,i=s.sup,c=s.sub,d=_(l,t),o,g,y=t.fontMetrics(),x=0,w=0,k=l\u0026\u0026O.isCharacterBox(l);if(i){var z=t.havingStyle(t.style.sup());o=_(i,z,t),k||(x=d.height-z.fontMetrics().supDrop*z.sizeMultiplier/t.sizeMultiplier)}if(c){var S=t.havingStyle(t.style.sub());g=_(c,S,t),k||(w=d.depth+S.fontMetrics().subDrop*S.sizeMultiplier/t.sizeMultiplier)}var B;t.style===I.DISPLAY?B=y.sup1:t.style.cramped?B=y.sup3:B=y.sup2;var C=t.sizeMultiplier,E=L(.5/y.ptPerEm/C),q=null;if(g){var Z=s.base\u0026\u0026s.base.type===\"op\"\u0026\u0026s.base.name\u0026\u0026(s.base.name===\"\\\\oiint\"||s.base.name===\"\\\\oiiint\");(d instanceof ve||Z)\u0026\u0026(q=L(-d.italic))}var j;if(o\u0026\u0026g){x=Math.max(x,B,o.depth+.25*y.xHeight),w=Math.max(w,y.sub2);var U=y.defaultRuleThickness,V=4*U;if(x-o.depth-(g.height-w)\u003cV){w=V-(x-o.depth)+g.height;var W=.8*y.xHeight-(x-o.depth);W\u003e0\u0026\u0026(x+=W,w-=W)}var Y=[{type:\"elem\",elem:g,shift:w,marginRight:E,marginLeft:q},{type:\"elem\",elem:o,shift:-x,marginRight:E}];j=b.makeVList({positionType:\"individualShift\",children:Y},t)}else if(g){w=Math.max(w,y.sub1,g.height-.8*y.xHeight);var ie=[{type:\"elem\",elem:g,marginLeft:q,marginRight:E}];j=b.makeVList({positionType:\"shift\",positionData:w,children:ie},t)}else if(o)x=Math.max(x,B,o.depth+.25*y.xHeight),j=b.makeVList({positionType:\"shift\",positionData:-x,children:[{type:\"elem\",elem:o,marginRight:E}]},t);else throw new Error(\"supsub must have either sup or sub.\");var ge=ds(d,\"right\")||\"mord\";return b.makeSpan([ge],[d,b.makeSpan([\"msupsub\"],[j])],t)},mathmlBuilder:function(s,t){var n=!1,l,i;s.base\u0026\u0026s.base.type===\"horizBrace\"\u0026\u0026(i=!!s.sup,i===s.base.isOver\u0026\u0026(n=!0,l=s.base.isOver)),s.base\u0026\u0026(s.base.type===\"op\"||s.base.type===\"operatorname\")\u0026\u0026(s.base.parentIsSupSub=!0);var c=[X(s.base,t)];s.sub\u0026\u0026c.push(X(s.sub,t)),s.sup\u0026\u0026c.push(X(s.sup,t));var d;if(n)d=l?\"mover\":\"munder\";else if(s.sub)if(s.sup){var y=s.base;y\u0026\u0026y.type===\"op\"\u0026\u0026y.limits\u0026\u0026t.style===I.DISPLAY||y\u0026\u0026y.type===\"operatorname\"\u0026\u0026y.alwaysHandleSupSub\u0026\u0026(t.style===I.DISPLAY||y.limits)?d=\"munderover\":d=\"msubsup\"}else{var g=s.base;g\u0026\u0026g.type===\"op\"\u0026\u0026g.limits\u0026\u0026(t.style===I.DISPLAY||g.alwaysHandleSupSub)||g\u0026\u0026g.type===\"operatorname\"\u0026\u0026g.alwaysHandleSupSub\u0026\u0026(g.limits||t.style===I.DISPLAY)?d=\"munder\":d=\"msub\"}else{var o=s.base;o\u0026\u0026o.type===\"op\"\u0026\u0026o.limits\u0026\u0026(t.style===I.DISPLAY||o.alwaysHandleSupSub)||o\u0026\u0026o.type===\"operatorname\"\u0026\u0026o.alwaysHandleSupSub\u0026\u0026(o.limits||t.style===I.DISPLAY)?d=\"mover\":d=\"msup\"}return new R.MathNode(d,c)}}),Qe({type:\"atom\",htmlBuilder:function(s,t){return b.mathsym(s.text,s.mode,t,[\"m\"+s.family])},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mo\",[fe(s.text,s.mode)]);if(s.family===\"bin\"){var l=us(s,t);l===\"bold-italic\"\u0026\u0026n.setAttribute(\"mathvariant\",l)}else s.family===\"punct\"?n.setAttribute(\"separator\",\"true\"):(s.family===\"open\"||s.family===\"close\")\u0026\u0026n.setAttribute(\"stretchy\",\"false\");return n}});var nn={mi:\"italic\",mn:\"normal\",mtext:\"normal\"};Qe({type:\"mathord\",htmlBuilder:function(s,t){return b.makeOrd(s,t,\"mathord\")},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mi\",[fe(s.text,s.mode,t)]),l=us(s,t)||\"italic\";return l!==nn[n.type]\u0026\u0026n.setAttribute(\"mathvariant\",l),n}}),Qe({type:\"textord\",htmlBuilder:function(s,t){return b.makeOrd(s,t,\"textord\")},mathmlBuilder:function(s,t){var n=fe(s.text,s.mode,t),l=us(s,t)||\"normal\",i;return s.mode===\"text\"?i=new R.MathNode(\"mtext\",[n]):/[0-9]/.test(s.text)?i=new R.MathNode(\"mn\",[n]):s.text===\"\\\\prime\"?i=new R.MathNode(\"mo\",[n]):i=new R.MathNode(\"mi\",[n]),l!==nn[i.type]\u0026\u0026i.setAttribute(\"mathvariant\",l),i}});var Ds={\"\\\\nobreak\":\"nobreak\",\"\\\\allowbreak\":\"allowbreak\"},Cs={\" \":{},\"\\\\ \":{},\"~\":{className:\"nobreak\"},\"\\\\space\":{},\"\\\\nobreakspace\":{className:\"nobreak\"}};Qe({type:\"spacing\",htmlBuilder:function(s,t){if(Cs.hasOwnProperty(s.text)){var n=Cs[s.text].className||\"\";if(s.mode===\"text\"){var l=b.makeOrd(s,t,\"textord\");return l.classes.push(n),l}else return b.makeSpan([\"mspace\",n],[b.mathsym(s.text,s.mode,t)],t)}else{if(Ds.hasOwnProperty(s.text))return b.makeSpan([\"mspace\",Ds[s.text]],[],t);throw new A('Unknown type of space \"'+s.text+'\"')}},mathmlBuilder:function(s,t){var n;if(Cs.hasOwnProperty(s.text))n=new R.MathNode(\"mtext\",[new R.TextNode(\"\\xA0\")]);else{if(Ds.hasOwnProperty(s.text))return new R.MathNode(\"mspace\");throw new A('Unknown type of space \"'+s.text+'\"')}return n}});var ln=function(){var s=new R.MathNode(\"mtd\",[]);return s.setAttribute(\"width\",\"50%\"),s};Qe({type:\"tag\",mathmlBuilder:function(s,t){var n=new R.MathNode(\"mtable\",[new R.MathNode(\"mtr\",[ln(),new R.MathNode(\"mtd\",[_e(s.body,t)]),ln(),new R.MathNode(\"mtd\",[_e(s.tag,t)])])]);return n.setAttribute(\"width\",\"100%\"),n}});var rn={\"\\\\text\":void 0,\"\\\\textrm\":\"textrm\",\"\\\\textsf\":\"textsf\",\"\\\\texttt\":\"texttt\",\"\\\\textnormal\":\"textrm\"},mn={\"\\\\textbf\":\"textbf\",\"\\\\textmd\":\"textmd\"},bi={\"\\\\textit\":\"textit\",\"\\\\textup\":\"textup\"},cn=function(s,t){var n=s.font;return n?rn[n]?t.withTextFontFamily(rn[n]):mn[n]?t.withTextFontWeight(mn[n]):t.withTextFontShape(bi[n]):t};T({type:\"text\",names:[\"\\\\text\",\"\\\\textrm\",\"\\\\textsf\",\"\\\\texttt\",\"\\\\textnormal\",\"\\\\textbf\",\"\\\\textmd\",\"\\\\textit\",\"\\\\textup\"],props:{numArgs:1,argTypes:[\"text\"],allowedInArgument:!0,allowedInText:!0},handler:function(s,t){var n=s.parser,l=s.funcName,i=t[0];return{type:\"text\",mode:n.mode,body:se(i),font:l}},htmlBuilder:function(s,t){var n=cn(s,t),l=le(s.body,n,!0);return b.makeSpan([\"mord\",\"text\"],l,n)},mathmlBuilder:function(s,t){var n=cn(s,t);return _e(s.body,n)}}),T({type:\"underline\",names:[\"\\\\underline\"],props:{numArgs:1,allowedInText:!0},handler:function(s,t){var n=s.parser;return{type:\"underline\",mode:n.mode,body:t[0]}},htmlBuilder:function(s,t){var n=_(s.body,t),l=b.makeLineSpan(\"underline-line\",t),i=t.fontMetrics().defaultRuleThickness,c=b.makeVList({positionType:\"top\",positionData:n.height,children:[{type:\"kern\",size:i},{type:\"elem\",elem:l},{type:\"kern\",size:3*i},{type:\"elem\",elem:n}]},t);return b.makeSpan([\"mord\",\"underline\"],[c],t)},mathmlBuilder:function(s,t){var n=new R.MathNode(\"mo\",[new R.TextNode(\"\\u203E\")]);n.setAttribute(\"stretchy\",\"true\");var l=new R.MathNode(\"munder\",[X(s.body,t),n]);return l.setAttribute(\"accentunder\",\"true\"),l}}),T({type:\"vcenter\",names:[\"\\\\vcenter\"],props:{numArgs:1,argTypes:[\"original\"],allowedInText:!1},handler:function(s,t){var n=s.parser;return{type:\"vcenter\",mode:n.mode,body:t[0]}},htmlBuilder:function(s,t){var n=_(s.body,t),l=t.fontMetrics().axisHeight,i=.5*(n.height-l-(n.depth+l));return b.makeVList({positionType:\"shift\",positionData:i,children:[{type:\"elem\",elem:n}]},t)},mathmlBuilder:function(s,t){return new R.MathNode(\"mpadded\",[X(s.body,t)],[\"vcenter\"])}}),T({type:\"verb\",names:[\"\\\\verb\"],props:{numArgs:0,allowedInText:!0},handler:function(s,t,n){throw new A(\"\\\\verb ended by end of line instead of matching delimiter\")},htmlBuilder:function(s,t){for(var n=hn(s),l=[],i=t.havingStyle(t.style.text()),c=0;c\u003cn.length;c++){var d=n[c];d===\"~\"\u0026\u0026(d=\"\\\\textasciitilde\"),l.push(b.makeSymbol(d,\"Typewriter-Regular\",s.mode,i,[\"mord\",\"texttt\"]))}return b.makeSpan([\"mord\",\"text\"].concat(i.sizingClasses(t)),b.tryCombineChars(l),i)},mathmlBuilder:function(s,t){var n=new R.TextNode(hn(s)),l=new R.MathNode(\"mtext\",[n]);return l.setAttribute(\"mathvariant\",\"monospace\"),l}});var hn=function(s){return s.body.replace(/ /g,s.star?\"\\u2423\":\"\\xA0\")},xi=ot,Ue=xi,dn=`[ \\r\n\t]`,wi=\"\\\\\\\\[a-zA-Z@]+\",ki=\"\\\\\\\\[^\\uD800-\\uDFFF]\",zi=\"(\"+wi+\")\"+dn+\"*\",Mi=`\\\\\\\\(\n|[ \\r\t]+\n?)[ \\r\t]*`,Es=\"[\\u0300-\\u036F]\",Ri=new RegExp(Es+\"+$\"),Ai=\"(\"+dn+\"+)|\"+(Mi+\"|\")+\"([!-\\\\[\\\\]-\\u2027\\u202A-\\uD7FF\\uF900-\\uFFFF]\"+(Es+\"*\")+\"|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]\"+(Es+\"*\")+\"|\\\\\\\\verb\\\\*([^]).*?\\\\4|\\\\\\\\verb([^*a-zA-Z]).*?\\\\5\"+(\"|\"+zi)+(\"|\"+ki+\")\"),pn=function(){function m(t,n){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=t,this.settings=n,this.tokenRegex=new RegExp(Ai,\"g\"),this.catcodes={\"%\":14,\"~\":13}}var s=m.prototype;return s.setCatcode=function(n,l){this.catcodes[n]=l},s.lex=function(){var n=this.input,l=this.tokenRegex.lastIndex;if(l===n.length)return new Ve(\"EOF\",new ke(this,l,l));var i=this.tokenRegex.exec(n);if(i===null||i.index!==l)throw new A(\"Unexpected character: '\"+n[l]+\"'\",new Ve(n[l],new ke(this,l,l+1)));var c=i[6]||i[3]||(i[2]?\"\\\\ \":\" \");if(this.catcodes[c]===14){var d=n.indexOf(`\n`,this.tokenRegex.lastIndex);return d===-1?(this.tokenRegex.lastIndex=n.length,this.settings.reportNonstrict(\"commentAtEnd\",\"% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)\")):this.tokenRegex.lastIndex=d+1,this.lex()}return new Ve(c,new ke(this,l,this.tokenRegex.lastIndex))},m}(),Si=function(){function m(t,n){t===void 0\u0026\u0026(t={}),n===void 0\u0026\u0026(n={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=n,this.builtins=t,this.undefStack=[]}var s=m.prototype;return s.beginGroup=function(){this.undefStack.push({})},s.endGroup=function(){if(this.undefStack.length===0)throw new A(\"Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug\");var n=this.undefStack.pop();for(var l in n)n.hasOwnProperty(l)\u0026\u0026(n[l]==null?delete this.current[l]:this.current[l]=n[l])},s.endGroups=function(){for(;this.undefStack.length\u003e0;)this.endGroup()},s.has=function(n){return this.current.hasOwnProperty(n)||this.builtins.hasOwnProperty(n)},s.get=function(n){return this.current.hasOwnProperty(n)?this.current[n]:this.builtins[n]},s.set=function(n,l,i){if(i===void 0\u0026\u0026(i=!1),i){for(var c=0;c\u003cthis.undefStack.length;c++)delete this.undefStack[c][n];this.undefStack.length\u003e0\u0026\u0026(this.undefStack[this.undefStack.length-1][n]=l)}else{var d=this.undefStack[this.undefStack.length-1];d\u0026\u0026!d.hasOwnProperty(n)\u0026\u0026(d[n]=this.current[n])}l==null?delete this.current[n]:this.current[n]=l},m}(),Li=Pt,Bi=Li;u(\"\\\\noexpand\",function(m){var s=m.popToken();return m.isExpandable(s.text)\u0026\u0026(s.noexpand=!0,s.treatAsRelax=!0),{tokens:[s],numArgs:0}}),u(\"\\\\expandafter\",function(m){var s=m.popToken();return m.expandOnce(!0),{tokens:[s],numArgs:0}}),u(\"\\\\@firstoftwo\",function(m){var s=m.consumeArgs(2);return{tokens:s[0],numArgs:0}}),u(\"\\\\@secondoftwo\",function(m){var s=m.consumeArgs(2);return{tokens:s[1],numArgs:0}}),u(\"\\\\@ifnextchar\",function(m){var s=m.consumeArgs(3);m.consumeSpaces();var t=m.future();return s[0].length===1\u0026\u0026s[0][0].text===t.text?{tokens:s[1],numArgs:0}:{tokens:s[2],numArgs:0}}),u(\"\\\\@ifstar\",\"\\\\@ifnextchar *{\\\\@firstoftwo{#1}}\"),u(\"\\\\TextOrMath\",function(m){var s=m.consumeArgs(2);return m.mode===\"text\"?{tokens:s[0],numArgs:0}:{tokens:s[1],numArgs:0}});var on={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};u(\"\\\\char\",function(m){var s=m.popToken(),t,n=\"\";if(s.text===\"'\")t=8,s=m.popToken();else if(s.text==='\"')t=16,s=m.popToken();else if(s.text===\"`\")if(s=m.popToken(),s.text[0]===\"\\\\\")n=s.text.charCodeAt(1);else{if(s.text===\"EOF\")throw new A(\"\\\\char` missing argument\");n=s.text.charCodeAt(0)}else t=10;if(t){if(n=on[s.text],n==null||n\u003e=t)throw new A(\"Invalid base-\"+t+\" digit \"+s.text);for(var l;(l=on[m.future().text])!=null\u0026\u0026l\u003ct;)n*=t,n+=l,m.popToken()}return\"\\\\@char{\"+n+\"}\"});var qs=function(s,t,n){var l=s.consumeArg().tokens;if(l.length!==1)throw new A(\"\\\\newcommand's first argument must be a macro name\");var i=l[0].text,c=s.isDefined(i);if(c\u0026\u0026!t)throw new A(\"\\\\newcommand{\"+i+\"} attempting to redefine \"+(i+\"; use \\\\renewcommand\"));if(!c\u0026\u0026!n)throw new A(\"\\\\renewcommand{\"+i+\"} when command \"+i+\" does not yet exist; use \\\\newcommand\");var d=0;if(l=s.consumeArg().tokens,l.length===1\u0026\u0026l[0].text===\"[\"){for(var o=\"\",g=s.expandNextToken();g.text!==\"]\"\u0026\u0026g.text!==\"EOF\";)o+=g.text,g=s.expandNextToken();if(!o.match(/^\\s*[0-9]+\\s*$/))throw new A(\"Invalid number of arguments: \"+o);d=parseInt(o),l=s.consumeArg().tokens}return s.macros.set(i,{tokens:l,numArgs:d}),\"\"};u(\"\\\\newcommand\",function(m){return qs(m,!1,!0)}),u(\"\\\\renewcommand\",function(m){return qs(m,!0,!1)}),u(\"\\\\providecommand\",function(m){return qs(m,!0,!0)}),u(\"\\\\message\",function(m){var s=m.consumeArgs(1)[0];return console.log(s.reverse().map(function(t){return t.text}).join(\"\")),\"\"}),u(\"\\\\errmessage\",function(m){var s=m.consumeArgs(1)[0];return console.error(s.reverse().map(function(t){return t.text}).join(\"\")),\"\"}),u(\"\\\\show\",function(m){var s=m.popToken(),t=s.text;return console.log(s,m.macros.get(t),Ue[t],K.math[t],K.text[t]),\"\"}),u(\"\\\\bgroup\",\"{\"),u(\"\\\\egroup\",\"}\"),u(\"~\",\"\\\\nobreakspace\"),u(\"\\\\lq\",\"`\"),u(\"\\\\rq\",\"'\"),u(\"\\\\aa\",\"\\\\r a\"),u(\"\\\\AA\",\"\\\\r A\"),u(\"\\\\textcopyright\",\"\\\\html@mathml{\\\\textcircled{c}}{\\\\char`\\xA9}\"),u(\"\\\\copyright\",\"\\\\TextOrMath{\\\\textcopyright}{\\\\text{\\\\textcopyright}}\"),u(\"\\\\textregistered\",\"\\\\html@mathml{\\\\textcircled{\\\\scriptsize R}}{\\\\char`\\xAE}\"),u(\"\\u212C\",\"\\\\mathscr{B}\"),u(\"\\u2130\",\"\\\\mathscr{E}\"),u(\"\\u2131\",\"\\\\mathscr{F}\"),u(\"\\u210B\",\"\\\\mathscr{H}\"),u(\"\\u2110\",\"\\\\mathscr{I}\"),u(\"\\u2112\",\"\\\\mathscr{L}\"),u(\"\\u2133\",\"\\\\mathscr{M}\"),u(\"\\u211B\",\"\\\\mathscr{R}\"),u(\"\\u212D\",\"\\\\mathfrak{C}\"),u(\"\\u210C\",\"\\\\mathfrak{H}\"),u(\"\\u2128\",\"\\\\mathfrak{Z}\"),u(\"\\\\Bbbk\",\"\\\\Bbb{k}\"),u(\"\\xB7\",\"\\\\cdotp\"),u(\"\\\\llap\",\"\\\\mathllap{\\\\textrm{#1}}\"),u(\"\\\\rlap\",\"\\\\mathrlap{\\\\textrm{#1}}\"),u(\"\\\\clap\",\"\\\\mathclap{\\\\textrm{#1}}\"),u(\"\\\\mathstrut\",\"\\\\vphantom{(}\"),u(\"\\\\underbar\",\"\\\\underline{\\\\text{#1}}\"),u(\"\\\\not\",'\\\\html@mathml{\\\\mathrel{\\\\mathrlap\\\\@not}}{\\\\char\"338}'),u(\"\\\\neq\",\"\\\\html@mathml{\\\\mathrel{\\\\not=}}{\\\\mathrel{\\\\char`\\u2260}}\"),u(\"\\\\ne\",\"\\\\neq\"),u(\"\\u2260\",\"\\\\neq\"),u(\"\\\\notin\",\"\\\\html@mathml{\\\\mathrel{{\\\\in}\\\\mathllap{/\\\\mskip1mu}}}{\\\\mathrel{\\\\char`\\u2209}}\"),u(\"\\u2209\",\"\\\\notin\"),u(\"\\u2258\",\"\\\\html@mathml{\\\\mathrel{=\\\\kern{-1em}\\\\raisebox{0.4em}{$\\\\scriptsize\\\\frown$}}}{\\\\mathrel{\\\\char`\\u2258}}\"),u(\"\\u2259\",\"\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\wedge}{=}}{\\\\mathrel{\\\\char`\\u2258}}\"),u(\"\\u225A\",\"\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\vee}{=}}{\\\\mathrel{\\\\char`\\u225A}}\"),u(\"\\u225B\",\"\\\\html@mathml{\\\\stackrel{\\\\scriptsize\\\\star}{=}}{\\\\mathrel{\\\\char`\\u225B}}\"),u(\"\\u225D\",\"\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\mathrm{def}}{=}}{\\\\mathrel{\\\\char`\\u225D}}\"),u(\"\\u225E\",\"\\\\html@mathml{\\\\stackrel{\\\\tiny\\\\mathrm{m}}{=}}{\\\\mathrel{\\\\char`\\u225E}}\"),u(\"\\u225F\",\"\\\\html@mathml{\\\\stackrel{\\\\tiny?}{=}}{\\\\mathrel{\\\\char`\\u225F}}\"),u(\"\\u27C2\",\"\\\\perp\"),u(\"\\u203C\",\"\\\\mathclose{!\\\\mkern-0.8mu!}\"),u(\"\\u220C\",\"\\\\notni\"),u(\"\\u231C\",\"\\\\ulcorner\"),u(\"\\u231D\",\"\\\\urcorner\"),u(\"\\u231E\",\"\\\\llcorner\"),u(\"\\u231F\",\"\\\\lrcorner\"),u(\"\\xA9\",\"\\\\copyright\"),u(\"\\xAE\",\"\\\\textregistered\"),u(\"\\uFE0F\",\"\\\\textregistered\"),u(\"\\\\ulcorner\",'\\\\html@mathml{\\\\@ulcorner}{\\\\mathop{\\\\char\"231c}}'),u(\"\\\\urcorner\",'\\\\html@mathml{\\\\@urcorner}{\\\\mathop{\\\\char\"231d}}'),u(\"\\\\llcorner\",'\\\\html@mathml{\\\\@llcorner}{\\\\mathop{\\\\char\"231e}}'),u(\"\\\\lrcorner\",'\\\\html@mathml{\\\\@lrcorner}{\\\\mathop{\\\\char\"231f}}'),u(\"\\\\vdots\",\"\\\\mathord{\\\\varvdots\\\\rule{0pt}{15pt}}\"),u(\"\\u22EE\",\"\\\\vdots\"),u(\"\\\\varGamma\",\"\\\\mathit{\\\\Gamma}\"),u(\"\\\\varDelta\",\"\\\\mathit{\\\\Delta}\"),u(\"\\\\varTheta\",\"\\\\mathit{\\\\Theta}\"),u(\"\\\\varLambda\",\"\\\\mathit{\\\\Lambda}\"),u(\"\\\\varXi\",\"\\\\mathit{\\\\Xi}\"),u(\"\\\\varPi\",\"\\\\mathit{\\\\Pi}\"),u(\"\\\\varSigma\",\"\\\\mathit{\\\\Sigma}\"),u(\"\\\\varUpsilon\",\"\\\\mathit{\\\\Upsilon}\"),u(\"\\\\varPhi\",\"\\\\mathit{\\\\Phi}\"),u(\"\\\\varPsi\",\"\\\\mathit{\\\\Psi}\"),u(\"\\\\varOmega\",\"\\\\mathit{\\\\Omega}\"),u(\"\\\\substack\",\"\\\\begin{subarray}{c}#1\\\\end{subarray}\"),u(\"\\\\colon\",\"\\\\nobreak\\\\mskip2mu\\\\mathpunct{}\\\\mathchoice{\\\\mkern-3mu}{\\\\mkern-3mu}{}{}{:}\\\\mskip6mu\\\\relax\"),u(\"\\\\boxed\",\"\\\\fbox{$\\\\displaystyle{#1}$}\"),u(\"\\\\iff\",\"\\\\DOTSB\\\\;\\\\Longleftrightarrow\\\\;\"),u(\"\\\\implies\",\"\\\\DOTSB\\\\;\\\\Longrightarrow\\\\;\"),u(\"\\\\impliedby\",\"\\\\DOTSB\\\\;\\\\Longleftarrow\\\\;\");var un={\",\":\"\\\\dotsc\",\"\\\\not\":\"\\\\dotsb\",\"+\":\"\\\\dotsb\",\"=\":\"\\\\dotsb\",\"\u003c\":\"\\\\dotsb\",\"\u003e\":\"\\\\dotsb\",\"-\":\"\\\\dotsb\",\"*\":\"\\\\dotsb\",\":\":\"\\\\dotsb\",\"\\\\DOTSB\":\"\\\\dotsb\",\"\\\\coprod\":\"\\\\dotsb\",\"\\\\bigvee\":\"\\\\dotsb\",\"\\\\bigwedge\":\"\\\\dotsb\",\"\\\\biguplus\":\"\\\\dotsb\",\"\\\\bigcap\":\"\\\\dotsb\",\"\\\\bigcup\":\"\\\\dotsb\",\"\\\\prod\":\"\\\\dotsb\",\"\\\\sum\":\"\\\\dotsb\",\"\\\\bigotimes\":\"\\\\dotsb\",\"\\\\bigoplus\":\"\\\\dotsb\",\"\\\\bigodot\":\"\\\\dotsb\",\"\\\\bigsqcup\":\"\\\\dotsb\",\"\\\\And\":\"\\\\dotsb\",\"\\\\longrightarrow\":\"\\\\dotsb\",\"\\\\Longrightarrow\":\"\\\\dotsb\",\"\\\\longleftarrow\":\"\\\\dotsb\",\"\\\\Longleftarrow\":\"\\\\dotsb\",\"\\\\longleftrightarrow\":\"\\\\dotsb\",\"\\\\Longleftrightarrow\":\"\\\\dotsb\",\"\\\\mapsto\":\"\\\\dotsb\",\"\\\\longmapsto\":\"\\\\dotsb\",\"\\\\hookrightarrow\":\"\\\\dotsb\",\"\\\\doteq\":\"\\\\dotsb\",\"\\\\mathbin\":\"\\\\dotsb\",\"\\\\mathrel\":\"\\\\dotsb\",\"\\\\relbar\":\"\\\\dotsb\",\"\\\\Relbar\":\"\\\\dotsb\",\"\\\\xrightarrow\":\"\\\\dotsb\",\"\\\\xleftarrow\":\"\\\\dotsb\",\"\\\\DOTSI\":\"\\\\dotsi\",\"\\\\int\":\"\\\\dotsi\",\"\\\\oint\":\"\\\\dotsi\",\"\\\\iint\":\"\\\\dotsi\",\"\\\\iiint\":\"\\\\dotsi\",\"\\\\iiiint\":\"\\\\dotsi\",\"\\\\idotsint\":\"\\\\dotsi\",\"\\\\DOTSX\":\"\\\\dotsx\"};u(\"\\\\dots\",function(m){var s=\"\\\\dotso\",t=m.expandAfterFuture().text;return t in un?s=un[t]:(t.slice(0,4)===\"\\\\not\"||t in K.math\u0026\u0026O.contains([\"bin\",\"rel\"],K.math[t].group))\u0026\u0026(s=\"\\\\dotsb\"),s});var Is={\")\":!0,\"]\":!0,\"\\\\rbrack\":!0,\"\\\\}\":!0,\"\\\\rbrace\":!0,\"\\\\rangle\":!0,\"\\\\rceil\":!0,\"\\\\rfloor\":!0,\"\\\\rgroup\":!0,\"\\\\rmoustache\":!0,\"\\\\right\":!0,\"\\\\bigr\":!0,\"\\\\biggr\":!0,\"\\\\Bigr\":!0,\"\\\\Biggr\":!0,$:!0,\";\":!0,\".\":!0,\",\":!0};u(\"\\\\dotso\",function(m){var s=m.future().text;return s in Is?\"\\\\ldots\\\\,\":\"\\\\ldots\"}),u(\"\\\\dotsc\",function(m){var s=m.future().text;return s in Is\u0026\u0026s!==\",\"?\"\\\\ldots\\\\,\":\"\\\\ldots\"}),u(\"\\\\cdots\",function(m){var s=m.future().text;return s in Is?\"\\\\@cdots\\\\,\":\"\\\\@cdots\"}),u(\"\\\\dotsb\",\"\\\\cdots\"),u(\"\\\\dotsm\",\"\\\\cdots\"),u(\"\\\\dotsi\",\"\\\\!\\\\cdots\"),u(\"\\\\dotsx\",\"\\\\ldots\\\\,\"),u(\"\\\\DOTSI\",\"\\\\relax\"),u(\"\\\\DOTSB\",\"\\\\relax\"),u(\"\\\\DOTSX\",\"\\\\relax\"),u(\"\\\\tmspace\",\"\\\\TextOrMath{\\\\kern#1#3}{\\\\mskip#1#2}\\\\relax\"),u(\"\\\\,\",\"\\\\tmspace+{3mu}{.1667em}\"),u(\"\\\\thinspace\",\"\\\\,\"),u(\"\\\\\u003e\",\"\\\\mskip{4mu}\"),u(\"\\\\:\",\"\\\\tmspace+{4mu}{.2222em}\"),u(\"\\\\medspace\",\"\\\\:\"),u(\"\\\\;\",\"\\\\tmspace+{5mu}{.2777em}\"),u(\"\\\\thickspace\",\"\\\\;\"),u(\"\\\\!\",\"\\\\tmspace-{3mu}{.1667em}\"),u(\"\\\\negthinspace\",\"\\\\!\"),u(\"\\\\negmedspace\",\"\\\\tmspace-{4mu}{.2222em}\"),u(\"\\\\negthickspace\",\"\\\\tmspace-{5mu}{.277em}\"),u(\"\\\\enspace\",\"\\\\kern.5em \"),u(\"\\\\enskip\",\"\\\\hskip.5em\\\\relax\"),u(\"\\\\quad\",\"\\\\hskip1em\\\\relax\"),u(\"\\\\qquad\",\"\\\\hskip2em\\\\relax\"),u(\"\\\\tag\",\"\\\\@ifstar\\\\tag@literal\\\\tag@paren\"),u(\"\\\\tag@paren\",\"\\\\tag@literal{({#1})}\"),u(\"\\\\tag@literal\",function(m){if(m.macros.get(\"\\\\df@tag\"))throw new A(\"Multiple \\\\tag\");return\"\\\\gdef\\\\df@tag{\\\\text{#1}}\"}),u(\"\\\\bmod\",\"\\\\mathchoice{\\\\mskip1mu}{\\\\mskip1mu}{\\\\mskip5mu}{\\\\mskip5mu}\\\\mathbin{\\\\rm mod}\\\\mathchoice{\\\\mskip1mu}{\\\\mskip1mu}{\\\\mskip5mu}{\\\\mskip5mu}\"),u(\"\\\\pod\",\"\\\\allowbreak\\\\mathchoice{\\\\mkern18mu}{\\\\mkern8mu}{\\\\mkern8mu}{\\\\mkern8mu}(#1)\"),u(\"\\\\pmod\",\"\\\\pod{{\\\\rm mod}\\\\mkern6mu#1}\"),u(\"\\\\mod\",\"\\\\allowbreak\\\\mathchoice{\\\\mkern18mu}{\\\\mkern12mu}{\\\\mkern12mu}{\\\\mkern12mu}{\\\\rm mod}\\\\,\\\\,#1\"),u(\"\\\\newline\",\"\\\\\\\\\\\\relax\"),u(\"\\\\TeX\",\"\\\\textrm{\\\\html@mathml{T\\\\kern-.1667em\\\\raisebox{-.5ex}{E}\\\\kern-.125emX}{TeX}}\");var gn=L(Ae[\"Main-Regular\"][\"T\".charCodeAt(0)][1]-.7*Ae[\"Main-Regular\"][\"A\".charCodeAt(0)][1]);u(\"\\\\LaTeX\",\"\\\\textrm{\\\\html@mathml{\"+(\"L\\\\kern-.36em\\\\raisebox{\"+gn+\"}{\\\\scriptstyle A}\")+\"\\\\kern-.15em\\\\TeX}{LaTeX}}\"),u(\"\\\\KaTeX\",\"\\\\textrm{\\\\html@mathml{\"+(\"K\\\\kern-.17em\\\\raisebox{\"+gn+\"}{\\\\scriptstyle A}\")+\"\\\\kern-.15em\\\\TeX}{KaTeX}}\"),u(\"\\\\hspace\",\"\\\\@ifstar\\\\@hspacer\\\\@hspace\"),u(\"\\\\@hspace\",\"\\\\hskip #1\\\\relax\"),u(\"\\\\@hspacer\",\"\\\\rule{0pt}{0pt}\\\\hskip #1\\\\relax\"),u(\"\\\\ordinarycolon\",\":\"),u(\"\\\\vcentcolon\",\"\\\\mathrel{\\\\mathop\\\\ordinarycolon}\"),u(\"\\\\dblcolon\",'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-.9mu}\\\\vcentcolon}}{\\\\mathop{\\\\char\"2237}}'),u(\"\\\\coloneqq\",'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}=}}{\\\\mathop{\\\\char\"2254}}'),u(\"\\\\Coloneqq\",'\\\\html@mathml{\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}=}}{\\\\mathop{\\\\char\"2237\\\\char\"3d}}'),u(\"\\\\coloneq\",'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\mathrel{-}}}{\\\\mathop{\\\\char\"3a\\\\char\"2212}}'),u(\"\\\\Coloneq\",'\\\\html@mathml{\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\mathrel{-}}}{\\\\mathop{\\\\char\"2237\\\\char\"2212}}'),u(\"\\\\eqqcolon\",'\\\\html@mathml{\\\\mathrel{=\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}}{\\\\mathop{\\\\char\"2255}}'),u(\"\\\\Eqqcolon\",'\\\\html@mathml{\\\\mathrel{=\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}}{\\\\mathop{\\\\char\"3d\\\\char\"2237}}'),u(\"\\\\eqcolon\",'\\\\html@mathml{\\\\mathrel{\\\\mathrel{-}\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}}{\\\\mathop{\\\\char\"2239}}'),u(\"\\\\Eqcolon\",'\\\\html@mathml{\\\\mathrel{\\\\mathrel{-}\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}}{\\\\mathop{\\\\char\"2212\\\\char\"2237}}'),u(\"\\\\colonapprox\",'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\approx}}{\\\\mathop{\\\\char\"3a\\\\char\"2248}}'),u(\"\\\\Colonapprox\",'\\\\html@mathml{\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\approx}}{\\\\mathop{\\\\char\"2237\\\\char\"2248}}'),u(\"\\\\colonsim\",'\\\\html@mathml{\\\\mathrel{\\\\vcentcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\sim}}{\\\\mathop{\\\\char\"3a\\\\char\"223c}}'),u(\"\\\\Colonsim\",'\\\\html@mathml{\\\\mathrel{\\\\dblcolon\\\\mathrel{\\\\mkern-1.2mu}\\\\sim}}{\\\\mathop{\\\\char\"2237\\\\char\"223c}}'),u(\"\\u2237\",\"\\\\dblcolon\"),u(\"\\u2239\",\"\\\\eqcolon\"),u(\"\\u2254\",\"\\\\coloneqq\"),u(\"\\u2255\",\"\\\\eqqcolon\"),u(\"\\u2A74\",\"\\\\Coloneqq\"),u(\"\\\\ratio\",\"\\\\vcentcolon\"),u(\"\\\\coloncolon\",\"\\\\dblcolon\"),u(\"\\\\colonequals\",\"\\\\coloneqq\"),u(\"\\\\coloncolonequals\",\"\\\\Coloneqq\"),u(\"\\\\equalscolon\",\"\\\\eqqcolon\"),u(\"\\\\equalscoloncolon\",\"\\\\Eqqcolon\"),u(\"\\\\colonminus\",\"\\\\coloneq\"),u(\"\\\\coloncolonminus\",\"\\\\Coloneq\"),u(\"\\\\minuscolon\",\"\\\\eqcolon\"),u(\"\\\\minuscoloncolon\",\"\\\\Eqcolon\"),u(\"\\\\coloncolonapprox\",\"\\\\Colonapprox\"),u(\"\\\\coloncolonsim\",\"\\\\Colonsim\"),u(\"\\\\simcolon\",\"\\\\mathrel{\\\\sim\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}\"),u(\"\\\\simcoloncolon\",\"\\\\mathrel{\\\\sim\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}\"),u(\"\\\\approxcolon\",\"\\\\mathrel{\\\\approx\\\\mathrel{\\\\mkern-1.2mu}\\\\vcentcolon}\"),u(\"\\\\approxcoloncolon\",\"\\\\mathrel{\\\\approx\\\\mathrel{\\\\mkern-1.2mu}\\\\dblcolon}\"),u(\"\\\\notni\",\"\\\\html@mathml{\\\\not\\\\ni}{\\\\mathrel{\\\\char`\\u220C}}\"),u(\"\\\\limsup\",\"\\\\DOTSB\\\\operatorname*{lim\\\\,sup}\"),u(\"\\\\liminf\",\"\\\\DOTSB\\\\operatorname*{lim\\\\,inf}\"),u(\"\\\\injlim\",\"\\\\DOTSB\\\\operatorname*{inj\\\\,lim}\"),u(\"\\\\projlim\",\"\\\\DOTSB\\\\operatorname*{proj\\\\,lim}\"),u(\"\\\\varlimsup\",\"\\\\DOTSB\\\\operatorname*{\\\\overline{lim}}\"),u(\"\\\\varliminf\",\"\\\\DOTSB\\\\operatorname*{\\\\underline{lim}}\"),u(\"\\\\varinjlim\",\"\\\\DOTSB\\\\operatorname*{\\\\underrightarrow{lim}}\"),u(\"\\\\varprojlim\",\"\\\\DOTSB\\\\operatorname*{\\\\underleftarrow{lim}}\"),u(\"\\\\gvertneqq\",\"\\\\html@mathml{\\\\@gvertneqq}{\\u2269}\"),u(\"\\\\lvertneqq\",\"\\\\html@mathml{\\\\@lvertneqq}{\\u2268}\"),u(\"\\\\ngeqq\",\"\\\\html@mathml{\\\\@ngeqq}{\\u2271}\"),u(\"\\\\ngeqslant\",\"\\\\html@mathml{\\\\@ngeqslant}{\\u2271}\"),u(\"\\\\nleqq\",\"\\\\html@mathml{\\\\@nleqq}{\\u2270}\"),u(\"\\\\nleqslant\",\"\\\\html@mathml{\\\\@nleqslant}{\\u2270}\"),u(\"\\\\nshortmid\",\"\\\\html@mathml{\\\\@nshortmid}{\\u2224}\"),u(\"\\\\nshortparallel\",\"\\\\html@mathml{\\\\@nshortparallel}{\\u2226}\"),u(\"\\\\nsubseteqq\",\"\\\\html@mathml{\\\\@nsubseteqq}{\\u2288}\"),u(\"\\\\nsupseteqq\",\"\\\\html@mathml{\\\\@nsupseteqq}{\\u2289}\"),u(\"\\\\varsubsetneq\",\"\\\\html@mathml{\\\\@varsubsetneq}{\\u228A}\"),u(\"\\\\varsubsetneqq\",\"\\\\html@mathml{\\\\@varsubsetneqq}{\\u2ACB}\"),u(\"\\\\varsupsetneq\",\"\\\\html@mathml{\\\\@varsupsetneq}{\\u228B}\"),u(\"\\\\varsupsetneqq\",\"\\\\html@mathml{\\\\@varsupsetneqq}{\\u2ACC}\"),u(\"\\\\imath\",\"\\\\html@mathml{\\\\@imath}{\\u0131}\"),u(\"\\\\jmath\",\"\\\\html@mathml{\\\\@jmath}{\\u0237}\"),u(\"\\\\llbracket\",\"\\\\html@mathml{\\\\mathopen{[\\\\mkern-3.2mu[}}{\\\\mathopen{\\\\char`\\u27E6}}\"),u(\"\\\\rrbracket\",\"\\\\html@mathml{\\\\mathclose{]\\\\mkern-3.2mu]}}{\\\\mathclose{\\\\char`\\u27E7}}\"),u(\"\\u27E6\",\"\\\\llbracket\"),u(\"\\u27E7\",\"\\\\rrbracket\"),u(\"\\\\lBrace\",\"\\\\html@mathml{\\\\mathopen{\\\\{\\\\mkern-3.2mu[}}{\\\\mathopen{\\\\char`\\u2983}}\"),u(\"\\\\rBrace\",\"\\\\html@mathml{\\\\mathclose{]\\\\mkern-3.2mu\\\\}}}{\\\\mathclose{\\\\char`\\u2984}}\"),u(\"\\u2983\",\"\\\\lBrace\"),u(\"\\u2984\",\"\\\\rBrace\"),u(\"\\\\minuso\",\"\\\\mathbin{\\\\html@mathml{{\\\\mathrlap{\\\\mathchoice{\\\\kern{0.145em}}{\\\\kern{0.145em}}{\\\\kern{0.1015em}}{\\\\kern{0.0725em}}\\\\circ}{-}}}{\\\\char`\\u29B5}}\"),u(\"\\u29B5\",\"\\\\minuso\"),u(\"\\\\darr\",\"\\\\downarrow\"),u(\"\\\\dArr\",\"\\\\Downarrow\"),u(\"\\\\Darr\",\"\\\\Downarrow\"),u(\"\\\\lang\",\"\\\\langle\"),u(\"\\\\rang\",\"\\\\rangle\"),u(\"\\\\uarr\",\"\\\\uparrow\"),u(\"\\\\uArr\",\"\\\\Uparrow\"),u(\"\\\\Uarr\",\"\\\\Uparrow\"),u(\"\\\\N\",\"\\\\mathbb{N}\"),u(\"\\\\R\",\"\\\\mathbb{R}\"),u(\"\\\\Z\",\"\\\\mathbb{Z}\"),u(\"\\\\alef\",\"\\\\aleph\"),u(\"\\\\alefsym\",\"\\\\aleph\"),u(\"\\\\Alpha\",\"\\\\mathrm{A}\"),u(\"\\\\Beta\",\"\\\\mathrm{B}\"),u(\"\\\\bull\",\"\\\\bullet\"),u(\"\\\\Chi\",\"\\\\mathrm{X}\"),u(\"\\\\clubs\",\"\\\\clubsuit\"),u(\"\\\\cnums\",\"\\\\mathbb{C}\"),u(\"\\\\Complex\",\"\\\\mathbb{C}\"),u(\"\\\\Dagger\",\"\\\\ddagger\"),u(\"\\\\diamonds\",\"\\\\diamondsuit\"),u(\"\\\\empty\",\"\\\\emptyset\"),u(\"\\\\Epsilon\",\"\\\\mathrm{E}\"),u(\"\\\\Eta\",\"\\\\mathrm{H}\"),u(\"\\\\exist\",\"\\\\exists\"),u(\"\\\\harr\",\"\\\\leftrightarrow\"),u(\"\\\\hArr\",\"\\\\Leftrightarrow\"),u(\"\\\\Harr\",\"\\\\Leftrightarrow\"),u(\"\\\\hearts\",\"\\\\heartsuit\"),u(\"\\\\image\",\"\\\\Im\"),u(\"\\\\infin\",\"\\\\infty\"),u(\"\\\\Iota\",\"\\\\mathrm{I}\"),u(\"\\\\isin\",\"\\\\in\"),u(\"\\\\Kappa\",\"\\\\mathrm{K}\"),u(\"\\\\larr\",\"\\\\leftarrow\"),u(\"\\\\lArr\",\"\\\\Leftarrow\"),u(\"\\\\Larr\",\"\\\\Leftarrow\"),u(\"\\\\lrarr\",\"\\\\leftrightarrow\"),u(\"\\\\lrArr\",\"\\\\Leftrightarrow\"),u(\"\\\\Lrarr\",\"\\\\Leftrightarrow\"),u(\"\\\\Mu\",\"\\\\mathrm{M}\"),u(\"\\\\natnums\",\"\\\\mathbb{N}\"),u(\"\\\\Nu\",\"\\\\mathrm{N}\"),u(\"\\\\Omicron\",\"\\\\mathrm{O}\"),u(\"\\\\plusmn\",\"\\\\pm\"),u(\"\\\\rarr\",\"\\\\rightarrow\"),u(\"\\\\rArr\",\"\\\\Rightarrow\"),u(\"\\\\Rarr\",\"\\\\Rightarrow\"),u(\"\\\\real\",\"\\\\Re\"),u(\"\\\\reals\",\"\\\\mathbb{R}\"),u(\"\\\\Reals\",\"\\\\mathbb{R}\"),u(\"\\\\Rho\",\"\\\\mathrm{P}\"),u(\"\\\\sdot\",\"\\\\cdot\"),u(\"\\\\sect\",\"\\\\S\"),u(\"\\\\spades\",\"\\\\spadesuit\"),u(\"\\\\sub\",\"\\\\subset\"),u(\"\\\\sube\",\"\\\\subseteq\"),u(\"\\\\supe\",\"\\\\supseteq\"),u(\"\\\\Tau\",\"\\\\mathrm{T}\"),u(\"\\\\thetasym\",\"\\\\vartheta\"),u(\"\\\\weierp\",\"\\\\wp\"),u(\"\\\\Zeta\",\"\\\\mathrm{Z}\"),u(\"\\\\argmin\",\"\\\\DOTSB\\\\operatorname*{arg\\\\,min}\"),u(\"\\\\argmax\",\"\\\\DOTSB\\\\operatorname*{arg\\\\,max}\"),u(\"\\\\plim\",\"\\\\DOTSB\\\\mathop{\\\\operatorname{plim}}\\\\limits\"),u(\"\\\\bra\",\"\\\\mathinner{\\\\langle{#1}|}\"),u(\"\\\\ket\",\"\\\\mathinner{|{#1}\\\\rangle}\"),u(\"\\\\braket\",\"\\\\mathinner{\\\\langle{#1}\\\\rangle}\"),u(\"\\\\Bra\",\"\\\\left\\\\langle#1\\\\right|\"),u(\"\\\\Ket\",\"\\\\left|#1\\\\right\\\\rangle\");var Nn=function(s){return function(t){var n=t.consumeArg().tokens,l=t.consumeArg().tokens,i=t.consumeArg().tokens,c=t.consumeArg().tokens,d=t.macros.get(\"|\"),o=t.macros.get(\"\\\\|\");t.macros.beginGroup();var g=function(k){return function(z){s\u0026\u0026(z.macros.set(\"|\",d),i.length\u0026\u0026z.macros.set(\"\\\\|\",o));var S=k;if(!k\u0026\u0026i.length){var B=z.future();B.text===\"|\"\u0026\u0026(z.popToken(),S=!0)}return{tokens:S?i:l,numArgs:0}}};t.macros.set(\"|\",g(!1)),i.length\u0026\u0026t.macros.set(\"\\\\|\",g(!0));var y=t.consumeArg().tokens,x=t.expandTokens([].concat(c,y,n));return t.macros.endGroup(),{tokens:x.reverse(),numArgs:0}}};u(\"\\\\bra@ket\",Nn(!1)),u(\"\\\\bra@set\",Nn(!0)),u(\"\\\\Braket\",\"\\\\bra@ket{\\\\left\\\\langle}{\\\\,\\\\middle\\\\vert\\\\,}{\\\\,\\\\middle\\\\vert\\\\,}{\\\\right\\\\rangle}\"),u(\"\\\\Set\",\"\\\\bra@set{\\\\left\\\\{\\\\:}{\\\\;\\\\middle\\\\vert\\\\;}{\\\\;\\\\middle\\\\Vert\\\\;}{\\\\:\\\\right\\\\}}\"),u(\"\\\\set\",\"\\\\bra@set{\\\\{\\\\,}{\\\\mid}{}{\\\\,\\\\}}\"),u(\"\\\\angln\",\"{\\\\angl n}\"),u(\"\\\\blue\",\"\\\\textcolor{##6495ed}{#1}\"),u(\"\\\\orange\",\"\\\\textcolor{##ffa500}{#1}\"),u(\"\\\\pink\",\"\\\\textcolor{##ff00af}{#1}\"),u(\"\\\\red\",\"\\\\textcolor{##df0030}{#1}\"),u(\"\\\\green\",\"\\\\textcolor{##28ae7b}{#1}\"),u(\"\\\\gray\",\"\\\\textcolor{gray}{#1}\"),u(\"\\\\purple\",\"\\\\textcolor{##9d38bd}{#1}\"),u(\"\\\\blueA\",\"\\\\textcolor{##ccfaff}{#1}\"),u(\"\\\\blueB\",\"\\\\textcolor{##80f6ff}{#1}\"),u(\"\\\\blueC\",\"\\\\textcolor{##63d9ea}{#1}\"),u(\"\\\\blueD\",\"\\\\textcolor{##11accd}{#1}\"),u(\"\\\\blueE\",\"\\\\textcolor{##0c7f99}{#1}\"),u(\"\\\\tealA\",\"\\\\textcolor{##94fff5}{#1}\"),u(\"\\\\tealB\",\"\\\\textcolor{##26edd5}{#1}\"),u(\"\\\\tealC\",\"\\\\textcolor{##01d1c1}{#1}\"),u(\"\\\\tealD\",\"\\\\textcolor{##01a995}{#1}\"),u(\"\\\\tealE\",\"\\\\textcolor{##208170}{#1}\"),u(\"\\\\greenA\",\"\\\\textcolor{##b6ffb0}{#1}\"),u(\"\\\\greenB\",\"\\\\textcolor{##8af281}{#1}\"),u(\"\\\\greenC\",\"\\\\textcolor{##74cf70}{#1}\"),u(\"\\\\greenD\",\"\\\\textcolor{##1fab54}{#1}\"),u(\"\\\\greenE\",\"\\\\textcolor{##0d923f}{#1}\"),u(\"\\\\goldA\",\"\\\\textcolor{##ffd0a9}{#1}\"),u(\"\\\\goldB\",\"\\\\textcolor{##ffbb71}{#1}\"),u(\"\\\\goldC\",\"\\\\textcolor{##ff9c39}{#1}\"),u(\"\\\\goldD\",\"\\\\textcolor{##e07d10}{#1}\"),u(\"\\\\goldE\",\"\\\\textcolor{##a75a05}{#1}\"),u(\"\\\\redA\",\"\\\\textcolor{##fca9a9}{#1}\"),u(\"\\\\redB\",\"\\\\textcolor{##ff8482}{#1}\"),u(\"\\\\redC\",\"\\\\textcolor{##f9685d}{#1}\"),u(\"\\\\redD\",\"\\\\textcolor{##e84d39}{#1}\"),u(\"\\\\redE\",\"\\\\textcolor{##bc2612}{#1}\"),u(\"\\\\maroonA\",\"\\\\textcolor{##ffbde0}{#1}\"),u(\"\\\\maroonB\",\"\\\\textcolor{##ff92c6}{#1}\"),u(\"\\\\maroonC\",\"\\\\textcolor{##ed5fa6}{#1}\"),u(\"\\\\maroonD\",\"\\\\textcolor{##ca337c}{#1}\"),u(\"\\\\maroonE\",\"\\\\textcolor{##9e034e}{#1}\"),u(\"\\\\purpleA\",\"\\\\textcolor{##ddd7ff}{#1}\"),u(\"\\\\purpleB\",\"\\\\textcolor{##c6b9fc}{#1}\"),u(\"\\\\purpleC\",\"\\\\textcolor{##aa87ff}{#1}\"),u(\"\\\\purpleD\",\"\\\\textcolor{##7854ab}{#1}\"),u(\"\\\\purpleE\",\"\\\\textcolor{##543b78}{#1}\"),u(\"\\\\mintA\",\"\\\\textcolor{##f5f9e8}{#1}\"),u(\"\\\\mintB\",\"\\\\textcolor{##edf2df}{#1}\"),u(\"\\\\mintC\",\"\\\\textcolor{##e0e5cc}{#1}\"),u(\"\\\\grayA\",\"\\\\textcolor{##f6f7f7}{#1}\"),u(\"\\\\grayB\",\"\\\\textcolor{##f0f1f2}{#1}\"),u(\"\\\\grayC\",\"\\\\textcolor{##e3e5e6}{#1}\"),u(\"\\\\grayD\",\"\\\\textcolor{##d6d8da}{#1}\"),u(\"\\\\grayE\",\"\\\\textcolor{##babec2}{#1}\"),u(\"\\\\grayF\",\"\\\\textcolor{##888d93}{#1}\"),u(\"\\\\grayG\",\"\\\\textcolor{##626569}{#1}\"),u(\"\\\\grayH\",\"\\\\textcolor{##3b3e40}{#1}\"),u(\"\\\\grayI\",\"\\\\textcolor{##21242c}{#1}\"),u(\"\\\\kaBlue\",\"\\\\textcolor{##314453}{#1}\"),u(\"\\\\kaGreen\",\"\\\\textcolor{##71B307}{#1}\");var vn={\"^\":!0,_:!0,\"\\\\limits\":!0,\"\\\\nolimits\":!0},Ti=function(){function m(t,n,l){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=n,this.expansionCount=0,this.feed(t),this.macros=new Si(Bi,n.macros),this.mode=l,this.stack=[]}var s=m.prototype;return s.feed=function(n){this.lexer=new pn(n,this.settings)},s.switchMode=function(n){this.mode=n},s.beginGroup=function(){this.macros.beginGroup()},s.endGroup=function(){this.macros.endGroup()},s.endGroups=function(){this.macros.endGroups()},s.future=function(){return this.stack.length===0\u0026\u0026this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]},s.popToken=function(){return this.future(),this.stack.pop()},s.pushToken=function(n){this.stack.push(n)},s.pushTokens=function(n){var l;(l=this.stack).push.apply(l,n)},s.scanArgument=function(n){var l,i,c;if(n){if(this.consumeSpaces(),this.future().text!==\"[\")return null;l=this.popToken();var d=this.consumeArg([\"]\"]);c=d.tokens,i=d.end}else{var o=this.consumeArg();c=o.tokens,l=o.start,i=o.end}return this.pushToken(new Ve(\"EOF\",i.loc)),this.pushTokens(c),l.range(i,\"\")},s.consumeSpaces=function(){for(;;){var n=this.future();if(n.text===\" \")this.stack.pop();else break}},s.consumeArg=function(n){var l=[],i=n\u0026\u0026n.length\u003e0;i||this.consumeSpaces();var c=this.future(),d,o=0,g=0;do{if(d=this.popToken(),l.push(d),d.text===\"{\")++o;else if(d.text===\"}\"){if(--o,o===-1)throw new A(\"Extra }\",d)}else if(d.text===\"EOF\")throw new A(\"Unexpected end of input in a macro argument, expected '\"+(n\u0026\u0026i?n[g]:\"}\")+\"'\",d);if(n\u0026\u0026i)if((o===0||o===1\u0026\u0026n[g]===\"{\")\u0026\u0026d.text===n[g]){if(++g,g===n.length){l.splice(-g,g);break}}else g=0}while(o!==0||i);return c.text===\"{\"\u0026\u0026l[l.length-1].text===\"}\"\u0026\u0026(l.pop(),l.shift()),l.reverse(),{tokens:l,start:c,end:d}},s.consumeArgs=function(n,l){if(l){if(l.length!==n+1)throw new A(\"The length of delimiters doesn't match the number of args!\");for(var i=l[0],c=0;c\u003ci.length;c++){var d=this.popToken();if(i[c]!==d.text)throw new A(\"Use of the macro doesn't match its definition\",d)}}for(var o=[],g=0;g\u003cn;g++)o.push(this.consumeArg(l\u0026\u0026l[g+1]).tokens);return o},s.expandOnce=function(n){var l=this.popToken(),i=l.text,c=l.noexpand?null:this._getExpansion(i);if(c==null||n\u0026\u0026c.unexpandable){if(n\u0026\u0026c==null\u0026\u0026i[0]===\"\\\\\"\u0026\u0026!this.isDefined(i))throw new A(\"Undefined control sequence: \"+i);return this.pushToken(l),!1}if(this.expansionCount++,this.expansionCount\u003ethis.settings.maxExpand)throw new A(\"Too many expansions: infinite loop or need to increase maxExpand setting\");var d=c.tokens,o=this.consumeArgs(c.numArgs,c.delimiters);if(c.numArgs){d=d.slice();for(var g=d.length-1;g\u003e=0;--g){var y=d[g];if(y.text===\"#\"){if(g===0)throw new A(\"Incomplete placeholder at end of macro body\",y);if(y=d[--g],y.text===\"#\")d.splice(g+1,1);else if(/^[1-9]$/.test(y.text)){var x;(x=d).splice.apply(x,[g,2].concat(o[+y.text-1]))}else throw new A(\"Not a valid argument number\",y)}}}return this.pushTokens(d),d.length},s.expandAfterFuture=function(){return this.expandOnce(),this.future()},s.expandNextToken=function(){for(;;)if(this.expandOnce()===!1){var n=this.stack.pop();return n.treatAsRelax\u0026\u0026(n.text=\"\\\\relax\"),n}throw new Error},s.expandMacro=function(n){return this.macros.has(n)?this.expandTokens([new Ve(n)]):void 0},s.expandTokens=function(n){var l=[],i=this.stack.length;for(this.pushTokens(n);this.stack.length\u003ei;)if(this.expandOnce(!0)===!1){var c=this.stack.pop();c.treatAsRelax\u0026\u0026(c.noexpand=!1,c.treatAsRelax=!1),l.push(c)}return l},s.expandMacroAsText=function(n){var l=this.expandMacro(n);return l\u0026\u0026l.map(function(i){return i.text}).join(\"\")},s._getExpansion=function(n){var l=this.macros.get(n);if(l==null)return l;if(n.length===1){var i=this.lexer.catcodes[n];if(i!=null\u0026\u0026i!==13)return}var c=typeof l==\"function\"?l(this):l;if(typeof c==\"string\"){var d=0;if(c.indexOf(\"#\")!==-1)for(var o=c.replace(/##/g,\"\");o.indexOf(\"#\"+(d+1))!==-1;)++d;for(var g=new pn(c,this.settings),y=[],x=g.lex();x.text!==\"EOF\";)y.push(x),x=g.lex();y.reverse();var w={tokens:y,numArgs:d};return w}return c},s.isDefined=function(n){return this.macros.has(n)||Ue.hasOwnProperty(n)||K.math.hasOwnProperty(n)||K.text.hasOwnProperty(n)||vn.hasOwnProperty(n)},s.isExpandable=function(n){var l=this.macros.get(n);return l!=null?typeof l==\"string\"||typeof l==\"function\"||!l.unexpandable:Ue.hasOwnProperty(n)\u0026\u0026!Ue[n].primitive},m}(),yn=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,_a=Object.freeze({\"\\u208A\":\"+\",\"\\u208B\":\"-\",\"\\u208C\":\"=\",\"\\u208D\":\"(\",\"\\u208E\":\")\",\"\\u2080\":\"0\",\"\\u2081\":\"1\",\"\\u2082\":\"2\",\"\\u2083\":\"3\",\"\\u2084\":\"4\",\"\\u2085\":\"5\",\"\\u2086\":\"6\",\"\\u2087\":\"7\",\"\\u2088\":\"8\",\"\\u2089\":\"9\",\"\\u2090\":\"a\",\"\\u2091\":\"e\",\"\\u2095\":\"h\",\"\\u1D62\":\"i\",\"\\u2C7C\":\"j\",\"\\u2096\":\"k\",\"\\u2097\":\"l\",\"\\u2098\":\"m\",\"\\u2099\":\"n\",\"\\u2092\":\"o\",\"\\u209A\":\"p\",\"\\u1D63\":\"r\",\"\\u209B\":\"s\",\"\\u209C\":\"t\",\"\\u1D64\":\"u\",\"\\u1D65\":\"v\",\"\\u2093\":\"x\",\"\\u1D66\":\"\\u03B2\",\"\\u1D67\":\"\\u03B3\",\"\\u1D68\":\"\\u03C1\",\"\\u1D69\":\"\\u03D5\",\"\\u1D6A\":\"\\u03C7\",\"\\u207A\":\"+\",\"\\u207B\":\"-\",\"\\u207C\":\"=\",\"\\u207D\":\"(\",\"\\u207E\":\")\",\"\\u2070\":\"0\",\"\\xB9\":\"1\",\"\\xB2\":\"2\",\"\\xB3\":\"3\",\"\\u2074\":\"4\",\"\\u2075\":\"5\",\"\\u2076\":\"6\",\"\\u2077\":\"7\",\"\\u2078\":\"8\",\"\\u2079\":\"9\",\"\\u1D2C\":\"A\",\"\\u1D2E\":\"B\",\"\\u1D30\":\"D\",\"\\u1D31\":\"E\",\"\\u1D33\":\"G\",\"\\u1D34\":\"H\",\"\\u1D35\":\"I\",\"\\u1D36\":\"J\",\"\\u1D37\":\"K\",\"\\u1D38\":\"L\",\"\\u1D39\":\"M\",\"\\u1D3A\":\"N\",\"\\u1D3C\":\"O\",\"\\u1D3E\":\"P\",\"\\u1D3F\":\"R\",\"\\u1D40\":\"T\",\"\\u1D41\":\"U\",\"\\u2C7D\":\"V\",\"\\u1D42\":\"W\",\"\\u1D43\":\"a\",\"\\u1D47\":\"b\",\"\\u1D9C\":\"c\",\"\\u1D48\":\"d\",\"\\u1D49\":\"e\",\"\\u1DA0\":\"f\",\"\\u1D4D\":\"g\",\\u02B0:\"h\",\"\\u2071\":\"i\",\\u02B2:\"j\",\"\\u1D4F\":\"k\",\\u02E1:\"l\",\"\\u1D50\":\"m\",\\u207F:\"n\",\"\\u1D52\":\"o\",\"\\u1D56\":\"p\",\\u02B3:\"r\",\\u02E2:\"s\",\"\\u1D57\":\"t\",\"\\u1D58\":\"u\",\"\\u1D5B\":\"v\",\\u02B7:\"w\",\\u02E3:\"x\",\\u02B8:\"y\",\"\\u1DBB\":\"z\",\"\\u1D5D\":\"\\u03B2\",\"\\u1D5E\":\"\\u03B3\",\"\\u1D5F\":\"\\u03B4\",\"\\u1D60\":\"\\u03D5\",\"\\u1D61\":\"\\u03C7\",\"\\u1DBF\":\"\\u03B8\"}),Fs={\"\\u0301\":{text:\"\\\\'\",math:\"\\\\acute\"},\"\\u0300\":{text:\"\\\\`\",math:\"\\\\grave\"},\"\\u0308\":{text:'\\\\\"',math:\"\\\\ddot\"},\"\\u0303\":{text:\"\\\\~\",math:\"\\\\tilde\"},\"\\u0304\":{text:\"\\\\=\",math:\"\\\\bar\"},\"\\u0306\":{text:\"\\\\u\",math:\"\\\\breve\"},\"\\u030C\":{text:\"\\\\v\",math:\"\\\\check\"},\"\\u0302\":{text:\"\\\\^\",math:\"\\\\hat\"},\"\\u0307\":{text:\"\\\\.\",math:\"\\\\dot\"},\"\\u030A\":{text:\"\\\\r\",math:\"\\\\mathring\"},\"\\u030B\":{text:\"\\\\H\"},\"\\u0327\":{text:\"\\\\c\"}},fn={\\u00E1:\"a\\u0301\",\\u00E0:\"a\\u0300\",\\u00E4:\"a\\u0308\",\\u01DF:\"a\\u0308\\u0304\",\\u00E3:\"a\\u0303\",\\u0101:\"a\\u0304\",\\u0103:\"a\\u0306\",\\u1EAF:\"a\\u0306\\u0301\",\\u1EB1:\"a\\u0306\\u0300\",\\u1EB5:\"a\\u0306\\u0303\",\\u01CE:\"a\\u030C\",\\u00E2:\"a\\u0302\",\\u1EA5:\"a\\u0302\\u0301\",\\u1EA7:\"a\\u0302\\u0300\",\\u1EAB:\"a\\u0302\\u0303\",\\u0227:\"a\\u0307\",\\u01E1:\"a\\u0307\\u0304\",\\u00E5:\"a\\u030A\",\\u01FB:\"a\\u030A\\u0301\",\\u1E03:\"b\\u0307\",\\u0107:\"c\\u0301\",\\u1E09:\"c\\u0327\\u0301\",\\u010D:\"c\\u030C\",\\u0109:\"c\\u0302\",\\u010B:\"c\\u0307\",\\u00E7:\"c\\u0327\",\\u010F:\"d\\u030C\",\\u1E0B:\"d\\u0307\",\\u1E11:\"d\\u0327\",\\u00E9:\"e\\u0301\",\\u00E8:\"e\\u0300\",\\u00EB:\"e\\u0308\",\\u1EBD:\"e\\u0303\",\\u0113:\"e\\u0304\",\\u1E17:\"e\\u0304\\u0301\",\\u1E15:\"e\\u0304\\u0300\",\\u0115:\"e\\u0306\",\\u1E1D:\"e\\u0327\\u0306\",\\u011B:\"e\\u030C\",\\u00EA:\"e\\u0302\",\\u1EBF:\"e\\u0302\\u0301\",\\u1EC1:\"e\\u0302\\u0300\",\\u1EC5:\"e\\u0302\\u0303\",\\u0117:\"e\\u0307\",\\u0229:\"e\\u0327\",\\u1E1F:\"f\\u0307\",\\u01F5:\"g\\u0301\",\\u1E21:\"g\\u0304\",\\u011F:\"g\\u0306\",\\u01E7:\"g\\u030C\",\\u011D:\"g\\u0302\",\\u0121:\"g\\u0307\",\\u0123:\"g\\u0327\",\\u1E27:\"h\\u0308\",\\u021F:\"h\\u030C\",\\u0125:\"h\\u0302\",\\u1E23:\"h\\u0307\",\\u1E29:\"h\\u0327\",\\u00ED:\"i\\u0301\",\\u00EC:\"i\\u0300\",\\u00EF:\"i\\u0308\",\\u1E2F:\"i\\u0308\\u0301\",\\u0129:\"i\\u0303\",\\u012B:\"i\\u0304\",\\u012D:\"i\\u0306\",\\u01D0:\"i\\u030C\",\\u00EE:\"i\\u0302\",\\u01F0:\"j\\u030C\",\\u0135:\"j\\u0302\",\\u1E31:\"k\\u0301\",\\u01E9:\"k\\u030C\",\\u0137:\"k\\u0327\",\\u013A:\"l\\u0301\",\\u013E:\"l\\u030C\",\\u013C:\"l\\u0327\",\\u1E3F:\"m\\u0301\",\\u1E41:\"m\\u0307\",\\u0144:\"n\\u0301\",\\u01F9:\"n\\u0300\",\\u00F1:\"n\\u0303\",\\u0148:\"n\\u030C\",\\u1E45:\"n\\u0307\",\\u0146:\"n\\u0327\",\\u00F3:\"o\\u0301\",\\u00F2:\"o\\u0300\",\\u00F6:\"o\\u0308\",\\u022B:\"o\\u0308\\u0304\",\\u00F5:\"o\\u0303\",\\u1E4D:\"o\\u0303\\u0301\",\\u1E4F:\"o\\u0303\\u0308\",\\u022D:\"o\\u0303\\u0304\",\\u014D:\"o\\u0304\",\\u1E53:\"o\\u0304\\u0301\",\\u1E51:\"o\\u0304\\u0300\",\\u014F:\"o\\u0306\",\\u01D2:\"o\\u030C\",\\u00F4:\"o\\u0302\",\\u1ED1:\"o\\u0302\\u0301\",\\u1ED3:\"o\\u0302\\u0300\",\\u1ED7:\"o\\u0302\\u0303\",\\u022F:\"o\\u0307\",\\u0231:\"o\\u0307\\u0304\",\\u0151:\"o\\u030B\",\\u1E55:\"p\\u0301\",\\u1E57:\"p\\u0307\",\\u0155:\"r\\u0301\",\\u0159:\"r\\u030C\",\\u1E59:\"r\\u0307\",\\u0157:\"r\\u0327\",\\u015B:\"s\\u0301\",\\u1E65:\"s\\u0301\\u0307\",\\u0161:\"s\\u030C\",\\u1E67:\"s\\u030C\\u0307\",\\u015D:\"s\\u0302\",\\u1E61:\"s\\u0307\",\\u015F:\"s\\u0327\",\\u1E97:\"t\\u0308\",\\u0165:\"t\\u030C\",\\u1E6B:\"t\\u0307\",\\u0163:\"t\\u0327\",\\u00FA:\"u\\u0301\",\\u00F9:\"u\\u0300\",\\u00FC:\"u\\u0308\",\\u01D8:\"u\\u0308\\u0301\",\\u01DC:\"u\\u0308\\u0300\",\\u01D6:\"u\\u0308\\u0304\",\\u01DA:\"u\\u0308\\u030C\",\\u0169:\"u\\u0303\",\\u1E79:\"u\\u0303\\u0301\",\\u016B:\"u\\u0304\",\\u1E7B:\"u\\u0304\\u0308\",\\u016D:\"u\\u0306\",\\u01D4:\"u\\u030C\",\\u00FB:\"u\\u0302\",\\u016F:\"u\\u030A\",\\u0171:\"u\\u030B\",\\u1E7D:\"v\\u0303\",\\u1E83:\"w\\u0301\",\\u1E81:\"w\\u0300\",\\u1E85:\"w\\u0308\",\\u0175:\"w\\u0302\",\\u1E87:\"w\\u0307\",\\u1E98:\"w\\u030A\",\\u1E8D:\"x\\u0308\",\\u1E8B:\"x\\u0307\",\\u00FD:\"y\\u0301\",\\u1EF3:\"y\\u0300\",\\u00FF:\"y\\u0308\",\\u1EF9:\"y\\u0303\",\\u0233:\"y\\u0304\",\\u0177:\"y\\u0302\",\\u1E8F:\"y\\u0307\",\\u1E99:\"y\\u030A\",\\u017A:\"z\\u0301\",\\u017E:\"z\\u030C\",\\u1E91:\"z\\u0302\",\\u017C:\"z\\u0307\",\\u00C1:\"A\\u0301\",\\u00C0:\"A\\u0300\",\\u00C4:\"A\\u0308\",\\u01DE:\"A\\u0308\\u0304\",\\u00C3:\"A\\u0303\",\\u0100:\"A\\u0304\",\\u0102:\"A\\u0306\",\\u1EAE:\"A\\u0306\\u0301\",\\u1EB0:\"A\\u0306\\u0300\",\\u1EB4:\"A\\u0306\\u0303\",\\u01CD:\"A\\u030C\",\\u00C2:\"A\\u0302\",\\u1EA4:\"A\\u0302\\u0301\",\\u1EA6:\"A\\u0302\\u0300\",\\u1EAA:\"A\\u0302\\u0303\",\\u0226:\"A\\u0307\",\\u01E0:\"A\\u0307\\u0304\",\\u00C5:\"A\\u030A\",\\u01FA:\"A\\u030A\\u0301\",\\u1E02:\"B\\u0307\",\\u0106:\"C\\u0301\",\\u1E08:\"C\\u0327\\u0301\",\\u010C:\"C\\u030C\",\\u0108:\"C\\u0302\",\\u010A:\"C\\u0307\",\\u00C7:\"C\\u0327\",\\u010E:\"D\\u030C\",\\u1E0A:\"D\\u0307\",\\u1E10:\"D\\u0327\",\\u00C9:\"E\\u0301\",\\u00C8:\"E\\u0300\",\\u00CB:\"E\\u0308\",\\u1EBC:\"E\\u0303\",\\u0112:\"E\\u0304\",\\u1E16:\"E\\u0304\\u0301\",\\u1E14:\"E\\u0304\\u0300\",\\u0114:\"E\\u0306\",\\u1E1C:\"E\\u0327\\u0306\",\\u011A:\"E\\u030C\",\\u00CA:\"E\\u0302\",\\u1EBE:\"E\\u0302\\u0301\",\\u1EC0:\"E\\u0302\\u0300\",\\u1EC4:\"E\\u0302\\u0303\",\\u0116:\"E\\u0307\",\\u0228:\"E\\u0327\",\\u1E1E:\"F\\u0307\",\\u01F4:\"G\\u0301\",\\u1E20:\"G\\u0304\",\\u011E:\"G\\u0306\",\\u01E6:\"G\\u030C\",\\u011C:\"G\\u0302\",\\u0120:\"G\\u0307\",\\u0122:\"G\\u0327\",\\u1E26:\"H\\u0308\",\\u021E:\"H\\u030C\",\\u0124:\"H\\u0302\",\\u1E22:\"H\\u0307\",\\u1E28:\"H\\u0327\",\\u00CD:\"I\\u0301\",\\u00CC:\"I\\u0300\",\\u00CF:\"I\\u0308\",\\u1E2E:\"I\\u0308\\u0301\",\\u0128:\"I\\u0303\",\\u012A:\"I\\u0304\",\\u012C:\"I\\u0306\",\\u01CF:\"I\\u030C\",\\u00CE:\"I\\u0302\",\\u0130:\"I\\u0307\",\\u0134:\"J\\u0302\",\\u1E30:\"K\\u0301\",\\u01E8:\"K\\u030C\",\\u0136:\"K\\u0327\",\\u0139:\"L\\u0301\",\\u013D:\"L\\u030C\",\\u013B:\"L\\u0327\",\\u1E3E:\"M\\u0301\",\\u1E40:\"M\\u0307\",\\u0143:\"N\\u0301\",\\u01F8:\"N\\u0300\",\\u00D1:\"N\\u0303\",\\u0147:\"N\\u030C\",\\u1E44:\"N\\u0307\",\\u0145:\"N\\u0327\",\\u00D3:\"O\\u0301\",\\u00D2:\"O\\u0300\",\\u00D6:\"O\\u0308\",\\u022A:\"O\\u0308\\u0304\",\\u00D5:\"O\\u0303\",\\u1E4C:\"O\\u0303\\u0301\",\\u1E4E:\"O\\u0303\\u0308\",\\u022C:\"O\\u0303\\u0304\",\\u014C:\"O\\u0304\",\\u1E52:\"O\\u0304\\u0301\",\\u1E50:\"O\\u0304\\u0300\",\\u014E:\"O\\u0306\",\\u01D1:\"O\\u030C\",\\u00D4:\"O\\u0302\",\\u1ED0:\"O\\u0302\\u0301\",\\u1ED2:\"O\\u0302\\u0300\",\\u1ED6:\"O\\u0302\\u0303\",\\u022E:\"O\\u0307\",\\u0230:\"O\\u0307\\u0304\",\\u0150:\"O\\u030B\",\\u1E54:\"P\\u0301\",\\u1E56:\"P\\u0307\",\\u0154:\"R\\u0301\",\\u0158:\"R\\u030C\",\\u1E58:\"R\\u0307\",\\u0156:\"R\\u0327\",\\u015A:\"S\\u0301\",\\u1E64:\"S\\u0301\\u0307\",\\u0160:\"S\\u030C\",\\u1E66:\"S\\u030C\\u0307\",\\u015C:\"S\\u0302\",\\u1E60:\"S\\u0307\",\\u015E:\"S\\u0327\",\\u0164:\"T\\u030C\",\\u1E6A:\"T\\u0307\",\\u0162:\"T\\u0327\",\\u00DA:\"U\\u0301\",\\u00D9:\"U\\u0300\",\\u00DC:\"U\\u0308\",\\u01D7:\"U\\u0308\\u0301\",\\u01DB:\"U\\u0308\\u0300\",\\u01D5:\"U\\u0308\\u0304\",\\u01D9:\"U\\u0308\\u030C\",\\u0168:\"U\\u0303\",\\u1E78:\"U\\u0303\\u0301\",\\u016A:\"U\\u0304\",\\u1E7A:\"U\\u0304\\u0308\",\\u016C:\"U\\u0306\",\\u01D3:\"U\\u030C\",\\u00DB:\"U\\u0302\",\\u016E:\"U\\u030A\",\\u0170:\"U\\u030B\",\\u1E7C:\"V\\u0303\",\\u1E82:\"W\\u0301\",\\u1E80:\"W\\u0300\",\\u1E84:\"W\\u0308\",\\u0174:\"W\\u0302\",\\u1E86:\"W\\u0307\",\\u1E8C:\"X\\u0308\",\\u1E8A:\"X\\u0307\",\\u00DD:\"Y\\u0301\",\\u1EF2:\"Y\\u0300\",\\u0178:\"Y\\u0308\",\\u1EF8:\"Y\\u0303\",\\u0232:\"Y\\u0304\",\\u0176:\"Y\\u0302\",\\u1E8E:\"Y\\u0307\",\\u0179:\"Z\\u0301\",\\u017D:\"Z\\u030C\",\\u1E90:\"Z\\u0302\",\\u017B:\"Z\\u0307\",\\u03AC:\"\\u03B1\\u0301\",\\u1F70:\"\\u03B1\\u0300\",\\u1FB1:\"\\u03B1\\u0304\",\\u1FB0:\"\\u03B1\\u0306\",\\u03AD:\"\\u03B5\\u0301\",\\u1F72:\"\\u03B5\\u0300\",\\u03AE:\"\\u03B7\\u0301\",\\u1F74:\"\\u03B7\\u0300\",\\u03AF:\"\\u03B9\\u0301\",\\u1F76:\"\\u03B9\\u0300\",\\u03CA:\"\\u03B9\\u0308\",\\u0390:\"\\u03B9\\u0308\\u0301\",\\u1FD2:\"\\u03B9\\u0308\\u0300\",\\u1FD1:\"\\u03B9\\u0304\",\\u1FD0:\"\\u03B9\\u0306\",\\u03CC:\"\\u03BF\\u0301\",\\u1F78:\"\\u03BF\\u0300\",\\u03CD:\"\\u03C5\\u0301\",\\u1F7A:\"\\u03C5\\u0300\",\\u03CB:\"\\u03C5\\u0308\",\\u03B0:\"\\u03C5\\u0308\\u0301\",\\u1FE2:\"\\u03C5\\u0308\\u0300\",\\u1FE1:\"\\u03C5\\u0304\",\\u1FE0:\"\\u03C5\\u0306\",\\u03CE:\"\\u03C9\\u0301\",\\u1F7C:\"\\u03C9\\u0300\",\\u038E:\"\\u03A5\\u0301\",\\u1FEA:\"\\u03A5\\u0300\",\\u03AB:\"\\u03A5\\u0308\",\\u1FE9:\"\\u03A5\\u0304\",\\u1FE8:\"\\u03A5\\u0306\",\\u038F:\"\\u03A9\\u0301\",\\u1FFA:\"\\u03A9\\u0300\"},bn=function(){function m(t,n){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode=\"math\",this.gullet=new Ti(t,n,this.mode),this.settings=n,this.leftrightDepth=0}var s=m.prototype;return s.expect=function(n,l){if(l===void 0\u0026\u0026(l=!0),this.fetch().text!==n)throw new A(\"Expected '\"+n+\"', got '\"+this.fetch().text+\"'\",this.fetch());l\u0026\u0026this.consume()},s.consume=function(){this.nextToken=null},s.fetch=function(){return this.nextToken==null\u0026\u0026(this.nextToken=this.gullet.expandNextToken()),this.nextToken},s.switchMode=function(n){this.mode=n,this.gullet.switchMode(n)},s.parse=function(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor\u0026\u0026this.gullet.macros.set(\"\\\\color\",\"\\\\textcolor\");try{var n=this.parseExpression(!1);return this.expect(\"EOF\"),this.settings.globalGroup||this.gullet.endGroup(),n}finally{this.gullet.endGroups()}},s.subparse=function(n){var l=this.nextToken;this.consume(),this.gullet.pushToken(new Ve(\"}\")),this.gullet.pushTokens(n);var i=this.parseExpression(!1);return this.expect(\"}\"),this.nextToken=l,i},s.parseExpression=function(n,l){for(var i=[];;){this.mode===\"math\"\u0026\u0026this.consumeSpaces();var c=this.fetch();if(m.endOfExpression.indexOf(c.text)!==-1||l\u0026\u0026c.text===l||n\u0026\u0026Ue[c.text]\u0026\u0026Ue[c.text].infix)break;var d=this.parseAtom(l);if(d){if(d.type===\"internal\")continue}else break;i.push(d)}return this.mode===\"text\"\u0026\u0026this.formLigatures(i),this.handleInfixNodes(i)},s.handleInfixNodes=function(n){for(var l=-1,i,c=0;c\u003cn.length;c++)if(n[c].type===\"infix\"){if(l!==-1)throw new A(\"only one infix operator per group\",n[c].token);l=c,i=n[c].replaceWith}if(l!==-1\u0026\u0026i){var d,o,g=n.slice(0,l),y=n.slice(l+1);g.length===1\u0026\u0026g[0].type===\"ordgroup\"?d=g[0]:d={type:\"ordgroup\",mode:this.mode,body:g},y.length===1\u0026\u0026y[0].type===\"ordgroup\"?o=y[0]:o={type:\"ordgroup\",mode:this.mode,body:y};var x;return i===\"\\\\\\\\abovefrac\"?x=this.callFunction(i,[d,n[l],o],[]):x=this.callFunction(i,[d,o],[]),[x]}else return n},s.handleSupSubscript=function(n){var l=this.fetch(),i=l.text;this.consume(),this.consumeSpaces();var c=this.parseGroup(n);if(!c)throw new A(\"Expected group after '\"+i+\"'\",l);return c},s.formatUnsupportedCmd=function(n){for(var l=[],i=0;i\u003cn.length;i++)l.push({type:\"textord\",mode:\"text\",text:n[i]});var c={type:\"text\",mode:this.mode,body:l},d={type:\"color\",mode:this.mode,color:this.settings.errorColor,body:[c]};return d},s.parseAtom=function(n){var l=this.parseGroup(\"atom\",n);if(this.mode===\"text\")return l;for(var i,c;;){this.consumeSpaces();var d=this.fetch();if(d.text===\"\\\\limits\"||d.text===\"\\\\nolimits\"){if(l\u0026\u0026l.type===\"op\"){var o=d.text===\"\\\\limits\";l.limits=o,l.alwaysHandleSupSub=!0}else if(l\u0026\u0026l.type===\"operatorname\")l.alwaysHandleSupSub\u0026\u0026(l.limits=d.text===\"\\\\limits\");else throw new A(\"Limit controls must follow a math operator\",d);this.consume()}else if(d.text===\"^\"){if(i)throw new A(\"Double superscript\",d);i=this.handleSupSubscript(\"superscript\")}else if(d.text===\"_\"){if(c)throw new A(\"Double subscript\",d);c=this.handleSupSubscript(\"subscript\")}else if(d.text===\"'\"){if(i)throw new A(\"Double superscript\",d);var g={type:\"textord\",mode:this.mode,text:\"\\\\prime\"},y=[g];for(this.consume();this.fetch().text===\"'\";)y.push(g),this.consume();this.fetch().text===\"^\"\u0026\u0026y.push(this.handleSupSubscript(\"superscript\")),i={type:\"ordgroup\",mode:this.mode,body:y}}else if(_a[d.text]){var x=_a[d.text],w=yn.test(d.text);for(this.consume();;){var k=this.fetch().text;if(!_a[k]||yn.test(k)!==w)break;this.consume(),x+=_a[k]}var z=new m(x,this.settings).parse();w?c={type:\"ordgroup\",mode:\"math\",body:z}:i={type:\"ordgroup\",mode:\"math\",body:z}}else break}return i||c?{type:\"supsub\",mode:this.mode,base:l,sup:i,sub:c}:l},s.parseFunction=function(n,l){var i=this.fetch(),c=i.text,d=Ue[c];if(!d)return null;if(this.consume(),l\u0026\u0026l!==\"atom\"\u0026\u0026!d.allowedInArgument)throw new A(\"Got function '\"+c+\"' with no arguments\"+(l?\" as \"+l:\"\"),i);if(this.mode===\"text\"\u0026\u0026!d.allowedInText)throw new A(\"Can't use function '\"+c+\"' in text mode\",i);if(this.mode===\"math\"\u0026\u0026d.allowedInMath===!1)throw new A(\"Can't use function '\"+c+\"' in math mode\",i);var o=this.parseArguments(c,d),g=o.args,y=o.optArgs;return this.callFunction(c,g,y,i,n)},s.callFunction=function(n,l,i,c,d){var o={funcName:n,parser:this,token:c,breakOnTokenText:d},g=Ue[n];if(g\u0026\u0026g.handler)return g.handler(o,l,i);throw new A(\"No function handler for \"+n)},s.parseArguments=function(n,l){var i=l.numArgs+l.numOptionalArgs;if(i===0)return{args:[],optArgs:[]};for(var c=[],d=[],o=0;o\u003ci;o++){var g=l.argTypes\u0026\u0026l.argTypes[o],y=o\u003cl.numOptionalArgs;(l.primitive\u0026\u0026g==null||l.type===\"sqrt\"\u0026\u0026o===1\u0026\u0026d[0]==null)\u0026\u0026(g=\"primitive\");var x=this.parseGroupOfType(\"argument to '\"+n+\"'\",g,y);if(y)d.push(x);else if(x!=null)c.push(x);else throw new A(\"Null argument, please report this as a bug\")}return{args:c,optArgs:d}},s.parseGroupOfType=function(n,l,i){switch(l){case\"color\":return this.parseColorGroup(i);case\"size\":return this.parseSizeGroup(i);case\"url\":return this.parseUrlGroup(i);case\"math\":case\"text\":return this.parseArgumentGroup(i,l);case\"hbox\":{var c=this.parseArgumentGroup(i,\"text\");return c!=null?{type:\"styling\",mode:c.mode,body:[c],style:\"text\"}:null}case\"raw\":{var d=this.parseStringGroup(\"raw\",i);return d!=null?{type:\"raw\",mode:\"text\",string:d.text}:null}case\"primitive\":{if(i)throw new A(\"A primitive argument cannot be optional\");var o=this.parseGroup(n);if(o==null)throw new A(\"Expected group as \"+n,this.fetch());return o}case\"original\":case null:case void 0:return this.parseArgumentGroup(i);default:throw new A(\"Unknown group type as \"+n,this.fetch())}},s.consumeSpaces=function(){for(;this.fetch().text===\" \";)this.consume()},s.parseStringGroup=function(n,l){var i=this.gullet.scanArgument(l);if(i==null)return null;for(var c=\"\",d;(d=this.fetch()).text!==\"EOF\";)c+=d.text,this.consume();return this.consume(),i.text=c,i},s.parseRegexGroup=function(n,l){for(var i=this.fetch(),c=i,d=\"\",o;(o=this.fetch()).text!==\"EOF\"\u0026\u0026n.test(d+o.text);)c=o,d+=c.text,this.consume();if(d===\"\")throw new A(\"Invalid \"+l+\": '\"+i.text+\"'\",i);return i.range(c,d)},s.parseColorGroup=function(n){var l=this.parseStringGroup(\"color\",n);if(l==null)return null;var i=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(l.text);if(!i)throw new A(\"Invalid color: '\"+l.text+\"'\",l);var c=i[0];return/^[0-9a-f]{6}$/i.test(c)\u0026\u0026(c=\"#\"+c),{type:\"color-token\",mode:this.mode,color:c}},s.parseSizeGroup=function(n){var l,i=!1;if(this.gullet.consumeSpaces(),!n\u0026\u0026this.gullet.future().text!==\"{\"?l=this.parseRegexGroup(/^[-+]? *(?:$|\\d+|\\d+\\.\\d*|\\.\\d*) *[a-z]{0,2} *$/,\"size\"):l=this.parseStringGroup(\"size\",n),!l)return null;!n\u0026\u0026l.text.length===0\u0026\u0026(l.text=\"0pt\",i=!0);var c=/([-+]?) *(\\d+(?:\\.\\d*)?|\\.\\d+) *([a-z]{2})/.exec(l.text);if(!c)throw new A(\"Invalid size: '\"+l.text+\"'\",l);var d={number:+(c[1]+c[2]),unit:c[3]};if(!Ks(d))throw new A(\"Invalid unit: '\"+d.unit+\"'\",l);return{type:\"size\",mode:this.mode,value:d,isBlank:i}},s.parseUrlGroup=function(n){this.gullet.lexer.setCatcode(\"%\",13),this.gullet.lexer.setCatcode(\"~\",12);var l=this.parseStringGroup(\"url\",n);if(this.gullet.lexer.setCatcode(\"%\",14),this.gullet.lexer.setCatcode(\"~\",13),l==null)return null;var i=l.text.replace(/\\\\([#$%\u0026~_^{}])/g,\"$1\");return{type:\"url\",mode:this.mode,url:i}},s.parseArgumentGroup=function(n,l){var i=this.gullet.scanArgument(n);if(i==null)return null;var c=this.mode;l\u0026\u0026this.switchMode(l),this.gullet.beginGroup();var d=this.parseExpression(!1,\"EOF\");this.expect(\"EOF\"),this.gullet.endGroup();var o={type:\"ordgroup\",mode:this.mode,loc:i.loc,body:d};return l\u0026\u0026this.switchMode(c),o},s.parseGroup=function(n,l){var i=this.fetch(),c=i.text,d;if(c===\"{\"||c===\"\\\\begingroup\"){this.consume();var o=c===\"{\"?\"}\":\"\\\\endgroup\";this.gullet.beginGroup();var g=this.parseExpression(!1,o),y=this.fetch();this.expect(o),this.gullet.endGroup(),d={type:\"ordgroup\",mode:this.mode,loc:ke.range(i,y),body:g,semisimple:c===\"\\\\begingroup\"||void 0}}else if(d=this.parseFunction(l,n)||this.parseSymbol(),d==null\u0026\u0026c[0]===\"\\\\\"\u0026\u0026!vn.hasOwnProperty(c)){if(this.settings.throwOnError)throw new A(\"Undefined control sequence: \"+c,i);d=this.formatUnsupportedCmd(c),this.consume()}return d},s.formLigatures=function(n){for(var l=n.length-1,i=0;i\u003cl;++i){var c=n[i],d=c.text;d===\"-\"\u0026\u0026n[i+1].text===\"-\"\u0026\u0026(i+1\u003cl\u0026\u0026n[i+2].text===\"-\"?(n.splice(i,3,{type:\"textord\",mode:\"text\",loc:ke.range(c,n[i+2]),text:\"---\"}),l-=2):(n.splice(i,2,{type:\"textord\",mode:\"text\",loc:ke.range(c,n[i+1]),text:\"--\"}),l-=1)),(d===\"'\"||d===\"`\")\u0026\u0026n[i+1].text===d\u0026\u0026(n.splice(i,2,{type:\"textord\",mode:\"text\",loc:ke.range(c,n[i+1]),text:d+d}),l-=1)}},s.parseSymbol=function(){var n=this.fetch(),l=n.text;if(/^\\\\verb[^a-zA-Z]/.test(l)){this.consume();var i=l.slice(5),c=i.charAt(0)===\"*\";if(c\u0026\u0026(i=i.slice(1)),i.length\u003c2||i.charAt(0)!==i.slice(-1))throw new A(`\\\\verb assertion failed --\n                    please report what input caused this bug`);return i=i.slice(1,-1),{type:\"verb\",mode:\"text\",body:i,star:c}}fn.hasOwnProperty(l[0])\u0026\u0026!K[this.mode][l[0]]\u0026\u0026(this.settings.strict\u0026\u0026this.mode===\"math\"\u0026\u0026this.settings.reportNonstrict(\"unicodeTextInMathMode\",'Accented Unicode text character \"'+l[0]+'\" used in math mode',n),l=fn[l[0]]+l.slice(1));var d=Ri.exec(l);d\u0026\u0026(l=l.substring(0,d.index),l===\"i\"?l=\"\\u0131\":l===\"j\"\u0026\u0026(l=\"\\u0237\"));var o;if(K[this.mode][l]){this.settings.strict\u0026\u0026this.mode===\"math\"\u0026\u0026ms.indexOf(l)\u003e=0\u0026\u0026this.settings.reportNonstrict(\"unicodeTextInMathMode\",'Latin-1/Unicode text character \"'+l[0]+'\" used in math mode',n);var g=K[this.mode][l].group,y=ke.range(n),x;if(Nl.hasOwnProperty(g)){var w=g;x={type:\"atom\",mode:this.mode,family:w,loc:y,text:l}}else x={type:g,mode:this.mode,loc:y,text:l};o=x}else if(l.charCodeAt(0)\u003e=128)this.settings.strict\u0026\u0026(Us(l.charCodeAt(0))?this.mode===\"math\"\u0026\u0026this.settings.reportNonstrict(\"unicodeTextInMathMode\",'Unicode text character \"'+l[0]+'\" used in math mode',n):this.settings.reportNonstrict(\"unknownSymbol\",'Unrecognized Unicode character \"'+l[0]+'\"'+(\" (\"+l.charCodeAt(0)+\")\"),n)),o={type:\"textord\",mode:\"text\",loc:ke.range(n),text:l};else return null;if(this.consume(),d)for(var k=0;k\u003cd[0].length;k++){var z=d[0][k];if(!Fs[z])throw new A(\"Unknown accent ' \"+z+\"'\",n);var S=Fs[z][this.mode]||Fs[z].text;if(!S)throw new A(\"Accent \"+z+\" unsupported in \"+this.mode+\" mode\",n);o={type:\"accent\",mode:this.mode,loc:ke.range(n),label:S,isStretchy:!1,isShifty:!0,base:o}}return o},m}();bn.endOfExpression=[\"}\",\"\\\\endgroup\",\"\\\\end\",\"\\\\right\",\"\u0026\"];var Di=function(s,t){if(!(typeof s==\"string\"||s instanceof String))throw new TypeError(\"KaTeX can only parse string typed expression\");var n=new bn(s,t);delete n.gullet.macros.current[\"\\\\df@tag\"];var l=n.parse();if(delete n.gullet.macros.current[\"\\\\current@color\"],delete n.gullet.macros.current[\"\\\\color\"],n.gullet.macros.get(\"\\\\df@tag\")){if(!t.displayMode)throw new A(\"\\\\tag works only in display equations\");l=[{type:\"tag\",mode:\"text\",body:l,tag:n.subparse([new Ve(\"\\\\df@tag\")])}]}return l},Os=Di,xn=function(s,t,n){t.textContent=\"\";var l=Hs(s,n).toNode();t.appendChild(l)};typeof document\u003c\"u\"\u0026\u0026document.compatMode!==\"CSS1Compat\"\u0026\u0026(typeof console\u003c\"u\"\u0026\u0026console.warn(\"Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype.\"),xn=function(){throw new A(\"KaTeX doesn't work in quirks mode.\")});var Ci=function(s,t){var n=Hs(s,t).toMarkup();return n},Ei=function(s,t){var n=new Ja(t);return Os(s,n)},wn=function(s,t,n){if(n.throwOnError||!(s instanceof A))throw s;var l=b.makeSpan([\"katex-error\"],[new ve(t)]);return l.setAttribute(\"title\",s.toString()),l.setAttribute(\"style\",\"color:\"+n.errorColor),l},Hs=function(s,t){var n=new Ja(t);try{var l=Os(s,n);return Hl(l,s,n)}catch(i){return wn(i,s,n)}},qi=function(s,t){var n=new Ja(t);try{var l=Os(s,n);return Pl(l,s,n)}catch(i){return wn(i,s,n)}},Ii={version:\"0.16.6\",render:xn,renderToString:Ci,ParseError:A,SETTINGS_SCHEMA:wa,__parse:Ei,__renderToDomTree:Hs,__renderToHTMLTree:qi,__setFontMetrics:ml,__defineSymbol:r,__defineFunction:T,__defineMacro:u,__domTree:{Span:ua,Anchor:ts,SymbolNode:ve,SvgNode:Ce,PathNode:je,LineNode:ns}},Fi=Ii;return e=e.default,e}()})});var Qi={};Ui(Qi,{default:()=\u003eKi,frontmatter:()=\u003e$i});ze();Me();var a=Ln(Tn());ze();Me();var Xi=({label:G,num:e,text:ae})=\u003e{let A=ae||\"Equation\";return React.createElement(\"a\",{className:\"eq-ref\",href:`#${G}`},`${A} (${e})`)},re=Xi;ze();Me();var Yi=({type:G,children:e})=\u003e{let ae=\"note\";return G\u0026\u0026(ae+=\" \"+G),React.createElement(\"div\",{className:ae},e)},Te=Yi;var En=Ln(Dn()),$i={title:\"Maximum Entropy Inverse Reinforcement Learning\",author:\"Maximilian Luz\",date:\"2022-08-25\",tags:[\"machine-learning\",\"reinforcement-learning\",\"inverse-reinforcement-learning\"],abstract:`_Reinforcement learning (RL)_ aims to provide a framework for finding the optimal behavior (i.e., an optimal policy) of intelligent agents regarding some environment they interact with by directing them via a reward signal, measuring their performance. \nWith the help of _inverse reinforcement learning (IRL)_ we can try to improve our agents by recovering the reward function (and therefore policy) of an expert, in essence using its domain knowledge for our needs.\n\n_Maximum entropy IRL_ is a comparatively simple but clever method of solving the general IRL problem for discrete Markov decision processes.\nIn this blog post, I will lay out the theoretical foundation of this approach, including the principle of maximum entropy, and derive the maximum entropy IRL algorithm.\n`,bibliography:\"20220825-irl-maxent.bib.json\"};function Cn(G){let e=Object.assign({p:\"p\",strong:\"strong\",a:\"a\",h1:\"h1\",em:\"em\",span:\"span\",math:\"math\",semantics:\"semantics\",mrow:\"mrow\",mo:\"mo\",mi:\"mi\",annotation:\"annotation\",msub:\"msub\",mn:\"mn\",msubsup:\"msubsup\",msup:\"msup\",div:\"div\",munder:\"munder\",mtable:\"mtable\",mtr:\"mtr\",mtd:\"mtd\",mstyle:\"mstyle\",mfrac:\"mfrac\",img:\"img\",mspace:\"mspace\",mtext:\"mtext\",h2:\"h2\",h3:\"h3\",ul:\"ul\",li:\"li\",ol:\"ol\",i:\"i\"},G.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(Te,{children:[(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Disclaimer:\"}),` This post is an adapted version of the theoretical part of a Jupyter Notebook that I wrote in 2019 for a seminar on Imitation Learning.\nYou can find it, an accompanying presentation, and a small framework at `,(0,a.jsx)(e.a,{href:\"https://github.com/qzed/irl-maxent\",children:\"github.com/qzed/irl-maxent\"}),\".\"]}),(0,a.jsx)(e.p,{children:\"I highly encourage you to have a look at that notebook in case you're interested in the code behind this theory.\"})]}),`\n`,(0,a.jsx)(e.h1,{id:\"context-and-motivation\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#context-and-motivation\",children:\"Context and Motivation\"})}),`\n`,(0,a.jsxs)(e.p,{children:[`Let us start with some context and a brief overview of the problem we're trying to solve:\n`,(0,a.jsx)(e.em,{children:\"Reinforcement learning (RL)\"}),` aims to provide a framework for finding the optimal behavior (i.e., an optimal policy) of intelligent agents regarding some environment they interact with by directing them via a reward signal, measuring their performance.\nIn `,(0,a.jsx)(e.em,{children:\"inverse reinforcement learning (IRL)\"}),`, somewhat conversely, we try to recover the reward function (and therefore policy) of an agent given a set of demonstrations performed by that agent.\nAt first, this may seem to stand somewhat opposed to the larger goal of creating intelligent agents, however, we can use the demonstration of experts \\u2015 often humans \\u2015 to improve our agents by guiding them to a better solution.`]}),`\n`,(0,a.jsxs)(e.p,{children:[`An important aspect of IRL is the recovery of the expert's reward function, which in many classical reinforcement-learning scenarios is often hand-designed.\nThis also sets it apart from `,(0,a.jsx)(e.em,{children:\"behavioral cloning (BC)\"}),\", another category of methods under the larger \",(0,a.jsx)(e.em,{children:\"imitation learning (IL)\"}),\" umbrella \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a1gvqi3hjv5\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-osaAlgorithmicPerspectiveImitation2018\",children:\"(see Osa et al., 2018 for an overview)\"})}),`, which focuses on retrieving the expert's policy instead of the reward.\nThe general idea is that by analyzing the actions taken by an expert, we can infer a better reward function than we could manually design.`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Maximum entropy (MaxEnt) inverse reinforcement learning \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a5kmk23jfg\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartMaximumEntropyInverse2008\",children:\"(Ziebart et al., 2008)\"})}),` is a powerful and clever, yet fairly simple way to achieve this.\nHaving discussed the \\u201Cwhy\\u201D, let us now get to the \\u201Chow\\u201D:`]}),`\n`,(0,a.jsx)(e.h1,{id:\"a-more-mathematical-introduction\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#a-more-mathematical-introduction\",children:\"A More Mathematical Introduction\"})}),`\n`,(0,a.jsxs)(e.p,{children:[`While I assume some familiarity with the basics of reinforcement and inverse reinforcement learning, here's a short overview:\nIn both settings, we describe our world using a Markov decision process (MDP).\nAn MDP is a 5-tuple `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"S\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"A\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"T\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"R\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03B3\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"(S, A, T, R, \\\\gamma)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"T\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05556em\"},children:\"\\u03B3\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" with states \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"S\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"S\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"})]})})]})}),\", actions \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"A\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"A\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"})]})})]})}),\", transition model \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"T\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"T(s_t, a_t, s_{t+1}) = p(s_{t+1} \\\\mid s_t, a_t)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.13889em\"},children:\"T\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\", reward function \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"R\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"R(s_t, a_t, s_{t+1}) \\\\in \\\\mathbb{R}\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6889em\"}}),(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"})]})]})]})}),\", and reward discount factor \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03B3\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,a.jsx)(e.mn,{children:\"0\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mn,{children:\"1\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"]\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\gamma \\\\in [0, 1]\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.7335em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05556em\"},children:\"\\u03B3\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\"0\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"1\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\"]\"})]})]})]})}),\", decreasing the reward over time (where \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mi,{children:\"A\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"a_t \\\\in A\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6891em\",verticalAlign:\"-0.15em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"})]})]})]})}),\" and \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mi,{children:\"S\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"s_t, s_{t+1} \\\\in S\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.7474em\",verticalAlign:\"-0.2083em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"})]})]})]})}),`).\nIn the inverse reinforcement learning setting, we will only use per-state rewards `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"R\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"R(s) \\\\in \\\\mathbb{R}\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6889em\"}}),(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"})]})]})]})}),`.\nThe key part of an MDP is that any action relies solely on the current state, meaning complete independence of all preceding history.`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"The goal of reinforcement learning then is to find an optimal sequence of actions, i.e., a policy describing the optimal action per state, for an autonomous agent given a reward signal \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"R\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"R\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"})]})})]})}),`.\nThe reward signal provides feedback to the agent, affirming its behavior on actions that help further the goal of the task at hand, and punishing it on actions that are counter-productive to this goal.\nPolicies come in two flavors: deterministic and stochastic.\nDeterministic policies are defined as function `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mo,{children:\":\"}),(0,a.jsx)(e.mi,{children:\"S\"}),(0,a.jsx)(e.mo,{children:\"\\u2192\"}),(0,a.jsx)(e.mi,{children:\"A\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi: S \\\\to A\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2192\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"A\"})]})]})]})}),\", whereas stochastic policies are defined as probability distributions over actions, i.e., \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi(a \\\\mid s)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),`.\nWhile in the usual RL setting the (or at least one) optimal policy is guaranteed to be deterministic, in inverse reinforcement learning (and not only there), it makes more sense to talk about stochastic policies.`]}),`\n`,(0,a.jsxs)(e.p,{children:[`Inverse reinforcement learning, as discussed above and the name suggests, does the inverse of RL.\nGiven a set of demonstrations `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"D\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"{\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsxs)(e.msubsup,{children:[(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"}\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"i\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"1\"})]}),(0,a.jsx)(e.mi,{children:\"n\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{D} = \\\\{\\\\tau_i\\\\}_{i=1}^{n}\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0087em\",verticalAlign:\"-0.2587em\"}}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"{\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1132em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsxs)(e.span,{className:\"mclose\",children:[(0,a.jsx)(e.span,{className:\"mclose\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.6644em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.4413em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"n\"})})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2587em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})]})]})}),\" of an expert (agent), consisting of trajectories \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mn,{children:\"1\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mn,{children:\"1\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mn,{children:\"2\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mn,{children:\"2\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mo,{children:\"\\u2026\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"n\"}),(0,a.jsx)(e.mo,{children:\"\\u2212\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"n\"}),(0,a.jsx)(e.mo,{children:\"\\u2212\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"n\"})]}),(0,a.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau = \\\\left( (s_1, a_1), (s_2, a_2), \\\\ldots, (s_{n-1}, a_{n-1}), s_n \\\\right)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"(\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"minner\",children:\"\\u2026\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"n\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"\\u2212\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"n\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"\\u2212\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"n\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\")\"})]})]})]})]})}),\" through the state-action space, IRL aims to recover the underlying reward function \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"R\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"R\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"})]})})]})}),\", which explains the behavior of the expert.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[`To allow for computation with states, we use so-called features.\nFeatures are, in this case, defined as a function `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{children:\":\"}),(0,a.jsx)(e.mi,{children:\"S\"}),(0,a.jsx)(e.mo,{children:\"\\u2192\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"}),(0,a.jsx)(e.mi,{children:\"d\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi: S \\\\to \\\\mathbb{R}^d\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2192\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.8491em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8491em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]})})})})})]})]})]})]})}),\", mapping states to \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"d\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"d\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"d\"})]})})]})}),`-dimensional vectors, and can be arbitrarily chosen.\nIn general, we assume that `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msubsup,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"1\"})]}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"})]})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi(\\\\tau) = \\\\sum_{t = 1}^{|\\\\tau|} \\\\phi(s_t)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.3276em\",verticalAlign:\"-0.2997em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsx)(e.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0279em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.2029em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2223\"})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2997em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\" where \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"|\\\\tau|\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2223\"})]})})]})}),\" denotes the length of the trajectories (visited states), i.e., that the features of a trajectory \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"\\u03C4\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})]})})]})}),\" are the sum of the features of the states visited by this trajectory, counting repetitions.\"]}),`\n`,(0,a.jsx)(e.h1,{id:\"the-principle-of-maximum-entropy\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#the-principle-of-maximum-entropy\",children:\"The Principle of Maximum Entropy\"})}),`\n`,(0,a.jsxs)(e.p,{children:[\"The general idea of Maximum Entropy Inverse Reinforcement Learning is based on feature-expectation matching \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a8do62nm0p\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-abbeelApprenticeshipLearningInverse2004\",children:\"(Abbeel \u0026 Ng, 2004)\"})}),`:\nThe expected visitation-frequency of features in the demonstrations provided by the expert should equal the expected visitation-frequency of features visited by the agent following the recovered reward function.\nIn other words: The features describing the states of our world should be, in expectation, visited equally often by the agent following our recovered reward function and by the expert demonstrating (nearly) optimal behavior.\nIn equations, we can express this as the expectation of features `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"\\u03D5\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.8889em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"})]})})]})}),\" over trajectories \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"\\u03C4\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})]})})]})}),\" derived from the reward we want to recover, and\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"]\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"E\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"]\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"    \\\\mathbb{E}_{\\\\pi^L}[\\\\phi(\\\\tau)] = \\\\mathbb{E}_{\\\\pi^E}[\\\\phi(\\\\tau)],\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")]\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")]\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"where the learner follows a policy \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi^L\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.8413em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})]})})]})}),` directly implied by the reward.\nThe expert follows an implicit policy `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"E\"})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi^E\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.8413em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})]})})]})}),\" that encodes its notion of reward and optimality.\"]}),`\n`,(0,a.jsx)(e.p,{children:\"Note that we can also express the expected feature visitation frequency as sum over trajectories\"}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"]\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"})]}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"    \\\\mathbb{E}_{\\\\pi^L}[\\\\phi(\\\\tau)] = \\\\sum_{\\\\tau} p_{\\\\pi^L}(\\\\tau) \\\\phi(\\\\tau)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")]\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.3em\",verticalAlign:\"-1.25em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.25em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"with the probability distribution \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p_{\\\\pi^L}(\\\\tau)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),` of trajectories of the learner. Finding such a match, however, is not a well-posed problem in accordance to the definition by Hadamard: There is not the single one, but many possible solutions.\nMultiple reward functions can achieve the same expected feature-visitation frequency `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a2b30tdu40u\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ngPolicyInvarianceReward1999\",children:\"(Abbeel \u0026 Ng, 2004; Ng et al., 1999; Ziebart, 2010)\"})}),`.\nTo resolve this ambiguity, Ziebart et al. `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-anlf0ktci\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartMaximumEntropyInverse2008\",children:\"(Ziebart et al., 2008)\"})}),\" propose to choose the solution (i.e., the \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p_{\\\\pi^L}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6276em\",verticalAlign:\"-0.1971em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\") maximizing the entropy.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[`But why should we maximize the entropy?\nTo answer this, we have to understand what entropy represents.\nFirstly, the entropy `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"H\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"H(p)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" of some event probability distribution \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"p\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"})]})})]})}),\" is defined as\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"H\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mo,{children:\"\\u2212\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"X\"})]})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"})]}),(0,a.jsx)(e.mn,{children:\"2\"})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})})]}),(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsx)(e.mrow,{})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"X\"})]})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u22C5\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"})]}),(0,a.jsx)(e.mn,{children:\"2\"})]}),(0,a.jsxs)(e.mfrac,{children:[(0,a.jsx)(e.mn,{children:\"1\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`\\\\begin{align*}\n    H(p)\n    \u0026= -\\\\sum_{x \\\\in \\\\mathcal{X}} p(x) \\\\log_2 p(x), \\\\\\\\\n    \u0026= \\\\sum_{x \\\\in \\\\mathcal{X}} p(x) \\\\cdot \\\\log_2 \\\\frac{1}{p(x)},\n\\\\end{align*}`})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"5.6149em\",verticalAlign:\"-2.5574em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsxs)(e.span,{className:\"mtable\",children:[(0,a.jsx)(e.span,{className:\"col-align-r\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"3.0574em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-5.3289em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-2.3857em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),(0,a.jsx)(e.span,{className:\"mord\"})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.5574em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"col-align-l\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"3.0574em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-5.3289em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2212\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.8557em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14643em\"},children:\"X\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3217em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.207em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-2.3857em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.8557em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.14643em\"},children:\"X\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3217em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.207em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,a.jsx)(e.span,{className:\"mfrac\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.3214em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"1\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.936em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mclose nulldelimiter\"})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.5574em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})]})})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"where \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"X\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"X\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07847em\"},children:\"X\"})]})})]})}),\" is the set containing all events \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"x\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"})]})})]})}),\" and \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(x)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" the probability of event \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"x\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"})]})})]})}),\" occurring.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Let us now assume that we want to communicate the occurrence of all events \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"x\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"})]})})]})}),` with some other party efficiently.\nTo accomplish this, we wish to minimize the expected message length, so messages that will be sent frequently should be short, and messages that will seldom be sent are allowed to be long.\nFollowing this trail of thought leads to the term `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"h\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"})]}),(0,a.jsx)(e.mn,{children:\"2\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mn,{children:\"1\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"h(x) = \\\\log_2(1/p(x))\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.207em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\"1/\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\"))\"})]})]})]})}),\", which is the optimal number of bits that we should spend on the message representing event \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"x\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"x\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"})]})})]})}),`.\nWith lower probability `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(x)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\", the term \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"})]}),(0,a.jsx)(e.mn,{children:\"2\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mn,{children:\"1\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\log_2(1/p(x))\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.207em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\"1/\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\"))\"})]})})]})}),` increases.\nIn fact, it increases logarithmically, as with more bits available, we can encode exponentially more events.\nUsing this observation for the entropy `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"H\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"H\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"})]})})]})}),\" then yields nothing more than the entropy being the lower limit of the expected message length over all messages, i.e.:\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"H\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"h\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{fence:\"true\",children:\"]\"})]}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\".\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`    H(p)\n    = \\\\mathbb{E}_{p(x)}\\\\left[h(x)\\\\right].`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.1052em\",verticalAlign:\"-0.3552em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5198em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose mtight\",children:\")\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3552em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"h\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\"]\"})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\".\"})]})]})]})})}),`\n`,(0,a.jsx)(e.p,{children:\"Summarizing all of this in a single sentence: Entropy is a measure of uncertainty.\"}),`\n`,(0,a.jsx)(Te,{children:(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Note:\"}),\" This is, in fact, the underlying principle of Huffman coding, which, due to this relation, is guaranteed to be optimal.\"]})}),`\n`,(0,a.jsxs)(e.p,{children:[`As is done generally, we will now use the normal logarithm instead of the base-two one.\nSince `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"})]}),(0,a.jsx)(e.mn,{children:\"2\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"x\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"/\"}),(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mn,{children:\"2\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\log_2(x) = \\\\log(x)/\\\\log(2)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.207em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.4559em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"2\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2441em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"x\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\"/\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\" holds, we are only dropping a constant factor of \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mn,{children:\"2\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\log(2)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\"2\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" which does not impact extrema or our reasoning below, and simplifies further computations.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[`With that in mind, let us ask again:\nWhy should we maximize the entropy?\nNow we can give a simple reasoning `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-av3g4l9eoe\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-jaynesInformationTheoryStatistical1957\",children:\"(Jaynes, 1957)\"})}),`:\nLet us assume that we have two distributions, `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"p\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"})]})})]})}),\" and \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"q\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"q\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"})]})})]})}),\", with entropy values \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"H\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\u003e\"}),(0,a.jsx)(e.mi,{children:\"H\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"q\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"H(p) \u003e H(q)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\u003e\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),`.\nFrom our previous observations, we now know that to encode messages from `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"p\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"})]})})]})}),\" we, in expectancy, need more bits than to encode messages from \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"q\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"q\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"})]})})]})}),`.\nThis is the key point because this in turn also means that we have less information about `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"p\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"})]})})]})}),\" than about \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"q\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"q\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"})]})})]})}),`.\nIf we know more about a distribution, we require fewer bits to encode events from it.\nIf we know everything, we do not need to send/encode anything, and if we know nothing, we need to send everything.`]}),`\n`,(0,a.jsxs)(e.p,{children:[`But isn't it good if we know more? \\u201CThe less entropy, the better, right?\\u201D you may ask.\nNo.\nNot for many optimization problems, or in general, when working with incomplete information:\nConsider a problem, like feature-expectation matching, which has multiple solutions fulfilling our constraints.\nThe only information which we give our solver for this problem is the feature-expectations we want to replicate.\nAll solutions provided by our solver contain this information.\nYet, they most certainly have different entropy values.\nThis must mean that (at least) some solutions have additional information that we did not provide, i.e., they have a bias.\nThis is illustrated in the figure below for our two distributions `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"p\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"})]})})]})}),\" and \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"q\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"q\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.625em\",verticalAlign:\"-0.1944em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"q\"})]})})]})}),\":\"]}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:\"/assets/blog/20220825-irl-maxent/maxent-principle.png\",alt:\"Illustration of the Maximum Entropy Principle\"})}),`\n`,(0,a.jsx)(e.p,{children:`By choosing the solution with maximum entropy, we choose the solution with minimal information.\nNote that all solutions already satisfy our constraints; thus we actually pick the solution that best fits our information with a minimal bias.`}),`\n`,(0,a.jsx)(e.h1,{id:\"deriving-the-maximum-entropy-inverse-reinforcement-learning-algorithm\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#deriving-the-maximum-entropy-inverse-reinforcement-learning-algorithm\",children:\"Deriving the Maximum Entropy Inverse Reinforcement Learning Algorithm\"})}),`\n`,(0,a.jsx)(e.p,{children:\"Applying our findings from the previous section to feature-expectation matching directly results in a constrained optimization problem:\"}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mtable,{rowspacing:\"0.25em\",columnalign:\"right left right left\",columnspacing:\"0em\",children:[(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.munder,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"arg\\u2009max\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"})]}),(0,a.jsx)(e.mi,{children:\"p\"})]}),(0,a.jsx)(e.mspace,{width:\"1em\"})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsx)(e.mrow,{})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"H\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})})})]}),(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mtext,{children:\"subject\\xA0to\"}),(0,a.jsx)(e.mspace,{width:\"1em\"}),(0,a.jsx)(e.mrow,{})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsx)(e.mrow,{})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"]\"})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"E\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"]\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})}),(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{className:\"mml-eqn-num\"})]}),(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsx)(e.mrow,{})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsx)(e.mrow,{})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"1\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mspace,{width:\"1em\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2200\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\":\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\u003e\"}),(0,a.jsx)(e.mn,{children:\"0\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})}),(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{className:\"mml-eqn-num\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`\\\\begin{alignat*}{2}\n    \\\\argmax_p\\\\quad\n        \u0026\u0026 H(p) \\\\\\\\\n    \\\\text{subject to}\\\\quad\n        \\\\label{eq:feature-constraints}\n        \u0026\u0026 \\\\mathbb{E}_{\\\\pi^L}[\\\\phi(\\\\tau)] \u0026= \\\\mathbb{E}_{\\\\pi^E}[\\\\phi(\\\\tau)],\n            \\\\tag{1a} \\\\\\\\\n        \\\\label{eq:probability-constraints}\n        \u0026\u0026 \\\\sum_{\\\\tau} p(\\\\tau) = 1, \u0026\\\\quad \\\\forall \\\\tau : p(\\\\tau) \u003e 0,\n            \\\\tag{1b}\n\\\\end{alignat*}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"6.2706em\",verticalAlign:\"-2.8853em\"}}),(0,a.jsxs)(e.span,{className:\"mtable\",children:[(0,a.jsx)(e.span,{className:\"col-align-r\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"3.3853em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-5.5953em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.4306em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.2056em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"p\"})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsx)(e.span,{className:\"mord mathrm\",style:{marginRight:\"0.01389em\"},children:\"arg\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathrm\",children:\"max\"})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.0305em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.4247em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord text\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"subject\\xA0to\"})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:feature-constraints\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-1.7147em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:probability-constraints\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"col-align-l\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"3.3853em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-5.5953em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\"})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.4247em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\"})})]}),(0,a.jsxs)(e.span,{style:{top:\"-1.7147em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"col-align-r\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"3.3853em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-5.5953em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.08125em\"},children:\"H\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.4247em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")]\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-1.7147em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.25em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"1\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"col-align-l\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.2147em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-3.4247em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")]\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-1.7147em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"1em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2200\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\u003e\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"0\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]}),(0,a.jsx)(e.span,{className:\"tag\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"3.3853em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-5.5953em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.4247em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"1a\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-1.7147em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"1b\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.8853em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"where \",(0,a.jsx)(re,{label:\"eq:feature-constraints\",num:\"1a\"}),\" represents the feature-matching constraint and \",(0,a.jsx)(re,{label:\"eq:probability-constraints\",num:\"1b\"}),\" the probability constraints.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"This problem expresses that we want to find a probability distribution \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" over trajectories \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"\\u03C4\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})]})})]})}),\" with maximum entropy, under which the expected feature visitation frequencies of learner \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"]\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbb{E}_{\\\\pi^L}[\\\\phi(\\\\tau)]\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")]\"})]})})]})}),\" and expert \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"E\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"]\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbb{E}_{\\\\pi^E}[\\\\phi(\\\\tau)]\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")]\"})]})})]})}),\" match (that \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi(\\\\tau)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" represents the features visited by trajectory \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"\\u03C4\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\tau\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})]})})]})}),`).\nNote that the policy `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi^L\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.8413em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]})]})})]})}),\" of the learner depends on the probability distribution \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" with\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mtable,{width:\"100%\",children:(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u221D\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\":\"}),(0,a.jsx)(e.mtext,{children:\"\\xA0\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"0\"})]})]})]})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})}),(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mtext,{children:\"(2)\"})})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`    \\\\label{eq:policy}\n    \\\\pi^L(a \\\\mid s) \\\\propto \\\\sum_{\\\\tau :\\\\ (s, a) \\\\in \\\\tau_{t=0}} p(\\\\tau),\n    \\\\tag{2}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.1413em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:policy\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8913em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u221D\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.566em\",verticalAlign:\"-1.516em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.809em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\":\"}),(0,a.jsx)(e.span,{className:\"mspace mtight\",children:(0,a.jsx)(e.span,{className:\"mtight\",children:\"\\xA0\"})}),(0,a.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"mclose mtight\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"-0.1132em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.516em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]}),(0,a.jsxs)(e.span,{className:\"tag\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.566em\",verticalAlign:\"-1.516em\"}}),(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"2\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})]})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"i.e., the policy of the learner is proportional to the sum of the probabilities of all trajectories performing action \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"a\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"a\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"})]})})]})}),\" in the starting state \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"s\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"s\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"})]})})]})}),\".\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Now we have the probability distribution over trajectories, but how does this help us to recover the reward function \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"R\"}),(0,a.jsx)(e.mo,{children:\":\"}),(0,a.jsx)(e.mi,{children:\"S\"}),(0,a.jsx)(e.mo,{children:\"\\u2192\"}),(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"R: S \\\\to \\\\mathbb{R}\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.05764em\"},children:\"S\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2192\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6889em\"}}),(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"})]})]})]})}),`?\nFollowing the school of basic reinforcement learning provides us with the answer: The reward dictates the policy, which in turn dictates the trajectory distribution `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),`.\nA key assumption of Maximum Entropy IRL is that we know the behavior of our MDP, i.e., we have a perfect model representing the transition probabilities `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(s_{t+1} \\\\mid s_t, a_t)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),`, so the only thing we actually need to learn is the reward.\nEverything else either is derived from it or assumed known.\nTo be able to learn the reward, we must parameterize it.\nFor this, we assume linearity regarding features, i.e.,`]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"R\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u22A4\"})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"    R(\\\\tau) = \\\\omega^\\\\top \\\\phi(\\\\tau),\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.1491em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u22A4\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"with \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"R\"}),(0,a.jsx)(e.mi,{children:\"d\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega \\\\in \\\\mathbb{R}^d\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.5782em\",verticalAlign:\"-0.0391em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.8491em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"R\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8491em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]})})})})})]})]})]})]})}),` being the reward parameter vector.\nTo make the dependency on the reward parameters explicit, we write `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau \\\\mid \\\\omega)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\" and \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi(a \\\\mid s, \\\\omega)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\".\"]}),`\n`,(0,a.jsx)(Te,{children:(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Note:\"}),` The choice of a linear parametrization is not by chance, but a direct result of the feature expectation matching constraint:\nGiven an expert solving an MDP with unknown reward function linear in a set of known features, performing feature expectation matching with those features is guaranteed to yield a policy performing comparable to or better than the expert with respect to that reward `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a1p5dt98ism\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-abbeelApprenticeshipLearningInverse2004\",children:\"(Abbeel \u0026 Ng, 2004)\"})}),\".\"]})}),`\n`,(0,a.jsx)(e.h2,{id:\"solution-and-partition-function\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#solution-and-partition-function\",children:\"Solution and Partition Function\"})}),`\n`,(0,a.jsx)(e.p,{children:\"Solving the above mathematical program for MDPs with deterministic transition dynamics (i.e., MDPs where all actions have predetermined deterministic outcomes) using the method of Lagrange multipliers leads to the observation that\"}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mi,{children:\"d\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.mfrac,{children:[(0,a.jsx)(e.mn,{children:\"1\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,a.jsx)(e.mi,{children:\"exp\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u22A4\"})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{fence:\"true\",children:\")\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})})]}),(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"})]}),(0,a.jsx)(e.mi,{children:\"exp\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u22A4\"})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{fence:\"true\",children:\")\"})]})]})})})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`\\\\begin{align*}\n    p_d(\\\\tau \\\\mid \\\\omega) \u0026= \\\\frac{1}{Z(\\\\omega)} \\\\exp \\\\left( \\\\omega^\\\\top \\\\phi(\\\\tau) \\\\right), \\\\\\\\\n    Z(\\\\omega) \u0026= \\\\sum_{\\\\tau} \\\\exp \\\\left( \\\\omega^\\\\top \\\\phi(\\\\tau) \\\\right)\n\\\\end{align*}`})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"5.1575em\",verticalAlign:\"-2.3287em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsxs)(e.span,{className:\"mtable\",children:[(0,a.jsx)(e.span,{className:\"col-align-r\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"2.8287em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-4.8287em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"d\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-2.5427em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.3287em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"col-align-l\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"2.8287em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-4.8287em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,a.jsx)(e.span,{className:\"mfrac\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.3214em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"1\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.936em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mclose nulldelimiter\"})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,a.jsx)(e.span,{className:\"delimsizing size1\",children:\"(\"})}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u22A4\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,a.jsx)(e.span,{className:\"delimsizing size1\",children:\")\"})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-2.5427em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.3214em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.25em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,a.jsx)(e.span,{className:\"delimsizing size1\",children:\"(\"})}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u22A4\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,a.jsx)(e.span,{className:\"delimsizing size1\",children:\")\"})})]})]})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.3287em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})]})})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"with the so-called partition function \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"Z(\\\\omega)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" simply normalizing the values to fulfill the probability distribution constraint \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-aok1beo2jg\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartMaximumEntropyInverse2008\",children:\"(Osa et al., 2018; Ziebart et al., 2008)\"})}),`.\nBy choosing the reward to linearly depend on the features, we have also ensured that the Lagrange multipliers are precisely the reward parameters `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"\\u03C9\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"})]})})]})}),\" \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a1bls2ie4h2\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-osaAlgorithmicPerspectiveImitation2018\",children:\"(Osa et al., 2018)\"})}),`.\nFor MDPs with stochastic transitions, Ziebart et al. `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a2ohn2ak7jn\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartMaximumEntropyInverse2008\",children:\"(Ziebart et al., 2008)\"})}),\" propose to modify the deterministic solution, yielding the approximation\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mtable,{width:\"100%\",children:(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mi,{children:\"s\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u2248\"}),(0,a.jsxs)(e.mfrac,{children:[(0,a.jsx)(e.mn,{children:\"1\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})]}),(0,a.jsx)(e.mi,{children:\"exp\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u22A4\"})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{fence:\"true\",children:\")\"})]}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u220F\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"})]})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\".\"})]})}),(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mtext,{children:\"(3)\"})})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`    \\\\label{eq:approx-probability}\n    p_s(\\\\tau \\\\mid \\\\omega)\n    \\\\approx\n        \\\\frac{1}{Z(\\\\omega)} \\\\exp\\\\left( \\\\omega^\\\\top \\\\phi(\\\\tau) \\\\right)\n        \\\\prod_{s_{t+1}, a_t, s_t \\\\in \\\\tau} p(s_{t+1} \\\\mid s_t, a_t).\n    \\\\tag{3}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:approx-probability\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2248\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.7132em\",verticalAlign:\"-1.3918em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,a.jsx)(e.span,{className:\"mfrac\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.3214em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.677em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"1\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.936em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mclose nulldelimiter\"})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,a.jsx)(e.span,{className:\"delimsizing size1\",children:\"(\"})}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u22A4\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,a.jsx)(e.span,{className:\"delimsizing size1\",children:\")\"})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2025em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2963em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2963em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u220F\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3918em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\".\"})]}),(0,a.jsxs)(e.span,{className:\"tag\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.7132em\",verticalAlign:\"-1.3918em\"}}),(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"3\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})]})]})]})})}),`\n`,(0,a.jsx)(Te,{children:(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Note:\"}),` We are simply multiplying the deterministic solution with combined transition probability of the trajectory.\nAs a result of said modification, however, we introduce a bias to the reward function `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a2j9r6nc4jj\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-osaAlgorithmicPerspectiveImitation2018\",children:\"(Osa et al., 2018)\"})}),`.\nTo avoid this, Ziebart `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-ajf7rra1cj\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartModelingPurposefulAdaptive2010\",children:\"(Ziebart, 2010)\"})}),\" proposes the Maximum Causal Entropy IRL method in his thesis \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a14p6atqmag\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartPrincipleMaximumCausal2013\",children:\"(see also Ziebart et al., 2013)\"})}),`.\nIn the scope of this post, we'll stick to the normal (non-causal) entropy.`]})}),`\n`,(0,a.jsx)(e.h2,{id:\"optimization\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#optimization\",children:\"Optimization\"})}),`\n`,(0,a.jsxs)(e.p,{children:[`We now know the parameterized form of the distribution, so how can we optimize the parameters?\nThe answer is fairly straightforward: We can maximize the log-likelihood over all demonstrated trajectories `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"D\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"{\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsxs)(e.msubsup,{children:[(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"}\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"i\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"1\"})]}),(0,a.jsx)(e.mi,{children:\"N\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{D} = \\\\{\\\\tau_i\\\\}_{i=1}^{N}\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.1em\",verticalAlign:\"-0.2587em\"}}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"{\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1132em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsxs)(e.span,{className:\"mclose\",children:[(0,a.jsx)(e.span,{className:\"mclose\",children:\"}\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.4413em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.10903em\"},children:\"N\"})})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2587em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})]})]})}),\", i.e.,\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mtable,{width:\"100%\",children:(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{children:\"\\u2217\"})]}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"arg\\u2009max\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"})]}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"})]}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"arg\\u2009max\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"})]}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"})]}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"D\"})]})]}),(0,a.jsx)(e.mi,{children:\"log\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})}),(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mtext,{children:\"(4)\"})})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`    \\\\label{eq:loglikelihood}\n    \\\\omega^* = \\\\argmax_{\\\\omega} \\\\mathcal{L}(\\\\omega)\n    = \\\\argmax_{\\\\omega} \\\\sum_{\\\\tau \\\\in \\\\mathcal{D}} \\\\log p(\\\\tau \\\\mid \\\\omega),\n    \\\\tag{4}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.7387em\"}}),(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:loglikelihood\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7387em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"\\u2217\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.6444em\",verticalAlign:\"-0.8944em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.4306em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.2056em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsx)(e.span,{className:\"mord mathrm\",style:{marginRight:\"0.01389em\"},children:\"arg\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathrm\",children:\"max\"})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8944em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.3717em\",verticalAlign:\"-1.3217em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"0.4306em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.2056em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsx)(e.span,{className:\"mord mathrm\",style:{marginRight:\"0.01389em\"},children:\"arg\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathrm\",children:\"max\"})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8944em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.8557em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mord mathcal mtight\",style:{marginRight:\"0.02778em\"},children:\"D\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3217em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[\"lo\",(0,a.jsx)(e.span,{style:{marginRight:\"0.01389em\"},children:\"g\"})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]}),(0,a.jsxs)(e.span,{className:\"tag\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.3717em\",verticalAlign:\"-1.3217em\"}}),(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"4\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})]})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"using gradient ascent (or any other gradient-based optimization technique) as this function is convex \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-af7mptheev\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartMaximumEntropyInverse2008\",children:\"(Osa et al., 2018; Ziebart et al., 2008)\"})}),\".\"]}),`\n`,(0,a.jsxs)(Te,{children:[(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Note:\"}),\" Maximizing the log-likelihood is equivalent to minimizing the Kullback-Leibler divergence \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a16t7citgch\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-bishopPatternRecognitionMachine2006\",children:\"(Bishop, 2006)\"})})]}),(0,a.jsx)(\"div\",{className:\"math math-display\",dangerouslySetInnerHTML:{__html:En.default.renderToString(\"D_{KL}\\\\big(p^E(\\\\tau) \\\\,\\\\|\\\\, p(\\\\tau \\\\mid \\\\omega)\\\\big).\",{displayMode:!0})}}),(0,a.jsxs)(e.p,{children:[\"It can therefore also be interpreted as the M-projection onto the manifold of the maximum entropy distribution \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-atlbi4114n\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-osaAlgorithmicPerspectiveImitation2018\",children:\"(see e.g., Osa et al., 2018)\"})}),\".\"]})]}),`\n`,(0,a.jsxs)(e.p,{children:[\"The (averaged) gradient is then simply the difference between expected empirical feature counts \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"E\"})]})]}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{fence:\"true\",children:\"]\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathbb{E}_{\\\\pi^E} \\\\left[ \\\\phi(\\\\tau) \\\\right]\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\"]\"})]})]})})]})}),\" and the learner's expected feature counts (derived from the trajectory probabilities \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau \\\\mid \\\\omega)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\"), shown in \",(0,a.jsx)(re,{label:\"eq:grad-a\",num:\"5a\"}),\", i.e.:\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2207\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"})]}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"E\"})]})]}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{fence:\"true\",children:\"]\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2212\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mtext,{children:\"\\xA0\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})}),(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{className:\"mml-eqn-num\"})]}),(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsx)(e.mrow,{})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{mathvariant:\"double-struck\",children:\"E\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"E\"})]})]}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"[\"}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{fence:\"true\",children:\"]\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2212\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})}),(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{className:\"mml-eqn-num\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`\\\\begin{align*}\n    \\\\label{eq:grad-a}\n    \\\\nabla_\\\\omega \\\\mathcal{L}(\\\\omega)\n    \u0026= \\\\mathbb{E}_{\\\\pi^E} \\\\left[ \\\\phi(\\\\tau) \\\\right] - \\\\sum_{\\\\tau} p(\\\\tau \\\\mid \\\\omega)\\\\ \\\\phi(\\\\tau),\n        \\\\tag{5a}\\\\\\\\\n    \\\\label{eq:grad-b}\n    \u0026= \\\\mathbb{E}_{\\\\pi^E} \\\\left[ \\\\phi(\\\\tau) \\\\right] - \\\\sum_{s_i} D_{s_i} \\\\phi(s_i),\n        \\\\tag{5b}\\\\\\\\\n\\\\end{align*}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"5.3001em\",verticalAlign:\"-2.4001em\"}}),(0,a.jsxs)(e.span,{className:\"mtable\",children:[(0,a.jsx)(e.span,{className:\"col-align-r\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"2.9001em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-4.9001em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:grad-a\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2207\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-2.3em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:grad-b\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.4001em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"col-align-l\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"2.9001em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-4.9001em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\"]\"})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsx)(e.span,{className:\"mbin\",children:\"\\u2212\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.25em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",children:\"\\xA0\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-2.3em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathbb\",children:\"E\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.5029em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.7741em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.786em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05764em\"},children:\"E\"})})]})})})})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1971em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:\"[\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:\"]\"})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsx)(e.span,{className:\"mbin\",children:\"\\u2212\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3501em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.4001em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]}),(0,a.jsx)(e.span,{className:\"tag\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"2.9001em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-4.9001em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"5a\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-2.3em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"5b\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"2.4001em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"which we can express in terms of the state-visitation frequency \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\" with \",(0,a.jsx)(re,{label:\"eq:grad-b\",num:\"5b\"}),\", assuming \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msubsup,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"0\"})]}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2223\"})]})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi(\\\\tau) = \\\\sum_{t = 0}^{|\\\\tau|} \\\\phi(s_t)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.3276em\",verticalAlign:\"-0.2997em\"}}),(0,a.jsxs)(e.span,{className:\"mop\",children:[(0,a.jsx)(e.span,{className:\"mop op-symbol small-op\",style:{position:\"relative\",top:\"0em\"},children:\"\\u2211\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.0279em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.4003em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"0\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.2029em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u2223\"})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2997em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\" \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-ac7oghtj7n\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartMaximumEntropyInverse2008\",children:\"(Ziebart et al., 2008)\"})}),\".\"]}),`\n`,(0,a.jsxs)(Te,{children:[(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Note:\"}),\" The realization that we can transform \",(0,a.jsx)(re,{label:\"eq:grad-a\",num:\"5a\"}),\" to \",(0,a.jsx)(re,{label:\"eq:grad-b\",num:\"5b\"}),\", i.e., represent the expected feature count of the learner via the state-visitation frequency \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\", is actually one of the most important steps!\"]}),(0,a.jsxs)(e.p,{children:[(0,a.jsx)(re,{label:\"eq:grad-a\",num:\"5a\"}),` is generally infeasible (or at the very least quite costly) to compute, as enumerating all trajectories is usually subject to combinatorial explosion (think, for example, of trajectories in a \\u201Csimple\\u201D grid world).\nComputing the state visitation frequencies, as we will see below, however, is quite feasible (within some restrictions).`]})]}),`\n`,(0,a.jsx)(Te,{children:(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Note:\"}),\" Due to the log-likelihood, this gradient holds for both deterministic and stochastic transition dynamics.\"]})}),`\n`,(0,a.jsx)(e.h2,{id:\"computing-the-state-visitation-frequency\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#computing-the-state-visitation-frequency\",children:\"Computing the State-Visitation Frequency\"})}),`\n`,(0,a.jsxs)(e.p,{children:[`Now, we have only one remaining question:\nHow do we compute the state-visitation frequency `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),`?\nFollowing good computer-science fashion, we divide and conquer:\nFirst, we compute a (stochastic) policy `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mtext,{children:\"ME\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}}(a \\\\mid s, \\\\omega)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord text mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),`, referred to as the local action probability, with a backward pass.\nThereafter, we compute the state-visitation frequency under this policy with a simple forward pass.`]}),`\n`,(0,a.jsx)(e.h3,{id:\"backward-pass-computing-the-local-action-policy\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#backward-pass-computing-the-local-action-policy\",children:\"Backward Pass: Computing the Local Action Policy\"})}),`\n`,(0,a.jsxs)(e.p,{children:[\"The basic idea of the first pass is to remember our earlier observation about the learner policy \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mi,{children:\"L\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi^L(a \\\\mid s)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0913em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8413em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"L\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\" made in \",(0,a.jsx)(re,{label:\"eq:policy\",num:\"2\"}),\", i.e.,\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mtext,{children:\"ME\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u221D\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\":\"}),(0,a.jsx)(e.mtext,{children:\"\\xA0\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"0\"})]})]})]})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"    \\\\pi_{\\\\text{ME}}(a_j \\\\mid s_i, \\\\omega) \\\\propto \\\\sum_{\\\\tau :\\\\ (s_i, a_j) \\\\in \\\\tau_{t=0}} p(\\\\tau \\\\mid \\\\omega),\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord text mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u221D\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.5883em\",verticalAlign:\"-1.5383em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.809em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\":\"}),(0,a.jsx)(e.span,{className:\"mspace mtight\",children:(0,a.jsx)(e.span,{className:\"mtight\",children:\"\\xA0\"})}),(0,a.jsx)(e.span,{className:\"mopen mtight\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose mtight\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"\\u2208\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3173em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"-0.1132em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.5383em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"and then recursively expand this using the solution we derived for our trajectory distribution \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(\\\\tau \\\\mid \\\\omega)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\" presented in \",(0,a.jsx)(re,{label:\"eq:approx-probability\",num:\"3\"}),` until we are not reasoning about full or partial trajectories any longer, but the individual state transitions.\nThis then yields the set of equations `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a2j0k28bej5\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartMaximumEntropyInverse2008\",children:\"(Ziebart et al., 2008)\"})}),\":\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mtable,{rowspacing:\"0.25em\",columnalign:\"right left\",columnspacing:\"0em\",children:[(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mtext,{children:\"ME\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.mfrac,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]})]})]}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"j\"})]})]})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})}),(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{className:\"mml-eqn-num\"})]}),(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]})]})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsx)(e.mi,{children:\"k\"})]}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"k\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mtext,{children:\"\\u2009\"}),(0,a.jsx)(e.mi,{children:\"exp\"}),(0,a.jsx)(e.mo,{children:\"\\u2061\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mo,{fence:\"true\",children:\"(\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u22A4\"})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{fence:\"true\",children:\")\"})]}),(0,a.jsx)(e.mtext,{children:\"\\u2009\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"k\"})]})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})})}),(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{className:\"mml-eqn-num\"})]}),(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})})}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mstyle,{scriptlevel:\"0\",displaystyle:\"true\",children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]})]}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]})]})]}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\".\"})]})})}),(0,a.jsx)(e.mtd,{className:\"mtr-glue\"}),(0,a.jsx)(e.mtd,{className:\"mml-eqn-num\"})]})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`\\\\begin{align*}\n    \\\\label{eq:bwpass}\n    \\\\pi_{\\\\text{ME}}(a_j \\\\mid s_i, \\\\omega) \u0026= \\\\frac{Z_{s_i, a_j}}{Z_{s_j}},\n        \\\\tag{6a} \\\\\\\\\n    Z_{s_i, a_j} \u0026= \\\\sum_{k} p(s_k \\\\mid s_i, a_j)\\\\, \\\\exp \\\\left(\\\\omega^\\\\top \\\\phi(s_i)\\\\right)\\\\, Z_{s_k},\n        \\\\tag{6b} \\\\\\\\\n    Z_{s_i} \u0026= \\\\sum_{a_j} Z_{s_i, a_j}.\n        \\\\tag{6c}\n\\\\end{align*}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"8.2034em\",verticalAlign:\"-3.8517em\"}}),(0,a.jsxs)(e.span,{className:\"mtable\",children:[(0,a.jsx)(e.span,{className:\"col-align-r\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"4.3517em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-6.3517em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:bwpass\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord text mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.9684em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-1.3163em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"3.8517em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"col-align-l\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"4.3517em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-6.3517em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mopen nulldelimiter\"}),(0,a.jsx)(e.span,{className:\"mfrac\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.4207em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-2.314em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.23em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"frac-line\",style:{borderBottomWidth:\"0.04em\"}})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.7373em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.0333em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mclose nulldelimiter\"})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.9684em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.8479em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3021em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mop\",children:\"exp\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"minner\",children:[(0,a.jsx)(e.span,{className:\"mopen delimcenter\",style:{top:\"0em\"},children:(0,a.jsx)(e.span,{className:\"delimsizing size1\",children:\"(\"})}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.8991em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.113em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"\\u22A4\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mclose delimcenter\",style:{top:\"0em\"},children:(0,a.jsx)(e.span,{className:\"delimsizing size1\",children:\")\"})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.3488em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1512em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2559em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]})]}),(0,a.jsxs)(e.span,{style:{top:\"-1.3163em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.4473em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mord\",children:\".\"})]})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"3.8517em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]}),(0,a.jsx)(e.span,{className:\"tag\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"4.3517em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-6.3517em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"6a\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.9684em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"6b\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})})]}),(0,a.jsxs)(e.span,{style:{top:\"-1.3163em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.4207em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"6c\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"3.8517em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Here, \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\" represents the state-partition-function, again normalizing the probabilities, and \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i, a_i}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),` is referred to as the state-action partition function.\nSetting the state-partition function `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"1\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i} = 1\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"1\"})]})]})]})}),\" for terminal states and then recursively backing up, using the equations for \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\" and \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"Z\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"Z_{s_i, a_j}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0307em\",verticalAlign:\"-0.3473em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.07153em\"},children:\"Z\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0715em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3473em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\", from those states yields a set of values that we can then use to compute the local action probabilities following the above equation.\"]}),`\n`,(0,a.jsxs)(Te,{children:[(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Note:\"}),` This backup-pass somewhat resembles a value-iteration scheme to solve an MDP.\nIt also turns out that this backup part of the algorithm is the only thing that differs between Maximum Entropy and Maximum Causal Entropy IRL.`]}),(0,a.jsxs)(e.p,{children:[\"In fact, for the Maximum Causal Entropy approach, one can show that the partition functions are an analogy of the Bellman equation \\u2014 the so-called soft Bellman equation \\u2014 which allows for a straightforward extension of the value-iteration algorithm to this problem \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a2q8uo2kom0\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartModelingPurposefulAdaptive2010\",children:\"(Ziebart, 2010; Ziebart et al., 2013)\"})}),\".\"]})]}),`\n`,(0,a.jsx)(e.h3,{id:\"forward-pass-inferring-state-visitation-frequency-from-\\u03C0mepi_textme\\u03C0me\",children:(0,a.jsxs)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#forward-pass-inferring-state-visitation-frequency-from-\\u03C0mepi_textme\\u03C0me\",children:[\"Forward Pass: Inferring State-Visitation Frequency from \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mtext,{children:\"ME\"})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord text mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})})]})}),`\n`,(0,a.jsxs)(e.p,{children:[\"As we now know the policy \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mtext,{children:\"ME\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}}(a_j \\\\mid s_i, \\\\omega)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord text mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\", inferring the state-visitation frequency \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),` becomes fairly easy:\nRemember that the policy is a probability distribution that tells us, given a state `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"s_i\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\", with which probability the agent should take a certain action \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"a_j\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.7167em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\", which then leads to a new state \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"k\"})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"s_k\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.5806em\",verticalAlign:\"-0.15em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),` according to our MDP transition model.\nGiven an initial state-visitation frequency, we can therefore use the policy to forward-propagate the individual visitation counts, obtaining an updated state-visitation frequency map.`]}),`\n`,(0,a.jsxs)(e.p,{children:[\"To this end, we initialize \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mn,{children:\"0\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i, 0}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\" to the starting-state probabilities \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mn,{children:\"0\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p_0(s_i)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"0\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" at timestep \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"0\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"t=0\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6151em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6444em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"0\"})]})]})]})}),\", i.e.,\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mtable,{width:\"100%\",children:(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mrow,{}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mn,{children:\"0\"})]})]}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mn,{children:\"0\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsx)(e.mo,{children:\":\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2208\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C4\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsx)(e.mn,{children:\"0\"})]})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\".\"})]})}),(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mtext,{children:\"(7a)\"})})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`    \\\\label{eq:fwpass}\n    D_{s_i, 0} = p_0(s_i) = p(\\\\tau : s_i \\\\in \\\\tau_{t=0}).\n    \\\\tag{7a}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsx)(e.span,{className:\"enclosing\",id:\"eq:fwpass\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"0\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\":\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6891em\",verticalAlign:\"-0.15em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2208\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.1132em\"},children:\"\\u03C4\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.1132em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mrel mtight\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"0\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\".\"})]}),(0,a.jsxs)(e.span,{className:\"tag\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"7a\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})]})]})]})})}),`\n`,(0,a.jsx)(e.p,{children:\"We then compute updates as mentioned above via\"}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mtable,{width:\"100%\",children:(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"k\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]})]}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"t\"})]})]}),(0,a.jsx)(e.mo,{children:\"\\u22C5\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mtext,{children:\"ME\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"\\u22C5\"}),(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"k\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"})]})}),(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mtext,{children:\"(7b)\"})})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`    D_{s_k, t+1} = \\\\sum_{s_i} \\\\sum_{a_j} D_{s_i, t}\n        \\\\cdot \\\\pi_{\\\\text{ME}} (a_j \\\\mid s_i, \\\\omega)\n        \\\\cdot p(s_k \\\\mid s_i, a_j),\n    \\\\tag{7b}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3448em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.3488em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1512em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.4973em\",verticalAlign:\"-1.4473em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.3501em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2819em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.4473em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord text mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsx)(e.span,{className:\"mbin\",children:\"\\u22C5\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"})]}),(0,a.jsxs)(e.span,{className:\"tag\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.4973em\",verticalAlign:\"-1.4473em\"}}),(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"7b\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})]})]})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"where \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"k\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(s_k \\\\mid a_j, s_i)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3361em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.03148em\"},children:\"k\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),` represents the transition probabilities of our (stochastic) MDP.\nNote, that `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"t\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i, t}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9694em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\" only gives us the state-visitation frequency for time-step \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"t\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"t\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6151em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"t\"})]})})]})}),\", meaning we have to sum them up to obtain the time-step independent state-visitation\"]}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mtable,{width:\"100%\",children:(0,a.jsxs)(e.mtr,{children:[(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.munder,{children:[(0,a.jsx)(e.mo,{children:\"\\u2211\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"t\"})]})]}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\".\"})]})}),(0,a.jsx)(e.mtd,{width:\"50%\"}),(0,a.jsx)(e.mtd,{children:(0,a.jsx)(e.mtext,{children:\"(7c)\"})})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:`    D_{s_i} = \\\\sum_{t} D_{s_i, t}.\n    \\\\tag{7c}`})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.3em\",verticalAlign:\"-1.25em\"}}),(0,a.jsx)(e.span,{className:\"mop op-limits\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsxs)(e.span,{className:\"vlist\",style:{height:\"1.05em\"},children:[(0,a.jsxs)(e.span,{style:{top:\"-1.9em\",marginLeft:\"0em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})})]}),(0,a.jsxs)(e.span,{style:{top:\"-3.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"3.05em\"}}),(0,a.jsx)(e.span,{children:(0,a.jsx)(e.span,{className:\"mop op-symbol large-op\",children:\"\\u2211\"})})]})]}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"1.25em\"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct mtight\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mord\",children:\".\"})]}),(0,a.jsxs)(e.span,{className:\"tag\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"2.3em\",verticalAlign:\"-1.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord text\",children:[(0,a.jsx)(e.span,{className:\"mord\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord\",children:(0,a.jsx)(e.span,{className:\"mord\",children:\"7c\"})}),(0,a.jsx)(e.span,{className:\"mord\",children:\")\"})]})]})]})]})})}),`\n`,(0,a.jsx)(e.h1,{id:\"the-algorithm\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#the-algorithm\",children:\"The Algorithm\"})}),`\n`,(0,a.jsx)(e.p,{children:`With a plan for computation of the state-visitation frequency, we now have everything we need to state the full algorithm.\nTo derive that, however, let us first recap our findings:`}),`\n`,(0,a.jsxs)(e.ul,{children:[`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsxs)(e.p,{children:[\"Our problem is a constrained optimization problem for finding the optimal reward parameters \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"\\u03C9\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"})]})})]})}),`.\nWe can solve this problem by maximizing the log-likelihood over all demonstrated trajectories `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"D\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\mathcal{D}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathcal\",style:{marginRight:\"0.02778em\"},children:\"D\"})]})})]})}),\" (see \",(0,a.jsx)(re,{label:\"eq:loglikelihood\",num:\"4\"}),`).\nThis, in turn, is itself an optimization problem, for which we need the gradient `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2207\"}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\nabla \\\\mathcal{L}(\\\\omega)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2207\"}),(0,a.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" of this log-likelihood.\"]}),`\n`]}),`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsxs)(e.p,{children:[\"To compute the gradient \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2207\"}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\nabla \\\\mathcal{L}(\\\\omega)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2207\"}),(0,a.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\", we require the state-visitation frequency (see \",(0,a.jsx)(re,{label:\"eq:grad-b\",num:\"5b\"}),\").\"]}),`\n`]}),`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsxs)(e.p,{children:[\"To compute the state-visitation frequency, we require the policy \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mtext,{children:\"ME\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}} (a_j \\\\mid s_i, \\\\omega)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord text mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\" (see \",(0,a.jsx)(re,{text:\"Equation\",label:\"eq:fwpass\",num:\"7b\"}),\").\"]}),`\n`]}),`\n`]}),`\n`,(0,a.jsx)(e.p,{children:\"Putting this all together yields the following iteration scheme:\"}),`\n`,(0,a.jsxs)(e.ol,{children:[`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsxs)(e.p,{children:[\"Compute policy \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C0\"}),(0,a.jsx)(e.mtext,{children:\"ME\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"j\"})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\pi_{\\\\text{ME}} (a_j \\\\mid s_i, \\\\omega)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1.0361em\",verticalAlign:\"-0.2861em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C0\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3283em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0359em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsx)(e.span,{className:\"mord text mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"ME\"})})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",style:{marginRight:\"0.05724em\"},children:\"j\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2861em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3117em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\" the using current estimate of \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:\"\\u03C9\"})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"})]})})]})}),\" via the backward pass, i.e., \",(0,a.jsx)(re,{text:\"Equations\",label:\"eq:bwpass\",num:\"6a\\u2013c\"}),\".\"]}),`\n`]}),`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsxs)(e.p,{children:[\"Compute the state-visitation frequency \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"D\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"i\"})]})]})}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"D_{s_i}\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.9334em\",verticalAlign:\"-0.2501em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.02778em\"},children:\"D\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.1514em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"-0.0278em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3281em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.357em\",marginLeft:\"0em\",marginRight:\"0.0714em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.5em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size3 size1 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"i\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.143em\"},children:(0,a.jsx)(e.span,{})})})]})})]})})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2501em\"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),\" via the forward pass, i.e., \",(0,a.jsx)(re,{text:\"Equations\",label:\"eq:fwpass\",num:\"7a\\u2013c\"}),\".\"]}),`\n`]}),`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsxs)(e.p,{children:[\"Compute the gradient \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2207\"}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\nabla \\\\mathcal{L}(\\\\omega)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2207\"}),(0,a.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),\" via \",(0,a.jsx)(re,{label:\"eq:grad-b\",num:\"5b\"}),\".\"]}),`\n`]}),`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsx)(e.p,{children:\"Perform one gradient-based optimization step, e.g.,\"}),`\n`,(0,a.jsx)(e.div,{className:\"math math-display\",children:(0,a.jsx)(e.span,{className:\"katex-display\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",display:\"block\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{children:\"\\u2190\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mi,{children:\"\\u03B7\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\"\\u2207\"}),(0,a.jsx)(e.mi,{mathvariant:\"script\",children:\"L\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mi,{mathvariant:\"normal\",children:\".\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\omega \\\\gets \\\\omega + \\\\eta \\\\nabla \\\\mathcal{L}(\\\\omega).\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.4306em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2190\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"0.6667em\",verticalAlign:\"-0.0833em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}}),(0,a.jsx)(e.span,{className:\"mbin\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2222em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03B7\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\"\\u2207\"}),(0,a.jsx)(e.span,{className:\"mord mathcal\",children:\"L\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mord\",children:\".\"})]})]})]})})}),`\n`]}),`\n`]}),`\n`,(0,a.jsx)(e.p,{children:\"We then iterate these four steps until convergence.\"}),`\n`,(0,a.jsx)(Te,{children:(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:\"Note:\"}),\" You can find a Jupyter Notebook discussing a simple implementation of this algorithm (applied to a grid-world example) at \",(0,a.jsx)(e.a,{href:\"https://github.com/qzed/irl-maxent\",children:\"github.com/qzed/irl-maxent\"}),\".\"]})}),`\n`,(0,a.jsx)(e.h1,{id:\"some-last-words\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#some-last-words\",children:\"Some Last Words\\u2026\"})}),`\n`,(0,a.jsx)(e.p,{children:`Maximum entropy IRL is a clever and \\u2015 all in all \\u2015 fairly simple solution to the general inverse reinforcement learning problem.\nHowever, it does have some drawbacks and limitations:`}),`\n`,(0,a.jsxs)(e.p,{children:[`First and foremost, the algorithm as explained in this post requires us \\u201Csolving\\u201D the MDP once per iteration.\nAs a result, it is fairly limited in the size of the discrete state-action-spaces that it can (reasonably) be applied to.\nExtensions to continuous state spaces, for example via Monte-Carlo sampling or via path integrals, have been proposed `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a1hs1k4veqa\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-aghasadeghiMaximumEntropyInverse2011\",children:\"(see e.g., Aghasadeghi \u0026 Bretl, 2011; Kalakrishnan et al., 2013)\"})}),`.\nHowever, the assumption that the transition dynamics of the environment, i.e., the probability distribution `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(s_{t+1} \\\\mid s_t, a_t)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),\", are known, further limits its applicability.\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"It also assumes a linear parametrization of the reward \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"R\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"}),(0,a.jsx)(e.mo,{children:\"=\"}),(0,a.jsxs)(e.msup,{children:[(0,a.jsx)(e.mi,{children:\"\\u03C9\"}),(0,a.jsx)(e.mo,{children:\"\\u22BA\"})]}),(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"R(s) = \\\\omega^\\\\intercal \\\\phi(s)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.00773em\"},children:\"R\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"=\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",style:{marginRight:\"0.03588em\"},children:\"\\u03C9\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsx)(e.span,{className:\"vlist-t\",children:(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.6644em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-3.063em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mbin amsrm mtight\",children:\"\\u22BA\"})})]})})})})})]}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),`.\nThis can be somewhat mitigated by our choice of features `,(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"\\u03D5\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"\\\\phi(s)\"})]})})}),(0,a.jsx)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"\\u03D5\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})})]})}),`, but feature expectation matching also only guarantees performance-parity with a linear reward parametrization.\nAn extension to model nonlinear reward functions via neural networks has been suggested by Wulfmeier et al. `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-amftpgc0ih\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-wulfmeierMaximumEntropyDeep2016\",children:\"(2016)\"})}),\".\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Lastly, maximum entropy IRL is constrained to limited transition randomness, i.e., fairly deterministic transition dynamics \",(0,a.jsx)(e.span,{className:\"math math-inline\",children:(0,a.jsxs)(e.span,{className:\"katex\",children:[(0,a.jsx)(e.span,{className:\"katex-mathml\",children:(0,a.jsx)(e.math,{xmlns:\"http://www.w3.org/1998/Math/MathML\",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"p\"}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\"(\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:\"t\"}),(0,a.jsx)(e.mo,{children:\"+\"}),(0,a.jsx)(e.mn,{children:\"1\"})]})]}),(0,a.jsx)(e.mo,{children:\"\\u2223\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"s\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{separator:\"true\",children:\",\"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:\"a\"}),(0,a.jsx)(e.mi,{children:\"t\"})]}),(0,a.jsx)(e.mo,{stretchy:\"false\",children:\")\"})]}),(0,a.jsx)(e.annotation,{encoding:\"application/x-tex\",children:\"p(s_{t+1} \\\\mid s_t, a_t)\"})]})})}),(0,a.jsxs)(e.span,{className:\"katex-html\",\"aria-hidden\":\"true\",children:[(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"p\"}),(0,a.jsx)(e.span,{className:\"mopen\",children:\"(\"}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.3011em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsxs)(e.span,{className:\"mord mtight\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"}),(0,a.jsx)(e.span,{className:\"mbin mtight\",children:\"+\"}),(0,a.jsx)(e.span,{className:\"mord mtight\",children:\"1\"})]})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2083em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}}),(0,a.jsx)(e.span,{className:\"mrel\",children:\"\\u2223\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.2778em\"}})]}),(0,a.jsxs)(e.span,{className:\"base\",children:[(0,a.jsx)(e.span,{className:\"strut\",style:{height:\"1em\",verticalAlign:\"-0.25em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"s\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mpunct\",children:\",\"}),(0,a.jsx)(e.span,{className:\"mspace\",style:{marginRight:\"0.1667em\"}}),(0,a.jsxs)(e.span,{className:\"mord\",children:[(0,a.jsx)(e.span,{className:\"mord mathnormal\",children:\"a\"}),(0,a.jsx)(e.span,{className:\"msupsub\",children:(0,a.jsxs)(e.span,{className:\"vlist-t vlist-t2\",children:[(0,a.jsxs)(e.span,{className:\"vlist-r\",children:[(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.2806em\"},children:(0,a.jsxs)(e.span,{style:{top:\"-2.55em\",marginLeft:\"0em\",marginRight:\"0.05em\"},children:[(0,a.jsx)(e.span,{className:\"pstrut\",style:{height:\"2.7em\"}}),(0,a.jsx)(e.span,{className:\"sizing reset-size6 size3 mtight\",children:(0,a.jsx)(e.span,{className:\"mord mathnormal mtight\",children:\"t\"})})]})}),(0,a.jsx)(e.span,{className:\"vlist-s\",children:\"\\u200B\"})]}),(0,a.jsx)(e.span,{className:\"vlist-r\",children:(0,a.jsx)(e.span,{className:\"vlist\",style:{height:\"0.15em\"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:\"mclose\",children:\")\"})]})]})]})}),`.\nAs noted above, this is due to the reward bias introduced by our probability approximation and can be avoided via the maximum `,(0,a.jsx)(e.em,{children:\"causal\"}),\" entropy IRL approach, proposed subsequently by Ziebart \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a25tmap8h3r\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-ziebartModelingPurposefulAdaptive2010\",children:\"(Ziebart, 2010; Ziebart et al., 2013)\"})}),\".\"]}),`\n`,(0,a.jsxs)(e.p,{children:[\"A somewhat similar, yet model-free approach is relative entropy IRL by Boularias et al. \",(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a18ta7s8n1v\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-boulariasRelativeEntropyInverse2011\",children:\"(2011)\"})}),`.\nSee the paper by Snoswell et al. `,(0,a.jsx)(e.span,{className:\"csl-ref\",id:\"csl-ref-a19fh547rgo\",children:(0,a.jsx)(e.a,{href:\"#csl-entry-snoswellRevisitingMaximumEntropy2020\",children:\"(2020)\"})}),\" for a perspective on both relative and maximum entropy IRL approaches.\"]}),`\n`,(0,a.jsx)(e.h1,{id:\"references\",children:(0,a.jsx)(e.a,{className:\"autolink-anchor\",\"aria-hidden\":!0,tabIndex:\"-1\",href:\"#references\",children:\"References\"})}),`\n`,(0,a.jsxs)(e.div,{className:\"csl-bib-body\",children:[(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-abbeelApprenticeshipLearningInverse2004\",children:[\"Abbeel, P., \u0026 Ng, A. Y. (2004). Apprenticeship learning via inverse reinforcement learning. \",(0,a.jsx)(e.i,{children:\"Twenty-First International Conference on Machine Learning - ICML \\u201904\"}),\". \",(0,a.jsx)(e.a,{href:\"https://doi.org/10.1145/1015330.1015430\",children:\"https://doi.org/10.1145/1015330.1015430\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-aghasadeghiMaximumEntropyInverse2011\",children:[\"Aghasadeghi, N., \u0026 Bretl, T. (2011). Maximum entropy inverse reinforcement learning in continuous state spaces with path integrals. \",(0,a.jsx)(e.i,{children:\"2011 IEEE/RSJ International Conference on Intelligent Robots and Systems\"}),\", 1561\\u20131566. \",(0,a.jsx)(e.a,{href:\"https://doi.org/10.1109/IROS.2011.6094679\",children:\"https://doi.org/10.1109/IROS.2011.6094679\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-bishopPatternRecognitionMachine2006\",children:[\"Bishop, C. M. (2006). \",(0,a.jsx)(e.i,{children:\"Pattern Recognition and Machine Learning\"}),\". Springer. \",(0,a.jsx)(e.a,{href:\"https://link.springer.com/book/9780387310732\",children:\"https://link.springer.com/book/9780387310732\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-boulariasRelativeEntropyInverse2011\",children:[\"Boularias, A., Kober, J., \u0026 Peters, J. (2011). Relative Entropy Inverse Reinforcement Learning. \",(0,a.jsx)(e.i,{children:\"Proceedings of the Fourteenth International Conference on Artificial Intelligence and Statistics\"}),\", 182\\u2013189. \",(0,a.jsx)(e.a,{href:\"https://proceedings.mlr.press/v15/boularias11a.html\",children:\"https://proceedings.mlr.press/v15/boularias11a.html\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-jaynesInformationTheoryStatistical1957\",children:[\"Jaynes, E. T. (1957). Information Theory and Statistical Mechanics. \",(0,a.jsx)(e.i,{children:\"Physical Review\"}),\", \",(0,a.jsx)(e.i,{children:\"106\"}),\"(4), 620\\u2013630. \",(0,a.jsx)(e.a,{href:\"https://doi.org/10.1103/PhysRev.106.620\",children:\"https://doi.org/10.1103/PhysRev.106.620\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-kalakrishnanLearningObjectiveFunctions2013\",children:[\"Kalakrishnan, M., Pastor, P., Righetti, L., \u0026 Schaal, S. (2013). Learning objective functions for manipulation. \",(0,a.jsx)(e.i,{children:\"2013 IEEE International Conference on Robotics and Automation\"}),\", 1331\\u20131336. \",(0,a.jsx)(e.a,{href:\"https://doi.org/10.1109/ICRA.2013.6630743\",children:\"https://doi.org/10.1109/ICRA.2013.6630743\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-ngPolicyInvarianceReward1999\",children:[\"Ng, A. Y., Harada, D., \u0026 Russell, S. J. (1999). Policy Invariance Under Reward Transformations: Theory and Application to Reward Shaping. \",(0,a.jsx)(e.i,{children:\"Proceedings of the Sixteenth International Conference on Machine Learning\"}),\", 278\\u2013287. \",(0,a.jsx)(e.a,{href:\"https://people.eecs.berkeley.edu/~pabbeel/cs287-fa09/readings/NgHaradaRussell-shaping-ICML1999.pdf\",children:\"https://people.eecs.berkeley.edu/~pabbeel/cs287-fa09/readings/NgHaradaRussell-shaping-ICML1999.pdf\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-osaAlgorithmicPerspectiveImitation2018\",children:[\"Osa, T., Pajarinen, J., Neumann, G., Bagnell, J. A., Abbeel, P., \u0026 Peters, J. (2018). An Algorithmic Perspective on Imitation Learning. \",(0,a.jsx)(e.i,{children:\"Foundations and Trends in Robotics\"}),\", \",(0,a.jsx)(e.i,{children:\"7\"}),\"(1\\u20132), 1\\u2013179. \",(0,a.jsx)(e.a,{href:\"https://doi.org/10.1561/2300000053\",children:\"https://doi.org/10.1561/2300000053\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-snoswellRevisitingMaximumEntropy2020\",children:[\"Snoswell, A. J., Singh, S. P. N., \u0026 Ye, N. (2020). Revisiting Maximum Entropy Inverse Reinforcement Learning: New Perspectives and Algorithms. \",(0,a.jsx)(e.i,{children:\"2020 IEEE Symposium Series on Computational Intelligence (SSCI)\"}),\", 241\\u2013249. \",(0,a.jsx)(e.a,{href:\"https://doi.org/10.1109/SSCI47803.2020.9308391\",children:\"https://doi.org/10.1109/SSCI47803.2020.9308391\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-wulfmeierMaximumEntropyDeep2016\",children:[\"Wulfmeier, M., Ondruska, P., \u0026 Posner, I. (2016). \",(0,a.jsx)(e.i,{children:\"Maximum Entropy Deep Inverse Reinforcement Learning\"}),\" (arXiv:1507.04888). \",(0,a.jsx)(e.a,{href:\"https://doi.org/10.48550/arXiv.1507.04888\",children:\"https://doi.org/10.48550/arXiv.1507.04888\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-ziebartModelingPurposefulAdaptive2010\",children:[\"Ziebart, B. D. (2010). \",(0,a.jsx)(e.i,{children:\"Modeling purposeful adaptive behavior with the principle of maximum causal entropy\"}),\" [Phd, Carnegie Mellon University]. \",(0,a.jsx)(e.a,{href:\"https://www.cs.cmu.edu/~bziebart/publications/thesis-bziebart.pdf\",children:\"https://www.cs.cmu.edu/~bziebart/publications/thesis-bziebart.pdf\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-ziebartPrincipleMaximumCausal2013\",children:[\"Ziebart, B. D., Bagnell, J. A., \u0026 Dey, A. K. (2013). The Principle of Maximum Causal Entropy for Estimating Interacting Processes. \",(0,a.jsx)(e.i,{children:\"IEEE Transactions on Information Theory\"}),\", \",(0,a.jsx)(e.i,{children:\"59\"}),\", 1966\\u20131980. \",(0,a.jsx)(e.a,{href:\"https://doi.org/10.1109/TIT.2012.2234824\",children:\"https://doi.org/10.1109/TIT.2012.2234824\"})]}),(0,a.jsxs)(e.div,{className:\"csl-entry\",id:\"csl-entry-ziebartMaximumEntropyInverse2008\",children:[\"Ziebart, B. D., Maas, A., Bagnell, J. A., \u0026 Dey, A. K. (2008). Maximum Entropy Inverse Reinforcement Learning. \",(0,a.jsx)(e.i,{children:\"Proceedings of the 23rd National Conference on Artificial Intelligence - Volume 3\"}),\", 1433\\u20131438. \",(0,a.jsx)(e.a,{href:\"https://www.aaai.org/Library/AAAI/2008/aaai08-227.php\",children:\"https://www.aaai.org/Library/AAAI/2008/aaai08-227.php\"})]})]})]})}function Ji(G={}){let{wrapper:e}=G.components||{};return e?(0,a.jsx)(e,Object.assign({},G,{children:(0,a.jsx)(Cn,G)})):Cn(G)}var Ki=Ji;return Wi(Qi);})();\n;return Component;"}},"__N_SSG":true},"page":"/blog/posts/[slug]","query":{"slug":"20220825-irl-maxent"},"buildId":"VqO7pMtKrH6zG5R5-5JQ8","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>